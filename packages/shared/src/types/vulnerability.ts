/**
 * Vulnerability types for CVE tracking and POA&M generation
 * Aligned with M2 requirements: OSCAL POA&M, CVSS v3.1
 */

export enum VulnerabilitySeverity {
  CRITICAL = 'CRITICAL',
  HIGH = 'HIGH',
  MEDIUM = 'MEDIUM',
  LOW = 'LOW',
  NEGLIGIBLE = 'NEGLIGIBLE',
  UNKNOWN = 'UNKNOWN',
}

export enum POAMStatus {
  OPEN = 'OPEN',
  TRIAGING = 'TRIAGING',
  IN_PROGRESS = 'IN_PROGRESS',
  MITIGATED = 'MITIGATED',
  RISK_ACCEPTED = 'RISK_ACCEPTED',
  FALSE_POSITIVE = 'FALSE_POSITIVE',
  CLOSED = 'CLOSED',
}

export interface Vulnerability {
  id: string;
  cveId: string;
  severity: VulnerabilitySeverity;
  cvssScore?: number;
  cvssVector?: string;
  packageName: string;
  packageVersion: string;
  fixedVersion?: string;
  description: string;
  references: string[];
  publishedDate?: Date;
  modifiedDate?: Date;
}

export interface POAMItem {
  id: string;
  tenantId: string;
  vulnerabilityId: string;
  title: string;
  description: string;
  riskLevel: VulnerabilitySeverity;
  status: POAMStatus;
  assignedTo?: string;
  dueDate?: Date;
  remediationSteps: string;
  affectedSystems: string[];
  createdAt: Date;
  updatedAt: Date;
}
