{
  "config": {
    "lang": ["en"],
    "separator": "[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])",
    "pipeline": ["stopWordFilter"],
    "fields": {
      "title": { "boost": 1000.0 },
      "text": { "boost": 1.0 },
      "tags": { "boost": 1000000.0 }
    }
  },
  "docs": [
    {
      "location": "",
      "title": "Aegis Documentation",
      "text": "<p>This directory contains the source files for the Aegis DevSecOps Platform documentation.</p>"
    },
    {
      "location": "#building-the-documentation",
      "title": "Building the Documentation",
      "text": ""
    },
    {
      "location": "#prerequisites",
      "title": "Prerequisites",
      "text": "<ul> <li>Python 3.7+</li> <li>pip</li> </ul>"
    },
    {
      "location": "#install-dependencies",
      "title": "Install Dependencies",
      "text": "<pre><code>pip install mkdocs mkdocs-material mkdocs-material-extensions\n</code></pre>"
    },
    {
      "location": "#build-documentation",
      "title": "Build Documentation",
      "text": "<pre><code># Build static site\nmkdocs build\n\n# Serve locally with live reload\nmkdocs serve\n</code></pre> <p>The documentation will be available at http://localhost:8000</p>"
    },
    {
      "location": "#documentation-structure",
      "title": "Documentation Structure",
      "text": "<pre><code>docs/\n\u251c\u2500\u2500 introduction/        # Getting started guides\n\u251c\u2500\u2500 core-concepts/       # Core platform concepts\n\u251c\u2500\u2500 deployment/          # Deployment guides\n\u251c\u2500\u2500 api-reference/       # API documentation\n\u2514\u2500\u2500 guides/             # How-to guides\n</code></pre>"
    },
    {
      "location": "#search-functionality",
      "title": "Search Functionality",
      "text": "<p>The documentation includes built-in search powered by MkDocs Material. Search is automatically generated during the build process.</p>"
    },
    {
      "location": "#contributing",
      "title": "Contributing",
      "text": "<p>To contribute to the documentation:</p> <ol> <li>Edit markdown files in the <code>docs/</code> directory</li> <li>Test locally with <code>mkdocs serve</code></li> <li>Submit a pull request</li> </ol>"
    },
    {
      "location": "#publishing",
      "title": "Publishing",
      "text": "<p>The documentation is built and deployed automatically via CI/CD.</p>"
    },
    {
      "location": "FEEDBACK/",
      "title": "Documentation Feedback Tracking",
      "text": "<p>This directory tracks user feedback on Aegis documentation.</p>"
    },
    {
      "location": "FEEDBACK/#how-feedback-works",
      "title": "How Feedback Works",
      "text": ""
    },
    {
      "location": "FEEDBACK/#user-experience",
      "title": "User Experience",
      "text": "<ol> <li>On each documentation page, users see \"Was this page helpful?\" with \ud83d\udc4d and \ud83d\udc4e buttons</li> <li>When clicking \ud83d\udc4d: Shows appreciation message</li> <li>When clicking \ud83d\udc4e: Shows message with link to open GitHub issue</li> <li>GitHub issue link pre-fills:</li> <li>Page title</li> <li>Page URL</li> <li>\"Needs Improvement\" label</li> <li>Documentation and feedback labels</li> </ol>"
    },
    {
      "location": "FEEDBACK/#tracking-feedback",
      "title": "Tracking Feedback",
      "text": "<p>All feedback is tracked via GitHub Issues with the <code>feedback</code> and <code>documentation</code> labels.</p> <p>View all feedback: <pre><code>https://github.com/cloudcwfranck/aegis/issues?q=is%3Aissue+label%3Afeedback+label%3Adocumentation\n</code></pre></p>"
    },
    {
      "location": "FEEDBACK/#feedback-metrics",
      "title": "Feedback Metrics",
      "text": "<p>To track feedback metrics:</p> <pre><code># Count helpful feedback (\ud83d\udc4d)\n# Users who found pages helpful don't file issues, so track via analytics\n\n# Count improvement requests (\ud83d\udc4e)\ngh issue list --label feedback --label documentation --state all --json number,title,createdAt\n\n# Get feedback summary\ngh issue list --label feedback --label documentation --state all | wc -l\n</code></pre>"
    },
    {
      "location": "FEEDBACK/#github-labels",
      "title": "GitHub Labels",
      "text": "<ul> <li><code>documentation</code> - All documentation-related issues</li> <li><code>feedback</code> - User feedback from docs</li> <li><code>enhancement</code> - Suggested improvements</li> <li><code>bug</code> - Documentation errors or broken links</li> </ul>"
    },
    {
      "location": "FEEDBACK/#responding-to-feedback",
      "title": "Responding to Feedback",
      "text": "<ol> <li>Acknowledge: Comment on issue within 24-48 hours</li> <li>Assess: Determine if feedback requires doc updates</li> <li>Action: Update documentation as needed</li> <li>Close: Close issue once addressed with reference to commit/PR</li> </ol>"
    },
    {
      "location": "FEEDBACK/#analytics-integration",
      "title": "Analytics Integration",
      "text": "<p>For more detailed feedback analytics, consider integrating:</p> <ul> <li>Google Analytics: Track page views and feedback clicks</li> <li>Custom Solution: Build feedback tracking service</li> <li>Plausible Analytics: Privacy-friendly analytics</li> </ul>"
    },
    {
      "location": "FEEDBACK/#example-queries",
      "title": "Example Queries",
      "text": ""
    },
    {
      "location": "FEEDBACK/#most-requested-improvements",
      "title": "Most Requested Improvements",
      "text": "<pre><code>gh issue list \\\n  --label feedback \\\n  --label documentation \\\n  --sort comments \\\n  --limit 10\n</code></pre>"
    },
    {
      "location": "FEEDBACK/#recent-feedback",
      "title": "Recent Feedback",
      "text": "<pre><code>gh issue list \\\n  --label feedback \\\n  --label documentation \\\n  --state open \\\n  --sort created \\\n  --limit 20\n</code></pre>"
    },
    {
      "location": "FEEDBACK/#closed-feedback-resolved",
      "title": "Closed Feedback (Resolved)",
      "text": "<pre><code>gh issue list \\\n  --label feedback \\\n  --label documentation \\\n  --state closed \\\n  --limit 20\n</code></pre>"
    },
    {
      "location": "SERVING/",
      "title": "Serving Documentation",
      "text": "<p>The Aegis documentation is integrated with the web application for seamless access.</p>"
    },
    {
      "location": "SERVING/#how-it-works",
      "title": "How It Works",
      "text": "<p>The MkDocs documentation is built as a static site and copied to the web application's public directory:</p> <pre><code>packages/web/public/docs/\n</code></pre> <p>When users click the \"Documentation \u2192\" button on the landing page, they are directed to <code>/docs/</code> which serves the static documentation files.</p>"
    },
    {
      "location": "SERVING/#building-documentation",
      "title": "Building Documentation",
      "text": "<p>To rebuild and deploy the documentation:</p> <pre><code># Build docs and copy to web app\nnpm run docs:build\n\n# Or serve docs locally for development\nnpm run docs:serve\n</code></pre>"
    },
    {
      "location": "SERVING/#development-workflow",
      "title": "Development Workflow",
      "text": ""
    },
    {
      "location": "SERVING/#local-development",
      "title": "Local Development",
      "text": "<p>When working on documentation locally:</p> <pre><code># Terminal 1: Serve web app\nnpm run dev\n\n# Terminal 2: Serve docs with live reload\nnpm run docs:serve\n</code></pre> <p>The web app will be at http://localhost:5173 and docs at http://localhost:8000</p>"
    },
    {
      "location": "SERVING/#updating-documentation",
      "title": "Updating Documentation",
      "text": "<ol> <li>Edit markdown files in <code>docs/</code> directory</li> <li>Test changes with <code>mkdocs serve</code></li> <li>Build and deploy: <code>npm run docs:build</code></li> <li>Commit changes including both docs source and built files</li> </ol>"
    },
    {
      "location": "SERVING/#production-deployment",
      "title": "Production Deployment",
      "text": "<p>In production, the documentation is served alongside the web application:</p> <ul> <li>Web App: https://aegis.gov</li> <li>Documentation: https://aegis.gov/docs/</li> </ul> <p>The Vite production build automatically includes the <code>/docs/</code> directory from the public folder.</p>"
    },
    {
      "location": "SERVING/#file-structure",
      "title": "File Structure",
      "text": "<pre><code>aegis/\n\u251c\u2500\u2500 docs/               # Documentation source (Markdown)\n\u251c\u2500\u2500 mkdocs.yml         # MkDocs configuration\n\u251c\u2500\u2500 site/              # Built documentation (generated)\n\u2514\u2500\u2500 packages/\n    \u2514\u2500\u2500 web/\n        \u2514\u2500\u2500 public/\n            \u2514\u2500\u2500 docs/  # Documentation served by web app\n</code></pre>"
    },
    {
      "location": "SERVING/#search-functionality",
      "title": "Search Functionality",
      "text": "<p>The documentation includes built-in search powered by MkDocs Material: - Search index: <code>/docs/search/search_index.json</code> (253KB) - Supports keyword search across all pages - Search suggestions and highlighting</p>"
    },
    {
      "location": "environment-configuration/",
      "title": "Environment Configuration Guide",
      "text": "<p>This guide covers environment configuration for the Aegis DevSecOps Platform across different deployment scenarios.</p>"
    },
    {
      "location": "environment-configuration/#table-of-contents",
      "title": "Table of Contents",
      "text": "<ul> <li>Development (Local)</li> <li>Azure Government Cloud</li> <li>Production Deployment</li> <li>Vercel Frontend Deployment</li> </ul>"
    },
    {
      "location": "environment-configuration/#development-local",
      "title": "Development (Local)",
      "text": "<p>For local development, Aegis uses MinIO for S3-compatible storage and PostgreSQL with Redis for queue management.</p>"
    },
    {
      "location": "environment-configuration/#prerequisites",
      "title": "Prerequisites",
      "text": "<ul> <li>Node.js 18+</li> <li>Docker and Docker Compose</li> <li>npm or pnpm</li> </ul>"
    },
    {
      "location": "environment-configuration/#1-start-infrastructure-services",
      "title": "1. Start Infrastructure Services",
      "text": "<pre><code>docker-compose up -d postgres redis minio\n</code></pre> <p>This starts: - PostgreSQL 15 on port 5432 - Redis 7 on port 6379 - MinIO on ports 9000 (API) and 9001 (Console)</p>"
    },
    {
      "location": "environment-configuration/#2-api-environment-variables",
      "title": "2. API Environment Variables",
      "text": "<p>Create <code>packages/api/.env</code>:</p> <pre><code># Database Configuration\nDATABASE_HOST=localhost\nDATABASE_PORT=5432\nDATABASE_NAME=aegis_dev\nDATABASE_USER=aegis\nDATABASE_PASSWORD=aegis_dev_password\nDATABASE_SSL=false\n\n# Storage Configuration (MinIO for local dev)\nSTORAGE_PROVIDER=s3\nS3_ENDPOINT=http://localhost:9000\nS3_ACCESS_KEY_ID=minioadmin\nS3_SECRET_ACCESS_KEY=minioadmin\nS3_BUCKET=aegis-evidence\nS3_REGION=us-east-1\nS3_FORCE_PATH_STYLE=true\n\n# Redis Configuration (BullMQ)\nREDIS_HOST=localhost\nREDIS_PORT=6379\nREDIS_PASSWORD=\nREDIS_TLS=false\n\n# API Configuration\nPORT=4000\nNODE_ENV=development\nLOG_LEVEL=debug\n\n# Multi-tenancy (for testing)\nDEFAULT_TENANT_ID=00000000-0000-0000-0000-000000000000\n</code></pre>"
    },
    {
      "location": "environment-configuration/#3-web-frontend-environment-variables",
      "title": "3. Web Frontend Environment Variables",
      "text": "<p>Create <code>packages/web/.env</code>:</p> <pre><code>VITE_API_URL=http://localhost:4000\n</code></pre>"
    },
    {
      "location": "environment-configuration/#4-database-migrations",
      "title": "4. Database Migrations",
      "text": "<pre><code># Run migrations\nnpm run db:migrate\n\n# Seed development data (optional)\nnpm run db:seed\n</code></pre>"
    },
    {
      "location": "environment-configuration/#5-start-development-servers",
      "title": "5. Start Development Servers",
      "text": "<pre><code># Start API server (includes BullMQ workers)\nnpm run dev --workspace=@aegis/api\n\n# In another terminal, start web frontend\nnpm run dev --workspace=@aegis/web\n</code></pre>"
    },
    {
      "location": "environment-configuration/#access-points",
      "title": "Access Points",
      "text": "<ul> <li>Web UI: http://localhost:5173</li> <li>API: http://localhost:4000</li> <li>GraphQL Playground: http://localhost:4000/graphql</li> <li>MinIO Console: http://localhost:9001 (minioadmin/minioadmin)</li> </ul>"
    },
    {
      "location": "environment-configuration/#azure-government-cloud",
      "title": "Azure Government Cloud",
      "text": "<p>Aegis supports deployment to Azure Government Cloud for FedRAMP compliance.</p>"
    },
    {
      "location": "environment-configuration/#prerequisites_1",
      "title": "Prerequisites",
      "text": "<ul> <li>Azure Government subscription</li> <li>Azure CLI configured for Azure Gov Cloud</li> <li>Kubernetes cluster (AKS Gov) or Azure Container Apps</li> </ul>"
    },
    {
      "location": "environment-configuration/#1-azure-resources-setup",
      "title": "1. Azure Resources Setup",
      "text": ""
    },
    {
      "location": "environment-configuration/#create-resource-group",
      "title": "Create Resource Group",
      "text": "<pre><code>az cloud set --name AzureUSGovernment\naz login\naz account set --subscription \"&lt;your-subscription-id&gt;\"\n\naz group create \\\n  --name aegis-prod-rg \\\n  --location usgovvirginia\n</code></pre>"
    },
    {
      "location": "environment-configuration/#create-azure-database-for-postgresql",
      "title": "Create Azure Database for PostgreSQL",
      "text": "<pre><code>az postgres flexible-server create \\\n  --resource-group aegis-prod-rg \\\n  --name aegis-db-prod \\\n  --location usgovvirginia \\\n  --admin-user aegis_admin \\\n  --admin-password '&lt;strong-password&gt;' \\\n  --sku-name Standard_D2s_v3 \\\n  --tier GeneralPurpose \\\n  --version 15 \\\n  --storage-size 128 \\\n  --public-access None\n\naz postgres flexible-server db create \\\n  --resource-group aegis-prod-rg \\\n  --server-name aegis-db-prod \\\n  --database-name aegis_production\n</code></pre>"
    },
    {
      "location": "environment-configuration/#create-azure-cache-for-redis",
      "title": "Create Azure Cache for Redis",
      "text": "<pre><code>az redis create \\\n  --resource-group aegis-prod-rg \\\n  --name aegis-redis-prod \\\n  --location usgovvirginia \\\n  --sku Standard \\\n  --vm-size c1 \\\n  --enable-non-ssl-port false\n</code></pre>"
    },
    {
      "location": "environment-configuration/#create-azure-blob-storage-account",
      "title": "Create Azure Blob Storage Account",
      "text": "<pre><code>az storage account create \\\n  --name aegisblobprod \\\n  --resource-group aegis-prod-rg \\\n  --location usgovvirginia \\\n  --sku Standard_GRS \\\n  --kind StorageV2 \\\n  --access-tier Hot \\\n  --https-only true \\\n  --min-tls-version TLS1_2\n\naz storage container create \\\n  --account-name aegisblobprod \\\n  --name evidence \\\n  --auth-mode login\n</code></pre>"
    },
    {
      "location": "environment-configuration/#2-api-environment-variables-azure-gov",
      "title": "2. API Environment Variables (Azure Gov)",
      "text": "<p>Create Kubernetes Secret or Azure Key Vault entries:</p> <pre><code># k8s-secrets.yaml\napiVersion: v1\nkind: Secret\nmetadata:\n  name: aegis-api-secrets\n  namespace: aegis\ntype: Opaque\nstringData:\n  # Database Configuration\n  DATABASE_HOST: \"aegis-db-prod.postgres.database.usgovcloudapi.net\"\n  DATABASE_PORT: \"5432\"\n  DATABASE_NAME: \"aegis_production\"\n  DATABASE_USER: \"aegis_admin\"\n  DATABASE_PASSWORD: \"&lt;postgres-password&gt;\"\n  DATABASE_SSL: \"true\"\n\n  # Storage Configuration (Azure Blob)\n  STORAGE_PROVIDER: \"azure\"\n  AZURE_STORAGE_ACCOUNT_NAME: \"aegisblobprod\"\n  AZURE_STORAGE_ACCOUNT_KEY: \"&lt;storage-account-key&gt;\"\n  AZURE_STORAGE_CONTAINER: \"evidence\"\n  AZURE_STORAGE_ENDPOINT: \"https://aegisblobprod.blob.core.usgovcloudapi.net\"\n\n  # Redis Configuration\n  REDIS_HOST: \"aegis-redis-prod.redis.cache.usgovcloudapi.net\"\n  REDIS_PORT: \"6380\"\n  REDIS_PASSWORD: \"&lt;redis-access-key&gt;\"\n  REDIS_TLS: \"true\"\n\n  # API Configuration\n  PORT: \"4000\"\n  NODE_ENV: \"production\"\n  LOG_LEVEL: \"info\"\n</code></pre> <p>Apply the secret:</p> <pre><code>kubectl apply -f k8s-secrets.yaml\n</code></pre>"
    },
    {
      "location": "environment-configuration/#3-alternative-azure-key-vault-integration",
      "title": "3. Alternative: Azure Key Vault Integration",
      "text": "<pre><code># Create Key Vault\naz keyvault create \\\n  --name aegis-kv-prod \\\n  --resource-group aegis-prod-rg \\\n  --location usgovvirginia\n\n# Add secrets\naz keyvault secret set --vault-name aegis-kv-prod --name DATABASE-PASSWORD --value '&lt;password&gt;'\naz keyvault secret set --vault-name aegis-kv-prod --name AZURE-STORAGE-KEY --value '&lt;storage-key&gt;'\naz keyvault secret set --vault-name aegis-kv-prod --name REDIS-PASSWORD --value '&lt;redis-key&gt;'\n</code></pre> <p>Then use Azure Key Vault CSI driver in Kubernetes or Azure App Service configuration.</p>"
    },
    {
      "location": "environment-configuration/#4-managed-identity-recommended",
      "title": "4. Managed Identity (Recommended)",
      "text": "<p>For production, use Azure Managed Identity instead of storage account keys:</p> <pre><code># Enable system-assigned managed identity on AKS or Container App\naz aks update \\\n  --resource-group aegis-prod-rg \\\n  --name aegis-aks-cluster \\\n  --enable-managed-identity\n\n# Grant identity access to storage\naz role assignment create \\\n  --assignee &lt;managed-identity-principal-id&gt; \\\n  --role \"Storage Blob Data Contributor\" \\\n  --scope /subscriptions/&lt;sub-id&gt;/resourceGroups/aegis-prod-rg/providers/Microsoft.Storage/storageAccounts/aegisblobprod\n</code></pre> <p>Update API environment to use managed identity:</p> <pre><code>STORAGE_PROVIDER=azure\nAZURE_STORAGE_ACCOUNT_NAME=aegisblobprod\nAZURE_STORAGE_CONTAINER=evidence\nAZURE_STORAGE_ENDPOINT=https://aegisblobprod.blob.core.usgovcloudapi.net\nAZURE_USE_MANAGED_IDENTITY=true\n# No need for AZURE_STORAGE_ACCOUNT_KEY when using managed identity\n</code></pre>"
    },
    {
      "location": "environment-configuration/#production-deployment",
      "title": "Production Deployment",
      "text": ""
    },
    {
      "location": "environment-configuration/#api-deployment-kubernetes",
      "title": "API Deployment (Kubernetes)",
      "text": "<p>Example deployment manifest:</p> <pre><code># api-deployment.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: aegis-api\n  namespace: aegis\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: aegis-api\n  template:\n    metadata:\n      labels:\n        app: aegis-api\n    spec:\n      containers:\n      - name: api\n        image: aegis-api:latest\n        ports:\n        - containerPort: 4000\n        envFrom:\n        - secretRef:\n            name: aegis-api-secrets\n        resources:\n          requests:\n            memory: \"512Mi\"\n            cpu: \"500m\"\n          limits:\n            memory: \"1Gi\"\n            cpu: \"1000m\"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 4000\n          initialDelaySeconds: 30\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 4000\n          initialDelaySeconds: 10\n          periodSeconds: 5\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: aegis-api-service\n  namespace: aegis\nspec:\n  selector:\n    app: aegis-api\n  ports:\n  - protocol: TCP\n    port: 80\n    targetPort: 4000\n  type: ClusterIP\n</code></pre>"
    },
    {
      "location": "environment-configuration/#bullmq-workers-separate-deployment",
      "title": "BullMQ Workers (Separate Deployment)",
      "text": "<p>For high-scale deployments, run workers separately:</p> <pre><code># workers-deployment.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: aegis-workers\n  namespace: aegis\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: aegis-workers\n  template:\n    metadata:\n      labels:\n        app: aegis-workers\n    spec:\n      containers:\n      - name: workers\n        image: aegis-api:latest\n        command: [\"node\", \"dist/queues/worker-manager.js\"]\n        envFrom:\n        - secretRef:\n            name: aegis-api-secrets\n        resources:\n          requests:\n            memory: \"256Mi\"\n            cpu: \"250m\"\n          limits:\n            memory: \"512Mi\"\n            cpu: \"500m\"\n</code></pre>"
    },
    {
      "location": "environment-configuration/#vercel-frontend-deployment",
      "title": "Vercel Frontend Deployment",
      "text": ""
    },
    {
      "location": "environment-configuration/#1-connect-repository-to-vercel",
      "title": "1. Connect Repository to Vercel",
      "text": "<ol> <li>Go to Vercel</li> <li>Click \"New Project\"</li> <li>Import your Git repository</li> <li>Select <code>packages/web</code> as the root directory</li> </ol>"
    },
    {
      "location": "environment-configuration/#2-configure-build-settings",
      "title": "2. Configure Build Settings",
      "text": "<ul> <li>Framework Preset: Vite</li> <li>Build Command: <code>npm run build</code></li> <li>Output Directory: <code>dist</code></li> <li>Install Command: <code>npm install</code></li> </ul>"
    },
    {
      "location": "environment-configuration/#3-environment-variables",
      "title": "3. Environment Variables",
      "text": "<p>Add in Vercel Project Settings \u2192 Environment Variables:</p>"
    },
    {
      "location": "environment-configuration/#production",
      "title": "Production",
      "text": "Name Value Environment <code>VITE_API_URL</code> <code>https://api.aegis.yourdomain.gov</code> Production"
    },
    {
      "location": "environment-configuration/#previewdevelopment",
      "title": "Preview/Development",
      "text": "Name Value Environment <code>VITE_API_URL</code> <code>https://api-dev.aegis.yourdomain.gov</code> Preview <code>VITE_API_URL</code> <code>http://localhost:4000</code> Development"
    },
    {
      "location": "environment-configuration/#4-custom-domain-optional",
      "title": "4. Custom Domain (Optional)",
      "text": "<p>Configure custom domain in Vercel:</p> <ol> <li>Go to Project Settings \u2192 Domains</li> <li>Add your domain: <code>aegis.yourdomain.gov</code></li> <li>Configure DNS records as instructed by Vercel</li> </ol>"
    },
    {
      "location": "environment-configuration/#5-deploy",
      "title": "5. Deploy",
      "text": "<p>Vercel will automatically deploy on: - Main branch: Production deployment - Feature branches: Preview deployments - Pull requests: Preview deployments</p>"
    },
    {
      "location": "environment-configuration/#environment-variable-reference",
      "title": "Environment Variable Reference",
      "text": ""
    },
    {
      "location": "environment-configuration/#api-server",
      "title": "API Server",
      "text": "Variable Required Default Description <code>DATABASE_HOST</code> Yes - PostgreSQL host <code>DATABASE_PORT</code> Yes 5432 PostgreSQL port <code>DATABASE_NAME</code> Yes - Database name <code>DATABASE_USER</code> Yes - Database user <code>DATABASE_PASSWORD</code> Yes - Database password <code>DATABASE_SSL</code> No false Enable SSL for database <code>STORAGE_PROVIDER</code> Yes s3 Storage provider: <code>s3</code> or <code>azure</code> <code>S3_ENDPOINT</code> If S3 - S3 endpoint (MinIO: http://localhost:9000) <code>S3_ACCESS_KEY_ID</code> If S3 - S3 access key <code>S3_SECRET_ACCESS_KEY</code> If S3 - S3 secret key <code>S3_BUCKET</code> If S3 - S3 bucket name <code>S3_REGION</code> If S3 us-east-1 S3 region <code>AZURE_STORAGE_ACCOUNT_NAME</code> If Azure - Azure storage account name <code>AZURE_STORAGE_ACCOUNT_KEY</code> If Azure - Azure storage account key <code>AZURE_STORAGE_CONTAINER</code> If Azure - Azure blob container name <code>AZURE_STORAGE_ENDPOINT</code> If Azure - Azure blob endpoint (Gov: core.usgovcloudapi.net) <code>AZURE_USE_MANAGED_IDENTITY</code> No false Use Azure Managed Identity <code>REDIS_HOST</code> Yes localhost Redis host <code>REDIS_PORT</code> Yes 6379 Redis port <code>REDIS_PASSWORD</code> No - Redis password <code>REDIS_TLS</code> No false Enable TLS for Redis <code>PORT</code> No 4000 API server port <code>NODE_ENV</code> No development Environment: development/production <code>LOG_LEVEL</code> No info Log level: debug/info/warn/error"
    },
    {
      "location": "environment-configuration/#web-frontend",
      "title": "Web Frontend",
      "text": "Variable Required Default Description <code>VITE_API_URL</code> Yes - API base URL"
    },
    {
      "location": "environment-configuration/#verification",
      "title": "Verification",
      "text": ""
    },
    {
      "location": "environment-configuration/#health-check",
      "title": "Health Check",
      "text": "<pre><code>curl http://localhost:4000/health\n# Expected: {\"status\":\"ok\",\"timestamp\":\"2024-01-01T00:00:00.000Z\"}\n</code></pre>"
    },
    {
      "location": "environment-configuration/#graphql-playground",
      "title": "GraphQL Playground",
      "text": "<p>Visit <code>http://localhost:4000/graphql</code> and run:</p> <pre><code>query {\n  listEvidence(page: 1, limit: 10) {\n    items {\n      id\n      projectName\n      buildId\n      createdAt\n    }\n    total\n  }\n}\n</code></pre>"
    },
    {
      "location": "environment-configuration/#upload-test",
      "title": "Upload Test",
      "text": "<pre><code>curl -X POST http://localhost:4000/api/v1/scans/upload \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Tenant-ID: 00000000-0000-0000-0000-000000000000\" \\\n  -d @test-data/upload-sample.json\n</code></pre>"
    },
    {
      "location": "environment-configuration/#troubleshooting",
      "title": "Troubleshooting",
      "text": ""
    },
    {
      "location": "environment-configuration/#database-connection-issues",
      "title": "Database Connection Issues",
      "text": "<pre><code># Test PostgreSQL connection\npsql -h localhost -U aegis -d aegis_dev\n\n# Check if database exists\n\\l\n\n# Check if tables exist\n\\dt\n</code></pre>"
    },
    {
      "location": "environment-configuration/#redis-connection-issues",
      "title": "Redis Connection Issues",
      "text": "<pre><code># Test Redis connection\nredis-cli -h localhost -p 6379 ping\n# Expected: PONG\n\n# List BullMQ queues\nredis-cli KEYS bull:*\n</code></pre>"
    },
    {
      "location": "environment-configuration/#minioazure-storage-issues",
      "title": "MinIO/Azure Storage Issues",
      "text": "<pre><code># Test MinIO connection (local)\nmc alias set local http://localhost:9000 minioadmin minioadmin\nmc ls local/aegis-evidence\n\n# Test Azure Blob Storage (production)\naz storage blob list \\\n  --account-name aegisblobprod \\\n  --container-name evidence \\\n  --auth-mode login\n</code></pre>"
    },
    {
      "location": "environment-configuration/#bullmq-worker-issues",
      "title": "BullMQ Worker Issues",
      "text": "<p>Check logs for worker startup:</p> <pre><code># Check API logs for worker initialization\nkubectl logs -f deployment/aegis-api -n aegis | grep \"worker\"\n\n# Expected output:\n# SBOM parser worker started\n# Vulnerability indexer worker started\n# POA&amp;M generator worker started\n</code></pre>"
    },
    {
      "location": "environment-configuration/#security-best-practices",
      "title": "Security Best Practices",
      "text": "<ol> <li>Never commit <code>.env</code> files to version control</li> <li>Use Kubernetes Secrets or Azure Key Vault for production</li> <li>Enable TLS for all external connections (Redis, PostgreSQL)</li> <li>Use Managed Identity in Azure Gov Cloud instead of access keys</li> <li>Rotate secrets regularly (90 days for FedRAMP compliance)</li> <li>Enable audit logging for storage account access</li> <li>Use network policies to restrict pod-to-pod communication</li> <li>Enable Azure Private Link for database and Redis</li> </ol>"
    },
    {
      "location": "environment-configuration/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Configure monitoring with Azure Monitor or Prometheus</li> <li>Set up log aggregation with Azure Log Analytics</li> <li>Implement backup and disaster recovery</li> <li>Configure auto-scaling for API and workers</li> <li>Set up CI/CD pipelines with GitHub Actions</li> </ul>"
    },
    {
      "location": "adr/",
      "title": "Architecture Decision Records (ADRs)",
      "text": "<p>This directory contains Architecture Decision Records for the Aegis DevSecOps Platform.</p>"
    },
    {
      "location": "adr/#what-is-an-adr",
      "title": "What is an ADR?",
      "text": "<p>An Architecture Decision Record (ADR) captures an important architectural decision made along with its context and consequences.</p>"
    },
    {
      "location": "adr/#adr-index",
      "title": "ADR Index",
      "text": "<ul> <li>ADR-001: Multi-tenant Kubernetes namespace isolation strategy</li> <li>ADR-002: Evidence blob storage architecture</li> <li>ADR-003: OSCAL-native POA&amp;M generation approach</li> <li>ADR-004: Platform One Keycloak integration for RBAC</li> <li>ADR-005: Chainguard zero-CVE container strategy</li> <li>ADR-006: Automated code remediation architecture</li> </ul>"
    },
    {
      "location": "adr/#format",
      "title": "Format",
      "text": "<p>Each ADR follows this structure:</p> <ol> <li>Title: Clear, concise decision statement</li> <li>Status: Proposed, Accepted, Deprecated, Superseded</li> <li>Context: What is the issue we're seeing that motivates this decision?</li> <li>Decision: What is the change we're proposing and/or doing?</li> <li>Consequences: What becomes easier or more difficult as a result of this change?</li> </ol>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/",
      "title": "ADR-001: Multi-tenant Kubernetes Namespace Isolation Strategy",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#context",
      "title": "Context",
      "text": "<p>Aegis is a multi-tenant SaaS platform serving government agencies and contractors with varying security clearance levels (IL2, IL4, IL5). We need to ensure complete data isolation between tenants while maximizing resource efficiency on shared Kubernetes infrastructure.</p> <p>Requirements:</p> <ul> <li>FedRAMP Moderate compliance (NIST 800-53 AC-3, SC-7)</li> <li>Complete data isolation between tenants</li> <li>Support for cross-tenant auditor role (read-only access for compliance)</li> <li>Efficient resource utilization</li> <li>Support for namespace-scoped Gatekeeper policies</li> <li>Integration with Platform One Big Bang deployment model</li> </ul> <p>Constraints:</p> <ul> <li>Must work with both AKS-Gov and EKS-Gov</li> <li>Must support Istio service mesh with mTLS</li> <li>Cannot use cluster-per-tenant (cost prohibitive at scale)</li> </ul>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#decision",
      "title": "Decision",
      "text": "<p>We will implement namespace-based multi-tenancy with the following architecture:</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#1-namespace-structure",
      "title": "1. Namespace Structure",
      "text": "<p>Each tenant receives a dedicated Kubernetes namespace:</p> <pre><code>aegis-tenant-&lt;tenant-slug&gt;\n</code></pre> <p>Example:</p> <ul> <li><code>aegis-tenant-acme-corp</code></li> <li><code>aegis-tenant-dod-agency-x</code></li> </ul>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#2-isolation-mechanisms",
      "title": "2. Isolation Mechanisms",
      "text": ""
    },
    {
      "location": "adr/001-multi-tenant-isolation/#network-isolation-nist-800-53-sc-7",
      "title": "Network Isolation (NIST 800-53 SC-7)",
      "text": "<ul> <li>Calico Network Policies (default deny-all)</li> <li>Explicit allow rules only for:</li> <li>Tenant namespace \u2192 Shared services (PostgreSQL, Redis)</li> <li>Istio sidecar traffic (mTLS enforced)</li> <li>Egress to S3-Gov for evidence storage</li> </ul> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: default-deny-all\n  namespace: aegis-tenant-acme-corp\nspec:\n  podSelector: {}\n  policyTypes:\n    - Ingress\n    - Egress\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#resource-quotas-nist-800-53-sc-6",
      "title": "Resource Quotas (NIST 800-53 SC-6)",
      "text": "<ul> <li>CPU limits per namespace (based on tenant tier)</li> <li>Memory limits per namespace</li> <li>Storage limits (PVC count and capacity)</li> <li>Pod count limits</li> </ul> <pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: tenant-quota\n  namespace: aegis-tenant-acme-corp\nspec:\n  hard:\n    requests.cpu: '10'\n    requests.memory: 20Gi\n    limits.cpu: '20'\n    limits.memory: 40Gi\n    persistentvolumeclaims: '10'\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#rbac-isolation-nist-800-53-ac-3",
      "title": "RBAC Isolation (NIST 800-53 AC-3)",
      "text": "<ul> <li>Service accounts scoped to namespace</li> <li>RoleBindings (not ClusterRoleBindings) for tenant users</li> <li>ClusterRole with namespace-scoped permissions</li> </ul> <pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: tenant-admin\n  namespace: aegis-tenant-acme-corp\nsubjects:\n  - kind: Group\n    name: acme-corp-admins\n    apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: ClusterRole\n  name: aegis-tenant-admin\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#pod-security-standards",
      "title": "Pod Security Standards",
      "text": "<ul> <li>Enforce <code>restricted</code> Pod Security Standard per namespace</li> <li>No privileged containers allowed</li> <li>No hostPath volumes</li> <li>Drop all capabilities</li> </ul> <pre><code>apiVersion: v1\nkind: Namespace\nmetadata:\n  name: aegis-tenant-acme-corp\n  labels:\n    pod-security.kubernetes.io/enforce: restricted\n    pod-security.kubernetes.io/audit: restricted\n    pod-security.kubernetes.io/warn: restricted\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#3-shared-services-architecture",
      "title": "3. Shared Services Architecture",
      "text": "<p>Shared services run in dedicated namespaces:</p> <ul> <li><code>aegis-system</code> - Aegis API, Workers, Web UI</li> <li><code>aegis-data</code> - PostgreSQL, Redis (with row-level security)</li> <li><code>istio-system</code> - Istio control plane</li> <li><code>gatekeeper-system</code> - OPA Gatekeeper</li> </ul>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#database-multi-tenancy-postgresql-row-level-security",
      "title": "Database Multi-tenancy (PostgreSQL Row-Level Security)",
      "text": "<p>All tables include <code>tenantId</code> column with RLS policies:</p> <pre><code>CREATE POLICY tenant_isolation ON evidence\n  USING (tenantId = current_setting('app.current_tenant')::uuid);\n\nALTER TABLE evidence ENABLE ROW LEVEL SECURITY;\n</code></pre> <p>Application sets session variable before queries:</p> <pre><code>SET app.current_tenant = '&lt;tenant-uuid&gt;';\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#4-cross-tenant-auditor-access",
      "title": "4. Cross-Tenant Auditor Access",
      "text": "<p>For compliance auditors requiring cross-tenant read access:</p> <ul> <li>ClusterRole with read-only permissions across all <code>aegis-tenant-*</code> namespaces</li> <li>Audit logs for all cross-tenant access (NIST 800-53 AU-2)</li> <li>Time-limited RBAC tokens (maximum 8 hours)</li> </ul> <pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: aegis-auditor\nrules:\n  - apiGroups: ['']\n    resources: ['pods', 'services', 'configmaps']\n    verbs: ['get', 'list']\n    resourceNames: []\n  - apiGroups: ['apps']\n    resources: ['deployments', 'statefulsets']\n    verbs: ['get', 'list']\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#5-gatekeeper-policy-enforcement",
      "title": "5. Gatekeeper Policy Enforcement",
      "text": "<p>Namespace-scoped Constraint instances:</p> <pre><code>apiVersion: constraints.gatekeeper.sh/v1beta1\nkind: K8sRequiredLabels\nmetadata:\n  name: tenant-required-labels\nspec:\n  match:\n    namespaces: ['aegis-tenant-acme-corp']\n  parameters:\n    labels:\n      - key: 'tenant'\n        value: 'acme-corp'\n</code></pre>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/001-multi-tenant-isolation/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Cost-efficient: Shared cluster reduces infrastructure costs vs. cluster-per-tenant \u2705 Compliance: Meets NIST 800-53 AC-3 (Access Enforcement) and SC-7 (Boundary Protection) \u2705 Scalability: Can support 1000+ tenants on single cluster \u2705 Flexibility: Easy to migrate tenant to dedicated cluster if needed (same namespace structure) \u2705 Auditor-friendly: Cross-tenant read access without breaking isolation \u2705 Big Bang compatible: Works with Platform One deployment model</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#negative",
      "title": "Negative",
      "text": "<p>\u274c Noisy neighbor risk: Resource quotas must be carefully tuned \u274c Blast radius: Cluster-level security issue affects all tenants (mitigated by private cluster) \u274c Operational complexity: More namespaces to manage vs. single namespace \u274c Istio overhead: Service mesh adds latency (~5ms) and resource usage</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Migration path: If IL5+ requires dedicated clusters, namespace structure remains the same \u2696\ufe0f Database performance: Row-level security adds ~2% query overhead (acceptable for compliance)</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/001-multi-tenant-isolation/#alternative-1-cluster-per-tenant",
      "title": "Alternative 1: Cluster-per-tenant",
      "text": "<p>Rejected: Cost prohibitive (each cluster ~$500/month), operational overhead unmanageable at scale.</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#alternative-2-single-namespace-with-label-based-isolation",
      "title": "Alternative 2: Single namespace with label-based isolation",
      "text": "<p>Rejected: Does not meet NIST 800-53 requirement for boundary protection (SC-7). Gatekeeper policies cannot enforce tenant isolation without namespaces.</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#alternative-3-virtual-clusters-vcluster",
      "title": "Alternative 3: Virtual clusters (vCluster)",
      "text": "<p>Rejected: Adds significant complexity, not supported by Platform One Big Bang, unproven in government cloud environments.</p>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>Namespace provisioning automated via Aegis API (Kubernetes client)</li> <li>Terraform creates namespace resources during tenant onboarding</li> <li>NetworkPolicies generated dynamically based on tenant settings</li> <li>FluxCD manages per-namespace GitOps deployments</li> </ul>"
    },
    {
      "location": "adr/001-multi-tenant-isolation/#references",
      "title": "References",
      "text": "<ul> <li>NIST 800-53 Rev 5: AC-3 (Access Enforcement), SC-7 (Boundary Protection), SC-6 (Resource Availability)</li> <li>Kubernetes Multi-tenancy SIG</li> <li>Platform One Big Bang Docs</li> <li>FedRAMP Rev 5 Baseline Controls</li> </ul>"
    },
    {
      "location": "adr/002-evidence-storage/",
      "title": "ADR-002: Evidence Blob Storage Architecture",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team</p>"
    },
    {
      "location": "adr/002-evidence-storage/#context",
      "title": "Context",
      "text": "<p>Aegis ingests large volumes of evidence artifacts from CI/CD pipelines:</p> <ul> <li>SBOM documents (SPDX JSON, CycloneDX JSON) - 500KB to 50MB per build</li> <li>Vulnerability scan results (Grype JSON) - 100KB to 10MB per scan</li> <li>Cosign signature bundles - 5KB to 50KB per image</li> <li>POA&amp;M exports (OSCAL JSON, CSV, DOCX) - 50KB to 5MB per export</li> <li>Audit logs (JSON) - 1KB to 100KB per log entry</li> </ul> <p>Volume estimates:</p> <ul> <li>1000 builds/day \u00d7 10MB average = 10GB/day (3.65TB/year)</li> <li>Retention: 2 years minimum (FedRAMP requirement)</li> <li>Total storage: 7.3TB for active data</li> </ul> <p>Requirements:</p> <ul> <li>NIST 800-53 SC-8: Encryption at rest (AES-256)</li> <li>NIST 800-53 SC-13: FIPS 140-2 validated cryptographic modules</li> <li>Multi-cloud support (Azure Gov + AWS GovCloud)</li> <li>PostgreSQL database must NOT store large blobs (performance)</li> <li>Fast retrieval for POA&amp;M generation (&lt;500ms)</li> <li>Immutable storage (compliance evidence cannot be modified)</li> <li>Geographic redundancy (IL4/IL5 requirement)</li> </ul>"
    },
    {
      "location": "adr/002-evidence-storage/#decision",
      "title": "Decision",
      "text": "<p>We will use S3-compatible object storage with the following architecture:</p>"
    },
    {
      "location": "adr/002-evidence-storage/#1-storage-backend",
      "title": "1. Storage Backend",
      "text": "<p>Production (Government Cloud):</p> <ul> <li>AWS GovCloud: S3-Gov buckets (<code>us-gov-west-1</code> + <code>us-gov-east-1</code> for DR)</li> <li>Azure Government: Azure Blob Storage with versioning enabled</li> </ul> <p>Development:</p> <ul> <li>Local: MinIO (S3-compatible) for development and testing</li> </ul>"
    },
    {
      "location": "adr/002-evidence-storage/#2-bucket-structure",
      "title": "2. Bucket Structure",
      "text": "<pre><code>aegis-evidence-{environment}-{region}\n\u251c\u2500\u2500 sbom/\n\u2502   \u2514\u2500\u2500 {tenantId}/\n\u2502       \u2514\u2500\u2500 {projectId}/\n\u2502           \u2514\u2500\u2500 {buildId}/\n\u2502               \u2514\u2500\u2500 sbom-{sha256}.spdx.json\n\u251c\u2500\u2500 scans/\n\u2502   \u2514\u2500\u2500 {tenantId}/\n\u2502       \u2514\u2500\u2500 {projectId}/\n\u2502           \u2514\u2500\u2500 {buildId}/\n\u2502               \u2514\u2500\u2500 grype-{sha256}.json\n\u251c\u2500\u2500 signatures/\n\u2502   \u2514\u2500\u2500 {tenantId}/\n\u2502       \u2514\u2500\u2500 {imageDigest}/\n\u2502           \u2514\u2500\u2500 signature-{timestamp}.json\n\u251c\u2500\u2500 poam/\n\u2502   \u2514\u2500\u2500 {tenantId}/\n\u2502       \u2514\u2500\u2500 {exportId}/\n\u2502           \u251c\u2500\u2500 poam-{date}.oscal.json\n\u2502           \u251c\u2500\u2500 poam-{date}.csv\n\u2502           \u2514\u2500\u2500 poam-{date}.docx\n\u2514\u2500\u2500 audit-logs/\n    \u2514\u2500\u2500 {tenantId}/\n        \u2514\u2500\u2500 {year}/\n            \u2514\u2500\u2500 {month}/\n                \u2514\u2500\u2500 {day}/\n                    \u2514\u2500\u2500 audit-{hour}.jsonl\n</code></pre> <p>Example S3 URI:</p> <pre><code>s3://aegis-evidence-prod-usgovwest1/sbom/550e8400-e29b-41d4-a716-446655440000/proj-123/build-456/sbom-abc123.spdx.json\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#3-database-schema-postgresql",
      "title": "3. Database Schema (PostgreSQL)",
      "text": "<p>Store only metadata in PostgreSQL, not blob content:</p> <pre><code>CREATE TABLE evidence (\n  id UUID PRIMARY KEY,\n  tenant_id UUID NOT NULL REFERENCES tenants(id),\n  project_name VARCHAR(255) NOT NULL,\n  build_id VARCHAR(255) NOT NULL,\n  image_digest VARCHAR(255) NOT NULL,\n  type VARCHAR(50) NOT NULL, -- 'SBOM' | 'VULNERABILITY_SCAN' | 'SIGNATURE'\n  format VARCHAR(50), -- 'SPDX_2_3' | 'CYCLONEDX_1_4'\n  s3_uri VARCHAR(512) NOT NULL, -- Full S3 path\n  s3_bucket VARCHAR(255) NOT NULL,\n  s3_key VARCHAR(512) NOT NULL,\n  file_size_bytes BIGINT,\n  sha256_checksum VARCHAR(64), -- For integrity verification\n  metadata JSONB DEFAULT '{}',\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW(),\n  CONSTRAINT evidence_tenant_isolation CHECK (tenant_id IS NOT NULL)\n);\n\nCREATE INDEX idx_evidence_tenant_project ON evidence(tenant_id, project_name);\nCREATE INDEX idx_evidence_s3_uri ON evidence(s3_uri);\nCREATE INDEX idx_evidence_image_digest ON evidence(image_digest);\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#4-encryption-configuration",
      "title": "4. Encryption Configuration",
      "text": ""
    },
    {
      "location": "adr/002-evidence-storage/#aws-s3-gov",
      "title": "AWS S3-Gov",
      "text": "<pre><code>resource \"aws_s3_bucket\" \"evidence\" {\n  bucket = \"aegis-evidence-prod-usgovwest1\"\n  acl    = \"private\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm     = \"aws:kms\"\n        kms_master_key_id = aws_kms_key.aegis.arn\n      }\n      bucket_key_enabled = true\n    }\n  }\n\n  versioning {\n    enabled = true # Immutability requirement\n  }\n\n  lifecycle_rule {\n    id      = \"transition-to-glacier\"\n    enabled = true\n\n    transition {\n      days          = 90\n      storage_class = \"GLACIER\" # Cost optimization\n    }\n\n    transition {\n      days          = 365\n      storage_class = \"DEEP_ARCHIVE\"\n    }\n\n    expiration {\n      days = 730 # 2 years retention\n    }\n  }\n\n  object_lock_configuration {\n    object_lock_enabled = \"Enabled\" # Immutable storage (WORM)\n  }\n\n  replication_configuration {\n    role = aws_iam_role.replication.arn\n\n    rules {\n      id     = \"replicate-to-dr\"\n      status = \"Enabled\"\n\n      destination {\n        bucket        = aws_s3_bucket.evidence_dr.arn\n        storage_class = \"STANDARD_IA\"\n      }\n    }\n  }\n\n  tags = {\n    Compliance  = \"NIST-800-53\"\n    FIPS        = \"140-2\"\n    Environment = \"prod-gov\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#azure-blob-storage-government",
      "title": "Azure Blob Storage (Government)",
      "text": "<pre><code>resource \"azurerm_storage_account\" \"evidence\" {\n  name                     = \"aegisevidenceprod\"\n  resource_group_name      = azurerm_resource_group.aegis.name\n  location                 = \"usgovvirginia\"\n  account_tier             = \"Standard\"\n  account_replication_type = \"GZRS\" # Geo-zone redundant\n  account_kind             = \"StorageV2\"\n\n  enable_https_traffic_only = true\n  min_tls_version          = \"TLS1_2\"\n\n  blob_properties {\n    versioning_enabled       = true\n    change_feed_enabled      = true # For audit trail\n    last_access_time_enabled = true\n\n    delete_retention_policy {\n      days = 730\n    }\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  customer_managed_key {\n    key_vault_key_id = azurerm_key_vault_key.aegis.id\n  }\n\n  tags = {\n    Compliance  = \"NIST-800-53\"\n    FIPS        = \"140-2\"\n    Environment = \"prod-gov\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#5-access-control",
      "title": "5. Access Control",
      "text": ""
    },
    {
      "location": "adr/002-evidence-storage/#s3-bucket-policy-least-privilege",
      "title": "S3 Bucket Policy (Least Privilege)",
      "text": "<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AegisAPIReadWrite\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws-us-gov:iam::123456789012:role/aegis-api-role\"\n      },\n      \"Action\": [\"s3:PutObject\", \"s3:GetObject\", \"s3:GetObjectVersion\"],\n      \"Resource\": \"arn:aws-us-gov:s3:::aegis-evidence-prod-usgovwest1/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:x-amz-server-side-encryption\": \"aws:kms\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyInsecureTransport\",\n      \"Effect\": \"Deny\",\n      \"Principal\": \"*\",\n      \"Action\": \"s3:*\",\n      \"Resource\": \"arn:aws-us-gov:s3:::aegis-evidence-prod-usgovwest1/*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"false\"\n        }\n      }\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#6-application-layer-nodejs-sdk",
      "title": "6. Application Layer (Node.js SDK)",
      "text": "<pre><code>import {\n  S3Client,\n  PutObjectCommand,\n  GetObjectCommand,\n} from '@aws-sdk/client-s3';\nimport { createHash } from 'crypto';\n\nexport class EvidenceStorageService {\n  private s3: S3Client;\n  private bucket: string;\n\n  async uploadSBOM(\n    tenantId: string,\n    projectId: string,\n    buildId: string,\n    sbomContent: string\n  ): Promise&lt;{ s3Uri: string; sha256: string }&gt; {\n    const sha256 = createHash('sha256').update(sbomContent).digest('hex');\n    const key = `sbom/${tenantId}/${projectId}/${buildId}/sbom-${sha256}.spdx.json`;\n\n    await this.s3.send(\n      new PutObjectCommand({\n        Bucket: this.bucket,\n        Key: key,\n        Body: sbomContent,\n        ContentType: 'application/json',\n        ServerSideEncryption: 'aws:kms',\n        Metadata: {\n          tenantId,\n          projectId,\n          buildId,\n          sha256,\n        },\n      })\n    );\n\n    return {\n      s3Uri: `s3://${this.bucket}/${key}`,\n      sha256,\n    };\n  }\n\n  async retrieveSBOM(s3Uri: string): Promise&lt;string&gt; {\n    const { bucket, key } = this.parseS3Uri(s3Uri);\n\n    const response = await this.s3.send(\n      new GetObjectCommand({ Bucket: bucket, Key: key })\n    );\n\n    return (await response.Body?.transformToString()) ?? '';\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/002-evidence-storage/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/002-evidence-storage/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Performance: PostgreSQL queries remain fast (no large blob storage) \u2705 Scalability: S3 scales infinitely, handles petabytes of data \u2705 Cost-effective: S3 Glacier reduces storage costs by 90% after 90 days \u2705 Compliance: Immutable storage (WORM), encryption at rest (FIPS 140-2) \u2705 Durability: 99.999999999% (11 nines) with cross-region replication \u2705 Multi-cloud: Same architecture works on Azure Blob Storage</p>"
    },
    {
      "location": "adr/002-evidence-storage/#negative",
      "title": "Negative",
      "text": "<p>\u274c Network latency: Retrieving blobs adds 50-200ms vs. database \u274c Eventual consistency: S3 replication has 1-5 second delay \u274c Complexity: Two systems to manage (PostgreSQL + S3) \u274c Cost: S3 API calls add operational cost (~$0.005 per 1000 requests)</p>"
    },
    {
      "location": "adr/002-evidence-storage/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Backup strategy: S3 versioning provides point-in-time recovery \u2696\ufe0f Data migration: Moving between clouds requires bulk S3 copy (manageable with AWS DataSync)</p>"
    },
    {
      "location": "adr/002-evidence-storage/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/002-evidence-storage/#alternative-1-store-blobs-in-postgresql-bytea-column",
      "title": "Alternative 1: Store blobs in PostgreSQL BYTEA column",
      "text": "<p>Rejected: Degrades database performance. 10MB blob causes 10MB memory allocation per query. VACUUM becomes extremely slow.</p>"
    },
    {
      "location": "adr/002-evidence-storage/#alternative-2-mongodb-gridfs",
      "title": "Alternative 2: MongoDB GridFS",
      "text": "<p>Rejected: Adds another database to manage. No government cloud compliance story. Not FedRAMP authorized.</p>"
    },
    {
      "location": "adr/002-evidence-storage/#alternative-3-distributed-filesystem-glusterfs-ceph",
      "title": "Alternative 3: Distributed filesystem (GlusterFS, Ceph)",
      "text": "<p>Rejected: Operational complexity too high. No managed service in government cloud. Kubernetes persistent volumes not designed for multi-TB datasets.</p>"
    },
    {
      "location": "adr/002-evidence-storage/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>Use AWS SDK v3 (<code>@aws-sdk/client-s3</code>) for Node.js</li> <li>Implement retry logic with exponential backoff (S3 throttling)</li> <li>Pre-signed URLs for direct browser uploads (future feature)</li> <li>CloudWatch/Azure Monitor metrics for bucket access patterns</li> <li>Lifecycle policies automated via Terraform</li> </ul>"
    },
    {
      "location": "adr/002-evidence-storage/#references",
      "title": "References",
      "text": "<ul> <li>NIST 800-53 Rev 5: SC-8 (Transmission Confidentiality), SC-13 (Cryptographic Protection), SC-28 (Protection of Information at Rest)</li> <li>AWS S3 Object Lock</li> <li>Azure Immutable Blob Storage</li> <li>FedRAMP Rev 5 Control SC-28</li> </ul>"
    },
    {
      "location": "adr/003-oscal-poam/",
      "title": "ADR-003: OSCAL-Native POA&amp;M Generation Approach",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team, Compliance Team</p>"
    },
    {
      "location": "adr/003-oscal-poam/#context",
      "title": "Context",
      "text": "<p>Plan of Action and Milestones (POA&amp;M) is a critical FedRAMP deliverable for tracking security vulnerabilities and remediation progress. Traditional POA&amp;M workflows involve manual Excel/Word document creation, which is error-prone and time-consuming.</p> <p>Current State:</p> <ul> <li>Manual POA&amp;M creation takes 2-4 hours per report</li> <li>Copy-paste errors lead to compliance findings</li> <li>No automated tracking of CVE \u2192 POA&amp;M item linkage</li> <li>Excel templates incompatible with automation tools</li> </ul> <p>Requirements:</p> <ul> <li>OSCAL 1.0.4 compliance (FedRAMP automation initiative)</li> <li>Map CVEs to POA&amp;M items automatically</li> <li>Calculate risk scores using CVSS v3.1 + NIST 800-30</li> <li>Export to multiple formats: OSCAL JSON, CSV, DOCX</li> <li>Integration with FedRAMP automation platform</li> <li>Real-time POA&amp;M updates as vulnerabilities are remediated</li> </ul>"
    },
    {
      "location": "adr/003-oscal-poam/#decision",
      "title": "Decision",
      "text": "<p>We will implement OSCAL-native POA&amp;M generation with automatic CVE mapping:</p>"
    },
    {
      "location": "adr/003-oscal-poam/#1-oscal-poam-data-model",
      "title": "1. OSCAL POA&amp;M Data Model",
      "text": "<p>Use OSCAL 1.0.4 <code>plan-of-action-and-milestones</code> schema:</p> <pre><code>{\n  \"plan-of-action-and-milestones\": {\n    \"uuid\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"metadata\": {\n      \"title\": \"Aegis POA&amp;M - Tenant: Acme Corp\",\n      \"last-modified\": \"2024-12-11T10:00:00Z\",\n      \"version\": \"1.0\",\n      \"oscal-version\": \"1.0.4\"\n    },\n    \"system-id\": {\n      \"identifier-type\": \"https://fedramp.gov\",\n      \"id\": \"F00000000\"\n    },\n    \"poam-items\": [\n      {\n        \"uuid\": \"cve-2024-1234-poam\",\n        \"title\": \"CVE-2024-1234 in libssl 1.1.1\",\n        \"description\": \"Critical vulnerability in OpenSSL library\",\n        \"related-observations\": [\n          {\n            \"observation-uuid\": \"grype-scan-20241211\"\n          }\n        ],\n        \"risk\": {\n          \"status\": \"open\",\n          \"characterization\": {\n            \"facets\": [\n              {\n                \"name\": \"likelihood\",\n                \"system\": \"https://fedramp.gov\",\n                \"value\": \"high\"\n              },\n              {\n                \"name\": \"impact\",\n                \"system\": \"https://fedramp.gov\",\n                \"value\": \"high\"\n              }\n            ]\n          }\n        },\n        \"remediation-tracking\": {\n          \"tracking-entries\": [\n            {\n              \"uuid\": \"remediation-1\",\n              \"date-time-stamp\": \"2024-12-11T10:00:00Z\",\n              \"title\": \"Upgrade libssl to 3.0.0\",\n              \"description\": \"Update base image to Ubuntu 22.04 with OpenSSL 3.0\"\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#2-automatic-cve-poam-mapping",
      "title": "2. Automatic CVE \u2192 POA&amp;M Mapping",
      "text": "<p>Mapping Logic:</p> <pre><code>interface POAMGenerationRule {\n  // Only create POA&amp;M items for vulnerabilities meeting criteria\n  severityThreshold:\n    | VulnerabilitySeverity.HIGH\n    | VulnerabilitySeverity.CRITICAL;\n\n  // Calculate due date based on severity (NIST 800-40 guidance)\n  dueDateDays: {\n    CRITICAL: 30; // 30 days\n    HIGH: 90; // 90 days\n    MEDIUM: 180; // 180 days (optional)\n    LOW: 365; // 365 days (optional)\n  };\n\n  // Risk level mapping (CVSS v3.1 \u2192 NIST 800-30)\n  riskLevelMapping: {\n    cvssScore: number;\n    nistRiskLevel: 'very-high' | 'high' | 'moderate' | 'low';\n  }[];\n}\n\nasync function generatePOAMFromVulnerabilities(\n  vulnerabilities: Vulnerability[],\n  tenantId: string\n): Promise&lt;OSCALPOAMDocument&gt; {\n  const poamItems: POAMItem[] = [];\n\n  for (const vuln of vulnerabilities) {\n    if (vuln.severity === 'CRITICAL' || vuln.severity === 'HIGH') {\n      const poamItem = {\n        uuid: `cve-${vuln.cveId}-${uuidv4()}`,\n        title: `${vuln.cveId} in ${vuln.packageName}@${vuln.packageVersion}`,\n        description: vuln.description,\n\n        // NIST 800-30 risk assessment\n        risk: calculateRisk(vuln.cvssScore, vuln.severity),\n\n        // Remediation steps\n        remediationTracking: {\n          trackingEntries: [\n            {\n              title: `Upgrade ${vuln.packageName} to ${vuln.fixedVersion}`,\n              description: generateRemediationSteps(vuln),\n              scheduledCompletionDate: calculateDueDate(vuln.severity),\n            },\n          ],\n        },\n\n        // Link to original vulnerability scan\n        relatedObservations: [\n          {\n            observationUuid: vuln.evidenceId,\n          },\n        ],\n      };\n\n      poamItems.push(poamItem);\n    }\n  }\n\n  return {\n    'plan-of-action-and-milestones': {\n      uuid: uuidv4(),\n      metadata: generateMetadata(tenantId),\n      poamItems,\n    },\n  };\n}\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#3-risk-score-calculation-nist-800-30",
      "title": "3. Risk Score Calculation (NIST 800-30)",
      "text": "<pre><code>function calculateRisk(\n  cvssScore: number,\n  severity: string\n): RiskCharacterization {\n  // NIST 800-30 Risk = Likelihood \u00d7 Impact\n  // CVSS Score \u2192 Likelihood mapping\n  const likelihood =\n    cvssScore &gt;= 9.0 ? 'high' : cvssScore &gt;= 7.0 ? 'medium' : 'low';\n\n  // Severity \u2192 Impact mapping\n  const impact =\n    severity === 'CRITICAL' ? 'high' : severity === 'HIGH' ? 'medium' : 'low';\n\n  // Risk matrix\n  const riskMatrix = {\n    'high-high': 'very-high',\n    'high-medium': 'high',\n    'high-low': 'moderate',\n    'medium-high': 'high',\n    'medium-medium': 'moderate',\n    'medium-low': 'low',\n    'low-high': 'moderate',\n    'low-medium': 'low',\n    'low-low': 'low',\n  };\n\n  const riskLevel = riskMatrix[`${likelihood}-${impact}`];\n\n  return {\n    status: 'open',\n    characterization: {\n      facets: [\n        {\n          name: 'likelihood',\n          system: 'https://fedramp.gov',\n          value: likelihood,\n        },\n        { name: 'impact', system: 'https://fedramp.gov', value: impact },\n        { name: 'risk-level', system: 'https://fedramp.gov', value: riskLevel },\n        {\n          name: 'cvss-score',\n          system: 'https://www.first.org/cvss',\n          value: cvssScore.toString(),\n        },\n      ],\n    },\n  };\n}\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#4-export-formats",
      "title": "4. Export Formats",
      "text": ""
    },
    {
      "location": "adr/003-oscal-poam/#oscal-json-primary-format",
      "title": "OSCAL JSON (Primary Format)",
      "text": "<ul> <li>Direct export of OSCAL data model</li> <li>Validated against OSCAL 1.0.4 JSON schema</li> <li>Compatible with FedRAMP automation tools</li> </ul>"
    },
    {
      "location": "adr/003-oscal-poam/#csv-legacy-compatibility",
      "title": "CSV (Legacy Compatibility)",
      "text": "<pre><code>POA&amp;M Item ID,Weakness Name,Weakness Description,Severity,Remediation Plan,Scheduled Completion Date,Status\nCVE-2024-1234,OpenSSL Vulnerability,Critical vulnerability in libssl,Very High,Upgrade to libssl 3.0.0,2025-01-15,Open\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#docx-official-poam-template",
      "title": "DOCX (Official POA&amp;M Template)",
      "text": "<ul> <li>Use OpenXML SDK to generate Word documents</li> <li>FedRAMP POA&amp;M template (OMB A-123)</li> <li>Populate tables with POA&amp;M items</li> </ul> <pre><code>import PizZip from 'pizzip';\nimport Docxtemplater from 'docxtemplater';\n\nasync function exportPOAMToDocx(poam: OSCALPOAM): Promise&lt;Buffer&gt; {\n  const templatePath = './templates/fedramp-poam-template.docx';\n  const content = await fs.readFile(templatePath);\n\n  const zip = new PizZip(content);\n  const doc = new Docxtemplater(zip, {\n    paragraphLoop: true,\n    linebreaks: true,\n  });\n\n  doc.render({\n    systemName: poam.metadata.title,\n    dateGenerated: new Date().toISOString().split('T')[0],\n    poamItems: poam.poamItems.map((item) =&gt; ({\n      id: item.uuid,\n      weakness: item.title,\n      description: item.description,\n      severity: item.risk.characterization.facets.find(\n        (f) =&gt; f.name === 'risk-level'\n      )?.value,\n      remediation: item.remediationTracking.trackingEntries[0]?.title ?? '',\n      dueDate:\n        item.remediationTracking.trackingEntries[0]?.scheduledCompletionDate ??\n        '',\n      status: item.risk.status,\n    })),\n  });\n\n  return doc.getZip().generate({ type: 'nodebuffer' });\n}\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#5-continuous-poam-updates",
      "title": "5. Continuous POA&amp;M Updates",
      "text": "<p>Workflow:</p> <ol> <li>CI/CD pipeline uploads new vulnerability scan</li> <li>Aegis worker processes scan results</li> <li>New CVEs automatically create POA&amp;M items</li> <li>Fixed CVEs automatically update POA&amp;M status to \"closed\"</li> <li>ISSO receives email notification of changes</li> <li>Updated OSCAL POA&amp;M available via API</li> </ol> <pre><code>// Automatic POA&amp;M status update\nasync function updatePOAMStatus(\n  cveId: string,\n  tenantId: string\n): Promise&lt;void&gt; {\n  const latestScan = await getLatestVulnerabilityScan(tenantId);\n  const cveStillPresent = latestScan.matches.some(\n    (m) =&gt; m.vulnerability.id === cveId\n  );\n\n  if (!cveStillPresent) {\n    await db.poamItem.update({\n      where: { cveId, tenantId },\n      data: {\n        status: POAMStatus.CLOSED,\n        closedDate: new Date(),\n        closureRationale: 'CVE no longer detected in latest vulnerability scan',\n      },\n    });\n\n    await sendNotification({\n      to: await getISSOEmail(tenantId),\n      subject: `POA&amp;M Item Closed: ${cveId}`,\n      body: `Vulnerability ${cveId} has been successfully remediated.`,\n    });\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/003-oscal-poam/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/003-oscal-poam/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Automation: POA&amp;M generation time reduced from 2-4 hours to &lt;1 minute \u2705 Accuracy: Eliminates copy-paste errors and manual tracking \u2705 Compliance: OSCAL 1.0.4 compliance enables FedRAMP automation \u2705 Real-time: POA&amp;M updates automatically as vulnerabilities are fixed \u2705 Auditability: Complete trail from CVE \u2192 Scan \u2192 POA&amp;M item \u2705 Integration: OSCAL JSON can be imported into GRC tools</p>"
    },
    {
      "location": "adr/003-oscal-poam/#negative",
      "title": "Negative",
      "text": "<p>\u274c Learning curve: ISSOs must understand OSCAL format \u274c Validation complexity: OSCAL schema validation adds processing overhead \u274c Template maintenance: FedRAMP DOCX template changes require updates \u274c Risk calculation: NIST 800-30 mapping may not align with org-specific risk frameworks</p>"
    },
    {
      "location": "adr/003-oscal-poam/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Legacy support: CSV/DOCX exports maintain compatibility with non-OSCAL tools \u2696\ufe0f Manual overrides: ISSOs can manually adjust risk levels and due dates</p>"
    },
    {
      "location": "adr/003-oscal-poam/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/003-oscal-poam/#alternative-1-manual-poam-creation-status-quo",
      "title": "Alternative 1: Manual POA&amp;M creation (status quo)",
      "text": "<p>Rejected: Does not scale. Human error rate too high. No automation possible.</p>"
    },
    {
      "location": "adr/003-oscal-poam/#alternative-2-custom-json-schema-not-oscal",
      "title": "Alternative 2: Custom JSON schema (not OSCAL)",
      "text": "<p>Rejected: Not FedRAMP-compliant. Cannot integrate with gov automation tools. Reinventing the wheel.</p>"
    },
    {
      "location": "adr/003-oscal-poam/#alternative-3-direct-integration-with-grc-tools-archer-servicenow",
      "title": "Alternative 3: Direct integration with GRC tools (Archer, ServiceNow)",
      "text": "<p>Rejected: Vendor lock-in. Not all agencies use same GRC tool. OSCAL provides vendor-neutral format.</p>"
    },
    {
      "location": "adr/003-oscal-poam/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>Use <code>oscal-js</code> library for OSCAL validation</li> <li>Store POA&amp;M items in PostgreSQL with JSONB column for OSCAL data</li> <li>GraphQL query: <code>generatePOAM(tenantId: String, dateRange: DateRange): OSCALPOAMDocument</code></li> <li>REST endpoint: <code>GET /api/v1/tenants/:id/poam/export?format=oscal|csv|docx</code></li> <li>Scheduled job: Daily POA&amp;M regeneration for all tenants</li> </ul>"
    },
    {
      "location": "adr/003-oscal-poam/#references",
      "title": "References",
      "text": "<ul> <li>OSCAL 1.0.4 Specification</li> <li>NIST 800-30 Rev 1: Risk Assessment</li> <li>NIST 800-40 Rev 4: Patch Management</li> <li>FedRAMP POA&amp;M Template</li> <li>FedRAMP Automation</li> </ul>"
    },
    {
      "location": "adr/004-keycloak-rbac/",
      "title": "ADR-004: Platform One Keycloak Integration for RBAC",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team, Security Team</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#context",
      "title": "Context",
      "text": "<p>Aegis requires enterprise-grade authentication and role-based access control (RBAC) to support multi-tenant government deployments. Users have varying roles (OrgAdmin, ISSO, DevSecOps, Developer, Auditor) with different permission levels.</p> <p>Requirements:</p> <ul> <li>NIST 800-53 IA-2: Identification and Authentication</li> <li>NIST 800-53 AC-2: Account Management</li> <li>NIST 800-53 AC-3: Access Enforcement</li> <li>NIST 800-53 AC-6: Least Privilege</li> <li>Multi-factor authentication (MFA) required for IL4+</li> <li>Integration with DoD PKI (CAC/PIV cards) for IL5</li> <li>SSO across Platform One ecosystem</li> <li>Support for 5 distinct roles with different permissions</li> </ul> <p>Constraints:</p> <ul> <li>Must work with Platform One Big Bang deployment</li> <li>Government cloud environments (Azure Gov, AWS GovCloud)</li> <li>Cannot build custom auth system (security risk, compliance burden)</li> </ul>"
    },
    {
      "location": "adr/004-keycloak-rbac/#decision",
      "title": "Decision",
      "text": "<p>We will integrate with Platform One Keycloak for authentication and RBAC:</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#1-keycloak-configuration",
      "title": "1. Keycloak Configuration",
      "text": "<p>Platform One Keycloak Instance:</p> <ul> <li>URL: <code>https://login.dso.mil</code></li> <li>Realm: <code>baby-yoda</code> (Platform One standard realm)</li> <li>Protocol: OpenID Connect (OIDC)</li> </ul> <p>Client Configuration:</p> <pre><code>{\n  \"clientId\": \"aegis\",\n  \"name\": \"Aegis DevSecOps Platform\",\n  \"protocol\": \"openid-connect\",\n  \"rootUrl\": \"https://aegis.dso.mil\",\n  \"redirectUris\": [\"https://aegis.dso.mil/*\", \"http://localhost:3000/*\"],\n  \"webOrigins\": [\"+\"],\n  \"publicClient\": false,\n  \"clientAuthenticatorType\": \"client-secret\",\n  \"standardFlowEnabled\": true,\n  \"directAccessGrantsEnabled\": false,\n  \"serviceAccountsEnabled\": true,\n  \"authorizationServicesEnabled\": true,\n  \"attributes\": {\n    \"pkce.code.challenge.method\": \"S256\",\n    \"access.token.lifespan\": \"300\",\n    \"sso.session.idle.timeout\": \"1800\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#2-role-definitions",
      "title": "2. Role Definitions",
      "text": "<p>Keycloak Realm Roles (mapped to Aegis roles):</p> <pre><code>roles:\n  - name: aegis-org-admin\n    description: 'Organization Administrator - Full tenant management'\n    composite: false\n\n  - name: aegis-isso\n    description: 'Information System Security Officer - Compliance &amp; audit'\n    composite: false\n\n  - name: aegis-devsecops\n    description: 'DevSecOps Engineer - CI/CD and policy management'\n    composite: false\n\n  - name: aegis-developer\n    description: 'Developer - Read-only evidence access'\n    composite: false\n\n  - name: aegis-auditor\n    description: 'Auditor - Cross-tenant read-only (compliance review)'\n    composite: false\n</code></pre> <p>Permission Matrix:</p> Resource OrgAdmin ISSO DevSecOps Developer Auditor Manage Users \u2705 \u274c \u274c \u274c \u274c Manage Projects \u2705 \u2705 \u2705 \u274c \u274c View Evidence \u2705 \u2705 \u2705 \u2705 \u2705 (all tenants) Triage CVEs \u2705 \u2705 \u2705 \u274c \u274c Manage Policies \u2705 \u2705 \u2705 \u274c \u274c Export POA&amp;M \u2705 \u2705 \u274c \u274c \u2705 (all tenants) Deploy to Prod \u2705 \u2705 \u2705 \u274c \u274c View Audit Logs \u2705 \u2705 \u274c \u274c \u2705 (all tenants)"
    },
    {
      "location": "adr/004-keycloak-rbac/#3-group-based-role-assignment",
      "title": "3. Group-Based Role Assignment",
      "text": "<p>Use Keycloak Groups to organize users by tenant:</p> <pre><code>/aegis\n  /tenants\n    /acme-corp\n      - members (aegis-developer)\n      - admins (aegis-org-admin)\n      - security (aegis-isso)\n      - engineers (aegis-devsecops)\n    /dod-agency-x\n      - members (aegis-developer)\n      - admins (aegis-org-admin)\n      - security (aegis-isso)\n  /auditors\n    - compliance-team (aegis-auditor)\n</code></pre> <p>Group Attributes:</p> <pre><code>{\n  \"name\": \"acme-corp-admins\",\n  \"path\": \"/aegis/tenants/acme-corp/admins\",\n  \"attributes\": {\n    \"tenantId\": [\"550e8400-e29b-41d4-a716-446655440000\"],\n    \"tenantSlug\": [\"acme-corp\"]\n  },\n  \"realmRoles\": [\"aegis-org-admin\"]\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#4-jwt-token-claims",
      "title": "4. JWT Token Claims",
      "text": "<p>Keycloak JWT includes custom claims for Aegis:</p> <pre><code>{\n  \"sub\": \"f:12345678-1234-1234-1234-123456789012:user@acme-corp.com\",\n  \"email\": \"user@acme-corp.com\",\n  \"name\": \"John Doe\",\n  \"preferred_username\": \"jdoe\",\n  \"email_verified\": true,\n\n  \"realm_access\": {\n    \"roles\": [\"aegis-org-admin\", \"offline_access\"]\n  },\n\n  \"resource_access\": {\n    \"aegis\": {\n      \"roles\": [\"org-admin\"]\n    }\n  },\n\n  \"aegis\": {\n    \"tenantId\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"tenantSlug\": \"acme-corp\",\n    \"role\": \"ORG_ADMIN\"\n  },\n\n  \"iat\": 1702306800,\n  \"exp\": 1702307100,\n  \"iss\": \"https://login.dso.mil/realms/baby-yoda\"\n}\n</code></pre> <p>Custom Claim Mapper (Keycloak configuration):</p> <pre><code>// Protocol Mapper: Tenant ID\nconst group = user\n  .getGroups()\n  .find((g) =&gt; g.path.startsWith('/aegis/tenants/'));\nif (group) {\n  token.setOtherClaims('aegis', {\n    tenantId: group.attributes.tenantId[0],\n    tenantSlug: group.attributes.tenantSlug[0],\n    role: mapKeycloakRoleToAegisRole(user.realmRoles),\n  });\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#5-backend-jwt-verification-nodejs",
      "title": "5. Backend JWT Verification (Node.js)",
      "text": "<pre><code>import { expressjwt } from 'express-jwt';\nimport jwksRsa from 'jwks-rsa';\n\n// JWT verification middleware\nexport const requireAuth = expressjwt({\n  secret: jwksRsa.expressJwtSecret({\n    cache: true,\n    rateLimit: true,\n    jwksRequestsPerMinute: 5,\n    jwksUri:\n      'https://login.dso.mil/realms/baby-yoda/protocol/openid-connect/certs',\n  }),\n\n  audience: 'aegis',\n  issuer: 'https://login.dso.mil/realms/baby-yoda',\n  algorithms: ['RS256'],\n\n  getToken: (req) =&gt; {\n    const authHeader = req.headers.authorization;\n    if (authHeader &amp;&amp; authHeader.startsWith('Bearer ')) {\n      return authHeader.substring(7);\n    }\n    return null;\n  },\n});\n\n// Extract Aegis-specific claims\nexport function getAegisContext(req: Request): AegisContext {\n  const token = req.auth as JWTPayload;\n\n  return {\n    userId: token.sub,\n    email: token.email,\n    name: token.name,\n    tenantId: token.aegis?.tenantId,\n    tenantSlug: token.aegis?.tenantSlug,\n    role: token.aegis?.role as UserRole,\n    isAuditor: token.realm_access?.roles?.includes('aegis-auditor') ?? false,\n  };\n}\n\n// RBAC decorator for GraphQL resolvers\nexport function Authorized(roles: UserRole[]) {\n  return (target: any, propertyKey: string, descriptor: PropertyDescriptor) =&gt; {\n    const originalMethod = descriptor.value;\n\n    descriptor.value = function (...args: any[]) {\n      const context = args[1]; // GraphQL context\n      const userRole = context.aegis.role;\n\n      if (!roles.includes(userRole)) {\n        throw new UnauthorizedException(\n          `Role '${userRole}' not authorized to access '${propertyKey}'`\n        );\n      }\n\n      return originalMethod.apply(this, args);\n    };\n\n    return descriptor;\n  };\n}\n</code></pre> <p>Usage in GraphQL Resolver:</p> <pre><code>@Resolver()\nexport class ProjectResolver {\n  @Query(() =&gt; [Project])\n  @Authorized([UserRole.ORG_ADMIN, UserRole.ISSO, UserRole.DEVSECOPS])\n  async projects(@Ctx() context: AegisContext): Promise&lt;Project[]&gt; {\n    return await this.projectService.findByTenant(context.tenantId);\n  }\n\n  @Mutation(() =&gt; Project)\n  @Authorized([UserRole.ORG_ADMIN])\n  async createProject(\n    @Arg('input') input: CreateProjectInput,\n    @Ctx() context: AegisContext\n  ): Promise&lt;Project&gt; {\n    return await this.projectService.create(input, context.tenantId);\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#6-frontend-oidc-integration-react",
      "title": "6. Frontend OIDC Integration (React)",
      "text": "<pre><code>import { AuthProvider, useAuth } from 'react-oidc-context';\n\nconst oidcConfig = {\n  authority: 'https://login.dso.mil/realms/baby-yoda',\n  client_id: 'aegis',\n  client_secret: process.env.REACT_APP_KEYCLOAK_CLIENT_SECRET,\n  redirect_uri: `${window.location.origin}/callback`,\n  post_logout_redirect_uri: window.location.origin,\n  scope: 'openid profile email',\n  response_type: 'code',\n\n  // PKCE for additional security\n  code_challenge_method: 'S256',\n};\n\nfunction App() {\n  return (\n    &lt;AuthProvider {...oidcConfig}&gt;\n      &lt;AegisApp /&gt;\n    &lt;/AuthProvider&gt;\n  );\n}\n\nfunction AegisApp() {\n  const auth = useAuth();\n\n  if (auth.isLoading) {\n    return &lt;LoadingSpinner /&gt;;\n  }\n\n  if (!auth.isAuthenticated) {\n    return &lt;LoginPage onLogin={() =&gt; auth.signinRedirect()} /&gt;;\n  }\n\n  return (\n    &lt;ApolloProvider client={createApolloClient(auth.user?.access_token)}&gt;\n      &lt;Router&gt;\n        &lt;Dashboard /&gt;\n      &lt;/Router&gt;\n    &lt;/ApolloProvider&gt;\n  );\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#7-audit-logging-nist-800-53-au-2",
      "title": "7. Audit Logging (NIST 800-53 AU-2)",
      "text": "<p>Log all authentication events:</p> <pre><code>export async function logAuthEvent(event: AuthEvent): Promise&lt;void&gt; {\n  await db.auditLog.create({\n    data: {\n      eventType: event.type, // 'LOGIN' | 'LOGOUT' | 'TOKEN_REFRESH' | 'PERMISSION_DENIED'\n      userId: event.userId,\n      tenantId: event.tenantId,\n      ipAddress: event.ipAddress,\n      userAgent: event.userAgent,\n      success: event.success,\n      errorMessage: event.error,\n      metadata: {\n        requestedResource: event.resource,\n        requestedAction: event.action,\n      },\n      timestamp: new Date(),\n    },\n  });\n}\n</code></pre>"
    },
    {
      "location": "adr/004-keycloak-rbac/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/004-keycloak-rbac/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Enterprise SSO: Users authenticated once for all Platform One apps \u2705 MFA Support: Keycloak supports TOTP, SMS, CAC/PIV cards \u2705 Compliance: Meets NIST 800-53 IA-2, AC-2, AC-3 requirements \u2705 Centralized Management: ISSOs manage users in Keycloak console \u2705 Battle-tested: Keycloak used across DoD Platform One ecosystem \u2705 Flexible RBAC: Easy to add new roles without code changes</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#negative",
      "title": "Negative",
      "text": "<p>\u274c External Dependency: Aegis depends on Keycloak availability \u274c Configuration Complexity: Initial Keycloak setup requires expertise \u274c Token Refresh: Frontend must handle token expiration (5-minute lifetime) \u274c Network Latency: JWT verification adds 10-50ms per request</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Migration Path: Can migrate to alternative OIDC provider if needed \u2696\ufe0f Local Development: Requires running Keycloak locally or using shared dev instance</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/004-keycloak-rbac/#alternative-1-custom-auth-system-usernamepassword-jwt",
      "title": "Alternative 1: Custom auth system (username/password + JWT)",
      "text": "<p>Rejected: Security risk (rolling own crypto). No MFA. Does not meet NIST 800-53 requirements.</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#alternative-2-auth0-or-okta-commercial-saas",
      "title": "Alternative 2: Auth0 or Okta (commercial SaaS)",
      "text": "<p>Rejected: Not FedRAMP authorized. Vendor lock-in. Data residency concerns for government cloud.</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#alternative-3-aws-cognito-or-azure-ad-b2c",
      "title": "Alternative 3: AWS Cognito or Azure AD B2C",
      "text": "<p>Rejected: Vendor lock-in (cloud-specific). Does not integrate with Platform One ecosystem.</p>"
    },
    {
      "location": "adr/004-keycloak-rbac/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>M3 implementation (Weeks 12-16)</li> <li>Keycloak client registration via Platform One Party Bus</li> <li>Test with local Keycloak instance in development</li> <li>Production: Platform One managed Keycloak</li> <li>Session timeout: 30 minutes idle, 8 hours maximum</li> </ul>"
    },
    {
      "location": "adr/004-keycloak-rbac/#references",
      "title": "References",
      "text": "<ul> <li>Platform One Keycloak Docs</li> <li>NIST 800-53 Rev 5: IA-2 (Identification and Authentication)</li> <li>OpenID Connect Specification</li> <li>RFC 7519: JSON Web Token (JWT)</li> </ul>"
    },
    {
      "location": "adr/005-chainguard-containers/",
      "title": "ADR-005: Chainguard Zero-CVE Container Strategy",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team, Security Team</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#context",
      "title": "Context",
      "text": "<p>Traditional container base images (Ubuntu, Alpine, Debian) frequently contain dozens to hundreds of CVEs, creating POA&amp;M burden and compliance risk. Aegis must demonstrate a proactive security posture to achieve FedRAMP ATO.</p> <p>Problem Statement:</p> <ul> <li><code>ubuntu:22.04</code> typically has 50-100 CVEs</li> <li><code>node:18</code> has 100-200 CVEs (includes OS + Node.js vulnerabilities)</li> <li><code>nginx:latest</code> has 30-60 CVEs</li> <li>Manual patching of base images is time-consuming and error-prone</li> </ul> <p>FedRAMP Requirement:</p> <ul> <li>NIST 800-53 SI-2: Flaw Remediation (30-day SLA for critical CVEs)</li> <li>Continuous monitoring of container images</li> <li>Evidence of vulnerability management process</li> </ul>"
    },
    {
      "location": "adr/005-chainguard-containers/#decision",
      "title": "Decision",
      "text": "<p>We will use Chainguard Images as the primary base images for all Aegis platform containers and recommend them for user workloads:</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#1-chainguard-image-catalog",
      "title": "1. Chainguard Image Catalog",
      "text": "<p>What are Chainguard Images?</p> <ul> <li>Minimal, hardened container images built on <code>wolfi</code> (Chainguard's Linux distribution)</li> <li>Zero CVEs at time of publication (patched within hours of disclosure)</li> <li>Cryptographically signed with cosign</li> <li>SBOM included with every image</li> <li>Rootless by default (non-root user <code>65532</code>)</li> <li>No shell, no package manager (attack surface minimization)</li> </ul> <p>Aegis Platform Images:</p> <pre><code>services:\n  api:\n    base_image: cgr.dev/chainguard/node:latest\n    # Zero CVEs, includes Node.js 18+ runtime only\n\n  workers:\n    base_image: cgr.dev/chainguard/node:latest\n\n  web:\n    base_image: cgr.dev/chainguard/nginx:latest\n    # Zero CVEs, nginx binary only, no shell\n\n  postgres:\n    base_image: cgr.dev/chainguard/postgres:latest\n    # Zero CVEs, PostgreSQL 15+\n\n  redis:\n    base_image: cgr.dev/chainguard/redis:latest\n</code></pre>"
    },
    {
      "location": "adr/005-chainguard-containers/#2-dockerfile-migration",
      "title": "2. Dockerfile Migration",
      "text": "<p>Before (Traditional Base Image):</p> <pre><code>FROM node:18\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nEXPOSE 4000\nCMD [\"node\", \"dist/index.js\"]\n\n# Result: 150+ CVEs\n</code></pre> <p>After (Chainguard Image):</p> <pre><code># Multi-stage build\nFROM cgr.dev/chainguard/node:latest-dev AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nRUN npm run build\n\n# Production image\nFROM cgr.dev/chainguard/node:latest\nWORKDIR /app\nCOPY --from=builder /app/dist ./dist\nCOPY --from=builder /app/node_modules ./node_modules\nCOPY package.json ./\n\n# Chainguard images use non-root user 65532 by default\nUSER 65532\nEXPOSE 4000\nCMD [\"node\", \"dist/index.js\"]\n\n# Result: 0 CVEs\n</code></pre> <p>Key Differences:</p> <ul> <li><code>cgr.dev/chainguard/node:latest-dev</code> for build stage (includes npm, yarn)</li> <li><code>cgr.dev/chainguard/node:latest</code> for runtime (Node.js binary only, no npm)</li> <li>No shell (<code>/bin/sh</code> not present)</li> <li>No package manager (apk, apt not available)</li> <li>Non-root user enforced</li> </ul>"
    },
    {
      "location": "adr/005-chainguard-containers/#3-chainguard-image-selection-guide",
      "title": "3. Chainguard Image Selection Guide",
      "text": "Use Case Chainguard Image Traditional Equivalent Node.js API <code>cgr.dev/chainguard/node:latest</code> <code>node:18-alpine</code> Python API <code>cgr.dev/chainguard/python:latest</code> <code>python:3.11-slim</code> Static web server <code>cgr.dev/chainguard/nginx:latest</code> <code>nginx:alpine</code> PostgreSQL <code>cgr.dev/chainguard/postgres:latest</code> <code>postgres:15</code> Redis <code>cgr.dev/chainguard/redis:latest</code> <code>redis:7-alpine</code> Go binary <code>cgr.dev/chainguard/static:latest</code> <code>gcr.io/distroless/static</code>"
    },
    {
      "location": "adr/005-chainguard-containers/#4-image-verification-cosign",
      "title": "4. Image Verification (cosign)",
      "text": "<p>All Chainguard images are signed with cosign. Verify before use:</p> <pre><code># Verify signature\ncosign verify \\\n  --certificate-identity=https://github.com/chainguard-images/images/.github/workflows/release.yaml@refs/heads/main \\\n  --certificate-oidc-issuer=https://token.actions.githubusercontent.com \\\n  cgr.dev/chainguard/node:latest\n\n# Verify attestation (SBOM)\ncosign verify-attestation \\\n  --type spdx \\\n  --certificate-identity=https://github.com/chainguard-images/images/.github/workflows/release.yaml@refs/heads/main \\\n  --certificate-oidc-issuer=https://token.actions.githubusercontent.com \\\n  cgr.dev/chainguard/node:latest | jq '.payload | @base64d | fromjson'\n</code></pre>"
    },
    {
      "location": "adr/005-chainguard-containers/#5-gatekeeper-policy-enforcement",
      "title": "5. Gatekeeper Policy Enforcement",
      "text": "<p>Enforce Chainguard images (or other approved registries) via Gatekeeper:</p> <pre><code>apiVersion: constraints.gatekeeper.sh/v1beta1\nkind: K8sAllowedRepos\nmetadata:\n  name: require-chainguard-or-harbor\nspec:\n  match:\n    kinds:\n      - apiGroups: ['']\n        kinds: ['Pod']\n    namespaces: ['aegis-tenant-*']\n  parameters:\n    repos:\n      - 'cgr.dev/chainguard' # Chainguard registry\n      - 'harbor.aegis.dso.mil' # Internal Harbor registry\n      - 'registry1.dso.mil/ironbank' # Platform One Iron Bank\n</code></pre>"
    },
    {
      "location": "adr/005-chainguard-containers/#6-cicd-integration",
      "title": "6. CI/CD Integration",
      "text": "<p>Update GitHub Actions workflow to use Chainguard images:</p> <pre><code>name: Build with Chainguard Base\n\non: [push]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v3\n\n      - name: Build with Chainguard base\n        uses: docker/build-push-action@v5\n        with:\n          context: .\n          file: ./Dockerfile\n          push: false\n          tags: aegis/api:${{ github.sha }}\n          cache-from: type=gha\n          cache-to: type=gha,mode=max\n\n      - name: Scan for vulnerabilities (should be zero)\n        run: |\n          grype aegis/api:${{ github.sha }} --fail-on critical\n\n      - name: Verify zero CVEs\n        run: |\n          CVE_COUNT=$(grype aegis/api:${{ github.sha }} -o json | jq '.matches | length')\n          if [ \"$CVE_COUNT\" -gt 0 ]; then\n            echo \"\u274c Found $CVE_COUNT CVEs (expected 0 with Chainguard base)\"\n            exit 1\n          fi\n          echo \"\u2705 Zero CVEs confirmed\"\n</code></pre>"
    },
    {
      "location": "adr/005-chainguard-containers/#7-update-strategy",
      "title": "7. Update Strategy",
      "text": "<p>Chainguard images are updated continuously (multiple times per week):</p> <pre><code># Renovate Bot configuration (.github/renovate.json)\n{\n  'extends': ['config:base'],\n  'packageRules':\n    [\n      {\n        'matchDatasources': ['docker'],\n        'matchPackagePatterns': ['^cgr.dev/chainguard/'],\n        'schedule': ['every weekend'],\n        'automerge': true,\n        'automergeType': 'pr',\n        'platformAutomerge': true,\n      },\n    ],\n}\n</code></pre> <p>Benefits:</p> <ul> <li>Automated PRs for Chainguard image updates</li> <li>Auto-merge if CI passes (safe because Chainguard maintains zero CVEs)</li> <li>Weekly update cadence balances freshness with stability</li> </ul>"
    },
    {
      "location": "adr/005-chainguard-containers/#8-cost-considerations",
      "title": "8. Cost Considerations",
      "text": "<p>Chainguard Pricing (as of 2024):</p> <ul> <li>Free tier: Public images (cgr.dev/chainguard/*)</li> <li>Enterprise tier: $1000/month for private image builds and support</li> </ul> <p>Recommendation:</p> <ul> <li>Use free tier for Aegis platform (sufficient for most use cases)</li> <li>Upgrade to Enterprise if custom base images needed</li> </ul> <p>ROI Calculation:</p> <pre><code>Manual CVE remediation cost:\n- 50 CVEs per image \u00d7 3 images = 150 CVEs\n- 30 minutes per CVE triage = 75 hours\n- $150/hour security engineer rate = $11,250\n- Quarterly patching cycle = $45,000/year\n\nChainguard Enterprise cost: $12,000/year\n\nSavings: $33,000/year + reduced compliance risk\n</code></pre>"
    },
    {
      "location": "adr/005-chainguard-containers/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/005-chainguard-containers/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Zero CVEs: Eliminates 90%+ of POA&amp;M items from base image vulnerabilities \u2705 Faster ATO: Reduced attack surface accelerates FedRAMP authorization \u2705 Compliance: Meets NIST 800-53 SI-2 (Flaw Remediation) proactively \u2705 Minimal attack surface: No shell, no package manager reduces exploit potential \u2705 Cryptographic verification: cosign signatures provide supply chain security \u2705 Included SBOM: SPDX SBOM embedded in every image</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#negative",
      "title": "Negative",
      "text": "<p>\u274c Learning curve: Teams must adapt to shell-less, minimal images \u274c Debugging difficulty: No shell means no <code>docker exec</code> for troubleshooting \u274c Dependency constraints: Cannot install packages at runtime (must use multi-stage builds) \u274c Enterprise cost: $1000/month if custom images needed</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Slightly larger build images: Multi-stage builds increase build time by ~30 seconds \u2696\ufe0f Registry dependency: Requires access to cgr.dev (mitigated by Harbor caching)</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/005-chainguard-containers/#alternative-1-google-distroless",
      "title": "Alternative 1: Google Distroless",
      "text": "<p>Rejected: Good minimal images, but still contains 5-10 CVEs. Not as frequently updated as Chainguard.</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#alternative-2-alpine-linux",
      "title": "Alternative 2: Alpine Linux",
      "text": "<p>Rejected: Typically 10-30 CVEs. <code>apk</code> package manager increases attack surface.</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#alternative-3-ubuntu-lts-manual-patching",
      "title": "Alternative 3: Ubuntu LTS (manual patching)",
      "text": "<p>Rejected: 50-100 CVEs, requires dedicated team for patching, does not meet FedRAMP 30-day SLA.</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#alternative-4-platform-one-iron-bank",
      "title": "Alternative 4: Platform One Iron Bank",
      "text": "<p>Accepted for alternative: Can be used alongside Chainguard. Iron Bank images are hardened and DISA STIG-compliant, but may contain 5-20 CVEs. Use for images not available in Chainguard catalog.</p>"
    },
    {
      "location": "adr/005-chainguard-containers/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>Sprint 0: Use Chainguard images for all Aegis platform services</li> <li>M5: Document Chainguard usage in Big Bang integration guide</li> <li>M7: Automated remediation engine generates Chainguard-based Dockerfiles</li> </ul>"
    },
    {
      "location": "adr/005-chainguard-containers/#references",
      "title": "References",
      "text": "<ul> <li>Chainguard Images Catalog</li> <li>Chainguard Documentation</li> <li>Platform One Iron Bank</li> <li>NIST 800-53 SI-2: Flaw Remediation</li> </ul>"
    },
    {
      "location": "adr/006-code-remediation/",
      "title": "ADR-006: Automated Code Remediation Architecture",
      "text": "<p>Status: Accepted Date: 2024-12-11 Deciders: Platform Architecture Team, M7 Working Group</p>"
    },
    {
      "location": "adr/006-code-remediation/#context",
      "title": "Context",
      "text": "<p>Government agencies and contractors often have legacy codebases with 50-200 CVEs per application. Manual remediation is time-consuming (weeks to months), error-prone, and blocks FedRAMP ATO approval.</p> <p>Problem Statement:</p> <ul> <li>Manual dependency upgrades take 2-4 hours per application</li> <li>Breaking changes in major version upgrades cause production incidents</li> <li>Dockerfile hardening requires deep security expertise</li> <li>No automated way to generate ATO-compliant code</li> </ul> <p>M7 Goal: Enable \"one-click remediation\" where users bring vulnerable code and Aegis generates:</p> <ul> <li>Hardened Dockerfile (Chainguard base images)</li> <li>Upgraded dependencies (zero-CVE versions)</li> <li>Rebuilt application with passing tests</li> <li>Git pull request with changes</li> <li>Before/After SBOM comparison</li> </ul>"
    },
    {
      "location": "adr/006-code-remediation/#decision",
      "title": "Decision",
      "text": "<p>We will implement AI-assisted automated code remediation with the following architecture:</p>"
    },
    {
      "location": "adr/006-code-remediation/#1-remediation-engine-components",
      "title": "1. Remediation Engine Components",
      "text": "<pre><code>User Repository (GitHub/GitLab)\n    \u2193\nAegis Remediation API\n    \u251c\u2500&gt; Language Detector (Node.js, Python, Java, Go, Ruby)\n    \u251c\u2500&gt; Dependency Parser (package.json, requirements.txt, pom.xml, etc.)\n    \u251c\u2500&gt; Vulnerability Mapper (CVE \u2192 Fixed Version resolver)\n    \u251c\u2500&gt; Dockerfile Generator (Chainguard base image selection)\n    \u251c\u2500&gt; Dependency Upgrader (smart version bumping with semver analysis)\n    \u251c\u2500&gt; Build Validator (ephemeral container build + test execution)\n    \u2514\u2500&gt; PR Generator (git commit + push + PR creation)\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#2-language-support-matrix",
      "title": "2. Language Support Matrix",
      "text": "Language Dependency Files Package Manager SBOM Tool Node.js package.json, package-lock.json npm, yarn, pnpm Syft Python requirements.txt, poetry.lock, Pipfile pip, poetry, pipenv Syft Java pom.xml, build.gradle Maven, Gradle Syft Go go.mod, go.sum go modules Syft Ruby Gemfile, Gemfile.lock bundler Syft"
    },
    {
      "location": "adr/006-code-remediation/#3-dependency-upgrade-logic",
      "title": "3. Dependency Upgrade Logic",
      "text": "<p>Smart Version Resolution:</p> <pre><code>interface DependencyUpgrade {\n  packageName: string;\n  currentVersion: string;\n  vulnerabilities: Vulnerability[];\n  fixedVersion: string; // Minimum version with zero CVEs\n  latestVersion: string; // Latest stable version\n  breakingChanges: boolean; // Detected via semver major version bump\n  confidence: 'high' | 'medium' | 'low'; // Upgrade safety score\n}\n\nasync function resolveDependencyUpgrades(\n  dependencies: Dependency[],\n  vulnerabilities: Vulnerability[]\n): Promise&lt;DependencyUpgrade[]&gt; {\n  const upgrades: DependencyUpgrade[] = [];\n\n  for (const dep of dependencies) {\n    const depVulns = vulnerabilities.filter(\n      (v) =&gt; v.packageName === dep.name &amp;&amp; v.packageVersion === dep.version\n    );\n\n    if (depVulns.length === 0) {\n      continue; // No vulnerabilities, skip\n    }\n\n    // Find minimum version that fixes all CVEs\n    const fixedVersion = await findMinimumFixedVersion(dep.name, depVulns);\n\n    // Check for breaking changes\n    const breakingChanges = isBreakingChange(dep.version, fixedVersion);\n\n    // Calculate confidence score\n    const confidence = calculateUpgradeConfidence(\n      dep,\n      fixedVersion,\n      breakingChanges\n    );\n\n    upgrades.push({\n      packageName: dep.name,\n      currentVersion: dep.version,\n      vulnerabilities: depVulns,\n      fixedVersion,\n      latestVersion: await getLatestVersion(dep.name),\n      breakingChanges,\n      confidence,\n    });\n  }\n\n  return upgrades;\n}\n\nfunction calculateUpgradeConfidence(\n  dep: Dependency,\n  fixedVersion: string,\n  breakingChanges: boolean\n): 'high' | 'medium' | 'low' {\n  // High confidence: Patch or minor version bump\n  if (!breakingChanges &amp;&amp; semver.diff(dep.version, fixedVersion) !== 'major') {\n    return 'high';\n  }\n\n  // Medium confidence: Major version but within same major.x\n  if (\n    breakingChanges &amp;&amp;\n    semver.major(dep.version) === semver.major(fixedVersion)\n  ) {\n    return 'medium';\n  }\n\n  // Low confidence: Multiple major versions jump\n  return 'low';\n}\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#4-dockerfile-generation",
      "title": "4. Dockerfile Generation",
      "text": "<p>Template-Based Generation:</p> <pre><code>interface DockerfileTemplate {\n  language: string;\n  baseImage: string;\n  buildCommands: string[];\n  runtimeCommands: string[];\n}\n\nconst templates: Record&lt;string, DockerfileTemplate&gt; = {\n  nodejs: {\n    language: 'Node.js',\n    baseImage: 'cgr.dev/chainguard/node:latest',\n    buildCommands: [\n      'FROM cgr.dev/chainguard/node:latest-dev AS builder',\n      'WORKDIR /app',\n      'COPY package*.json ./',\n      'RUN npm ci --only=production',\n      'COPY . .',\n      'RUN npm run build',\n    ],\n    runtimeCommands: [\n      'FROM cgr.dev/chainguard/node:latest',\n      'WORKDIR /app',\n      'COPY --from=builder /app/dist ./dist',\n      'COPY --from=builder /app/node_modules ./node_modules',\n      'COPY package.json ./',\n      'USER 65532',\n      'EXPOSE 3000',\n      'CMD [\"node\", \"dist/index.js\"]',\n    ],\n  },\n  python: {\n    language: 'Python',\n    baseImage: 'cgr.dev/chainguard/python:latest',\n    buildCommands: [\n      'FROM cgr.dev/chainguard/python:latest-dev AS builder',\n      'WORKDIR /app',\n      'COPY requirements.txt .',\n      'RUN pip install --user --no-cache-dir -r requirements.txt',\n      'COPY . .',\n    ],\n    runtimeCommands: [\n      'FROM cgr.dev/chainguard/python:latest',\n      'WORKDIR /app',\n      'COPY --from=builder /home/nonroot/.local /home/nonroot/.local',\n      'COPY --from=builder /app .',\n      'ENV PATH=/home/nonroot/.local/bin:$PATH',\n      'USER 65532',\n      'EXPOSE 8000',\n      'CMD [\"python\", \"app.py\"]',\n    ],\n  },\n};\n\nfunction generateDockerfile(language: string, config: AppConfig): string {\n  const template = templates[language];\n  if (!template) {\n    throw new Error(`Unsupported language: ${language}`);\n  }\n\n  const dockerfile = [\n    `# Generated by Aegis Automated Remediation`,\n    `# Base image: ${template.baseImage} (Zero CVEs)`,\n    ``,\n    ...template.buildCommands,\n    ``,\n    ...template.runtimeCommands,\n  ].join('\\n');\n\n  return dockerfile;\n}\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#5-build-validation",
      "title": "5. Build Validation",
      "text": "<p>Ephemeral Build Environment:</p> <pre><code>import Docker from 'dockerode';\n\ninterface BuildValidationResult {\n  success: boolean;\n  buildLogs: string;\n  testResults?: TestResult;\n  imageDigest?: string;\n  errorMessage?: string;\n}\n\nasync function validateBuild(\n  repository: GitRepository,\n  dockerfile: string,\n  upgradedDependencies: DependencyUpgrade[]\n): Promise&lt;BuildValidationResult&gt; {\n  const docker = new Docker();\n\n  try {\n    // 1. Create ephemeral build environment\n    const tarStream = createTarball(\n      repository,\n      dockerfile,\n      upgradedDependencies\n    );\n\n    // 2. Build image\n    const buildStream = await docker.buildImage(tarStream, {\n      t: `aegis-remediation-${repository.name}:${Date.now()}`,\n      pull: false,\n      buildargs: { BUILDKIT: '1' },\n    });\n\n    const buildLogs = await collectBuildLogs(buildStream);\n\n    // 3. Run tests (if test command exists)\n    const testResults = await runTests(docker, repository);\n\n    // 4. Generate SBOM and scan\n    const sbom = await generateSBOM(imageDigest);\n    const scanResults = await scanVulnerabilities(imageDigest);\n\n    // 5. Validate zero CVEs\n    if (scanResults.criticalCount &gt; 0 || scanResults.highCount &gt; 0) {\n      return {\n        success: false,\n        buildLogs,\n        errorMessage: `Build succeeded but found ${scanResults.criticalCount} critical and ${scanResults.highCount} high CVEs`,\n      };\n    }\n\n    return {\n      success: true,\n      buildLogs,\n      testResults,\n      imageDigest,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      buildLogs: error.message,\n      errorMessage: `Build failed: ${error.message}`,\n    };\n  } finally {\n    // Cleanup: Remove ephemeral containers and images\n    await cleanupBuildArtifacts(docker);\n  }\n}\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#6-pull-request-generation",
      "title": "6. Pull Request Generation",
      "text": "<p>Git Integration:</p> <pre><code>import { Octokit } from '@octokit/rest';\n\nasync function createRemediationPR(\n  repository: GitRepository,\n  changes: RemediationChanges,\n  validationResult: BuildValidationResult\n): Promise&lt;PullRequest&gt; {\n  const octokit = new Octokit({ auth: process.env.GITHUB_TOKEN });\n\n  // 1. Create feature branch\n  const branchName = `aegis/remediation-${Date.now()}`;\n  await octokit.git.createRef({\n    owner: repository.owner,\n    repo: repository.name,\n    ref: `refs/heads/${branchName}`,\n    sha: repository.headSha,\n  });\n\n  // 2. Commit changes\n  const files = [\n    { path: 'Dockerfile', content: changes.dockerfile },\n    { path: 'package.json', content: changes.packageJson },\n    { path: 'package-lock.json', content: changes.packageLockJson },\n  ];\n\n  for (const file of files) {\n    await octokit.repos.createOrUpdateFileContents({\n      owner: repository.owner,\n      repo: repository.name,\n      path: file.path,\n      message: `chore: aegis automated remediation - ${file.path}`,\n      content: Buffer.from(file.content).toString('base64'),\n      branch: branchName,\n    });\n  }\n\n  // 3. Create PR\n  const prBody = generatePRDescription(changes, validationResult);\n\n  const pr = await octokit.pulls.create({\n    owner: repository.owner,\n    repo: repository.name,\n    title: '\ud83d\udee1\ufe0f Aegis: Automated Security Remediation',\n    head: branchName,\n    base: repository.defaultBranch,\n    body: prBody,\n  });\n\n  return pr.data;\n}\n\nfunction generatePRDescription(\n  changes: RemediationChanges,\n  validation: BuildValidationResult\n): string {\n  return `\n## \ud83d\udee1\ufe0f Aegis Automated Security Remediation\n\nThis PR was automatically generated by Aegis to remediate security vulnerabilities in your application.\n\n### Summary\n- **CVEs Fixed**: ${changes.vulnerabilities.length}\n- **Dependencies Upgraded**: ${changes.upgrades.length}\n- **Build Status**: ${validation.success ? '\u2705 Passed' : '\u274c Failed'}\n- **Test Status**: ${validation.testResults?.success ? '\u2705 All tests passed' : '\u26a0\ufe0f See details'}\n\n### Vulnerability Remediation\n| CVE ID | Package | Current Version | Fixed Version | Severity |\n|--------|---------|-----------------|---------------|----------|\n${changes.vulnerabilities\n  .map(\n    (v) =&gt;\n      `| ${v.cveId} | ${v.packageName} | ${v.currentVersion} | ${v.fixedVersion} | ${v.severity} |`\n  )\n  .join('\\n')}\n\n### Dependency Upgrades\n${changes.upgrades\n  .map(\n    (u) =&gt;\n      `- **${u.packageName}**: ${u.currentVersion} \u2192 ${u.fixedVersion} ${u.breakingChanges ? '\u26a0\ufe0f Major version' : '\u2705 Safe'}`\n  )\n  .join('\\n')}\n\n### Dockerfile Changes\n- \u2705 Switched to Chainguard base image (\\`${changes.chainguardImage}\\`)\n- \u2705 Multi-stage build for minimal runtime image\n- \u2705 Non-root user (UID 65532)\n- \u2705 No shell or package manager in runtime\n\n### SBOM Comparison\n**Before**: ${changes.sbomBefore.packageCount} packages, ${changes.sbomBefore.cveCount} CVEs\n**After**: ${changes.sbomAfter.packageCount} packages, ${changes.sbomAfter.cveCount} CVEs\n\n**CVE Reduction**: ${changes.sbomBefore.cveCount - changes.sbomAfter.cveCount} vulnerabilities eliminated \u2705\n\n### Next Steps\n1. Review the changes in this PR\n2. Verify tests pass (CI pipeline will run automatically)\n3. Merge when ready to deploy hardened application\n\n---\n*Generated by [Aegis DevSecOps Platform](https://aegis.dso.mil) - FedRAMP ATO Automation*\n`;\n}\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#7-user-workflow-ui",
      "title": "7. User Workflow (UI)",
      "text": "<pre><code>// React component\nfunction RemediationDashboard() {\n  const [repositories, setRepositories] = useState&lt;Repository[]&gt;([]);\n\n  const handleAutomatedRemediation = async (repo: Repository) =&gt; {\n    // 1. Trigger remediation\n    const result = await api.post('/api/v1/remediation/analyze', {\n      repositoryUrl: repo.url,\n      branch: repo.defaultBranch,\n    });\n\n    // 2. Display proposed changes\n    setProposedChanges(result.data);\n\n    // 3. User reviews and approves\n    // 4. API creates PR\n  };\n\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Automated Code Remediation&lt;/h2&gt;\n      {repositories.map(repo =&gt; (\n        &lt;RepositoryCard\n          key={repo.id}\n          repository={repo}\n          cveCount={repo.cveCount}\n          onRemediate={() =&gt; handleAutomatedRemediation(repo)}\n        /&gt;\n      ))}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"
    },
    {
      "location": "adr/006-code-remediation/#consequences",
      "title": "Consequences",
      "text": ""
    },
    {
      "location": "adr/006-code-remediation/#positive",
      "title": "Positive",
      "text": "<p>\u2705 Time savings: Remediation time reduced from weeks to minutes \u2705 Accuracy: Eliminates human error in dependency upgrades \u2705 Safety: Build validation prevents broken deployments \u2705 Transparency: Pull request provides full visibility into changes \u2705 Scalability: Can remediate 50+ repositories per day \u2705 ATO acceleration: Automated evidence generation speeds FedRAMP approval</p>"
    },
    {
      "location": "adr/006-code-remediation/#negative",
      "title": "Negative",
      "text": "<p>\u274c False positives: May propose upgrades that break application logic \u274c Test coverage dependency: Requires existing test suite to validate changes \u274c AI model cost: LLM usage for changelog analysis adds operational cost \u274c Complexity: Sophisticated system with many failure modes \u274c Trust barrier: Users may be skeptical of automated code changes</p>"
    },
    {
      "location": "adr/006-code-remediation/#neutral",
      "title": "Neutral",
      "text": "<p>\u2696\ufe0f Human oversight: Users still review and approve PRs (not fully autonomous) \u2696\ufe0f Incremental rollout: Can start with low-confidence upgrades disabled</p>"
    },
    {
      "location": "adr/006-code-remediation/#alternatives-considered",
      "title": "Alternatives Considered",
      "text": ""
    },
    {
      "location": "adr/006-code-remediation/#alternative-1-dependabot-renovate-bot-status-quo",
      "title": "Alternative 1: Dependabot / Renovate Bot (status quo)",
      "text": "<p>Rejected: Only upgrades dependencies, does not fix Dockerfiles. No build validation. Creates 20+ PRs per repo (noisy).</p>"
    },
    {
      "location": "adr/006-code-remediation/#alternative-2-manual-remediation-by-security-team",
      "title": "Alternative 2: Manual remediation by security team",
      "text": "<p>Rejected: Does not scale. Average 2-4 weeks per application. Bottleneck for ATO.</p>"
    },
    {
      "location": "adr/006-code-remediation/#alternative-3-ai-code-generation-fully-autonomous",
      "title": "Alternative 3: AI code generation (fully autonomous)",
      "text": "<p>Rejected: Too risky without human review. Cannot guarantee correctness.</p>"
    },
    {
      "location": "adr/006-code-remediation/#implementation-notes",
      "title": "Implementation Notes",
      "text": "<ul> <li>M7 implementation (Weeks 35-42)</li> <li>Support Node.js, Python, Java, Go, Ruby (5 languages minimum)</li> <li>GitHub and GitLab integration (Bitbucket future)</li> <li>Terraform manages ephemeral build workers (Kubernetes Jobs)</li> <li>Prometheus metrics: remediation success rate, CVE reduction, build times</li> </ul>"
    },
    {
      "location": "adr/006-code-remediation/#references",
      "title": "References",
      "text": "<ul> <li>Dependabot Documentation</li> <li>Renovate Bot</li> <li>Chainguard Images</li> <li>Syft SBOM Tool</li> <li>Grype Vulnerability Scanner</li> </ul>"
    },
    {
      "location": "api-reference/authentication/",
      "title": "Authentication",
      "text": "<p>Aegis uses JWT (JSON Web Tokens) for API authentication.</p>"
    },
    {
      "location": "api-reference/authentication/#obtaining-a-token",
      "title": "Obtaining a Token",
      "text": ""
    },
    {
      "location": "api-reference/authentication/#login",
      "title": "Login",
      "text": "<pre><code>POST /api/auth/login\n</code></pre> <p>Request:</p> <pre><code>curl -X POST https://api.aegis.gov/api/auth/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\",\n    \"password\": \"your-password\"\n  }'\n</code></pre> <p>Response:</p> <pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"expiresIn\": \"24h\",\n  \"user\": {\n    \"id\": \"user-id\",\n    \"email\": \"user@example.com\",\n    \"tenantId\": \"tenant-id\",\n    \"role\": \"USER\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/authentication/#using-the-token",
      "title": "Using the Token",
      "text": "<p>Include the token in the Authorization header:</p> <pre><code>curl -X GET https://api.aegis.gov/api/projects \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n</code></pre>"
    },
    {
      "location": "api-reference/authentication/#token-structure",
      "title": "Token Structure",
      "text": "<p>JWT tokens include:</p> <pre><code>{\n  \"sub\": \"user-id\",\n  \"tenantId\": \"tenant-uuid\",\n  \"role\": \"USER\",\n  \"email\": \"user@example.com\",\n  \"iat\": 1702310000,\n  \"exp\": 1702396400\n}\n</code></pre>"
    },
    {
      "location": "api-reference/authentication/#token-expiration",
      "title": "Token Expiration",
      "text": "<p>Tokens expire after 24 hours by default. Refresh tokens before expiration:</p> <pre><code>POST /api/auth/refresh\n</code></pre> <p>Request:</p> <pre><code>curl -X POST https://api.aegis.gov/api/auth/refresh \\\n  -H \"Authorization: Bearer YOUR_TOKEN\"\n</code></pre> <p>Response:</p> <pre><code>{\n  \"token\": \"new-jwt-token\",\n  \"expiresIn\": \"24h\"\n}\n</code></pre>"
    },
    {
      "location": "api-reference/authentication/#roles",
      "title": "Roles",
      "text": "<ul> <li>OWNER: Full tenant access</li> <li>ADMIN: Manage projects and users</li> <li>USER: Upload evidence and view data</li> <li>VIEWER: Read-only access</li> </ul> <p>For multi-tenant architecture, see the Multi-Tenancy Guide.</p>"
    },
    {
      "location": "api-reference/graphql/",
      "title": "GraphQL API",
      "text": "<p>Aegis provides a comprehensive GraphQL API for flexible data querying.</p>"
    },
    {
      "location": "api-reference/graphql/#endpoint",
      "title": "Endpoint",
      "text": "<pre><code>POST https://api.aegis.gov/graphql\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#authentication",
      "title": "Authentication",
      "text": "<p>Include JWT token in the Authorization header:</p> <pre><code>curl -X POST https://api.aegis.gov/graphql \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"{ projects { id name } }\"}'\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#schema",
      "title": "Schema",
      "text": ""
    },
    {
      "location": "api-reference/graphql/#query-evidence",
      "title": "Query Evidence",
      "text": "<pre><code>query GetEvidence($id: ID!) {\n  evidence(id: $id) {\n    id\n    fileName\n    fileSize\n    status\n    uploadedAt\n    vulnerabilities {\n      id\n      cveId\n      severity\n      cvssScore\n      description\n    }\n    components {\n      id\n      name\n      version\n      purl\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#query-vulnerabilities",
      "title": "Query Vulnerabilities",
      "text": "<pre><code>query GetVulnerabilities($projectId: ID!, $severity: VulnerabilitySeverity) {\n  project(id: $projectId) {\n    vulnerabilities(severity: $severity) {\n      id\n      cveId\n      severity\n      cvssScore\n      cvssVector\n      description\n      publishedAt\n      fixedVersion\n      component {\n        name\n        version\n      }\n      poam {\n        id\n        status\n        scheduledCompletionDate\n      }\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#query-poams",
      "title": "Query POA&amp;Ms",
      "text": "<pre><code>query GetPOAMs($projectId: ID!, $status: POAMStatus) {\n  project(id: $projectId) {\n    poams(status: $status) {\n      id\n      title\n      status\n      discoveryDate\n      scheduledCompletionDate\n      actualCompletionDate\n      vulnerability {\n        cveId\n        severity\n        cvssScore\n      }\n      remediationPlan {\n        description\n        assignedTo\n      }\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#upload-evidence",
      "title": "Upload Evidence",
      "text": "<pre><code>mutation UploadEvidence($input: EvidenceInput!) {\n  createEvidence(input: $input) {\n    id\n    fileName\n    status\n    uploadedAt\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"input\": {\n    \"projectId\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"buildId\": \"234e5678-e89b-12d3-a456-426614174001\",\n    \"file\": \"base64-encoded-file-content\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#update-poam",
      "title": "Update POA&amp;M",
      "text": "<pre><code>mutation UpdatePOAM($id: ID!, $input: POAMInput!) {\n  updatePOAM(id: $id, input: $input) {\n    id\n    status\n    actualCompletionDate\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"id\": \"345e6789-e89b-12d3-a456-426614174002\",\n  \"input\": {\n    \"status\": \"COMPLETED\",\n    \"actualCompletionDate\": \"2026-01-10\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/graphql/#graphql-playground",
      "title": "GraphQL Playground",
      "text": "<p>Access the interactive GraphQL Playground at:</p> <pre><code>https://api.aegis.gov/graphql\n</code></pre> <p>For REST API endpoints, see the REST API Reference.</p>"
    },
    {
      "location": "api-reference/rest/",
      "title": "REST API",
      "text": "<p>Aegis provides a RESTful API for traditional HTTP integrations.</p>"
    },
    {
      "location": "api-reference/rest/#base-url",
      "title": "Base URL",
      "text": "<pre><code>https://api.aegis.gov/api\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#authentication",
      "title": "Authentication",
      "text": "<p>Include JWT token in the Authorization header:</p> <pre><code>Authorization: Bearer YOUR_JWT_TOKEN\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#endpoints",
      "title": "Endpoints",
      "text": ""
    },
    {
      "location": "api-reference/rest/#upload-evidence",
      "title": "Upload Evidence",
      "text": "<pre><code>POST /api/evidence\n</code></pre> <p>Upload an SBOM or scan result file.</p> <p>Request:</p> <pre><code>curl -X POST https://api.aegis.gov/api/evidence \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  -F \"file=@sbom.spdx.json\" \\\n  -F \"projectId=123e4567-e89b-12d3-a456-426614174000\" \\\n  -F \"buildId=234e5678-e89b-12d3-a456-426614174001\"\n</code></pre> <p>Response:</p> <pre><code>{\n  \"id\": \"345e6789-e89b-12d3-a456-426614174002\",\n  \"fileName\": \"sbom.spdx.json\",\n  \"fileSize\": 1024,\n  \"status\": \"UPLOADED\",\n  \"uploadedAt\": \"2025-12-16T15:30:00Z\"\n}\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#get-evidence",
      "title": "Get Evidence",
      "text": "<pre><code>GET /api/evidence/:id\n</code></pre> <p>Retrieve evidence details.</p> <p>Response:</p> <pre><code>{\n  \"id\": \"345e6789-e89b-12d3-a456-426614174002\",\n  \"fileName\": \"sbom.spdx.json\",\n  \"fileSize\": 1024,\n  \"status\": \"COMPLETED\",\n  \"uploadedAt\": \"2025-12-16T15:30:00Z\",\n  \"vulnerabilities\": {\n    \"total\": 27,\n    \"critical\": 2,\n    \"high\": 5,\n    \"medium\": 12,\n    \"low\": 8\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#list-projects",
      "title": "List Projects",
      "text": "<pre><code>GET /api/projects\n</code></pre> <p>Get all projects for the authenticated tenant.</p> <p>Response:</p> <pre><code>{\n  \"projects\": [\n    {\n      \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"name\": \"aegis-api\",\n      \"description\": \"Aegis API Service\",\n      \"createdAt\": \"2025-01-01T00:00:00Z\"\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#get-vulnerabilities",
      "title": "Get Vulnerabilities",
      "text": "<pre><code>GET /api/evidence/:id/vulnerabilities?severity=CRITICAL\n</code></pre> <p>Get vulnerabilities for evidence, optionally filtered by severity.</p> <p>Response:</p> <pre><code>{\n  \"vulnerabilities\": [\n    {\n      \"id\": \"456e7890-e89b-12d3-a456-426614174003\",\n      \"cveId\": \"CVE-2024-47076\",\n      \"severity\": \"CRITICAL\",\n      \"cvssScore\": 9.8,\n      \"description\": \"curl CURLOPT_PROTOCOLS bypass via redirect\",\n      \"component\": {\n        \"name\": \"curl\",\n        \"version\": \"7.68.0\"\n      }\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#health-check",
      "title": "Health Check",
      "text": "<pre><code>GET /health\n</code></pre> <p>Check API server health.</p> <p>Response:</p> <pre><code>{\n  \"status\": \"healthy\",\n  \"timestamp\": \"2025-12-16T15:30:00Z\",\n  \"version\": \"0.1.0\",\n  \"uptime\": 3600\n}\n</code></pre>"
    },
    {
      "location": "api-reference/rest/#error-responses",
      "title": "Error Responses",
      "text": "<p>All errors follow this format:</p> <pre><code>{\n  \"error\": {\n    \"code\": \"VALIDATION_ERROR\",\n    \"message\": \"Invalid file format\",\n    \"details\": {\n      \"field\": \"file\",\n      \"reason\": \"Must be SPDX or CycloneDX format\"\n    }\n  }\n}\n</code></pre> <p>Common error codes:</p> <ul> <li><code>VALIDATION_ERROR</code> - Invalid request parameters</li> <li><code>AUTHENTICATION_ERROR</code> - Invalid or missing token</li> <li><code>AUTHORIZATION_ERROR</code> - Insufficient permissions</li> <li><code>NOT_FOUND</code> - Resource not found</li> <li><code>INTERNAL_ERROR</code> - Server error</li> </ul> <p>For GraphQL API, see the GraphQL API Reference.</p>"
    },
    {
      "location": "api-reference/webhooks/",
      "title": "Webhooks",
      "text": "<p>Configure webhooks to receive real-time notifications for security events.</p>"
    },
    {
      "location": "api-reference/webhooks/#overview",
      "title": "Overview",
      "text": "<p>Aegis can send HTTP POST requests to your endpoints when important events occur:</p> <ul> <li>New vulnerability detected</li> <li>POA&amp;M deadline approaching</li> <li>Evidence processing completed</li> <li>Critical vulnerability discovered</li> </ul>"
    },
    {
      "location": "api-reference/webhooks/#webhook-configuration",
      "title": "Webhook Configuration",
      "text": "<p>Configure webhooks via the API:</p> <pre><code>mutation CreateWebhook($input: WebhookInput!) {\n  createWebhook(input: $input) {\n    id\n    url\n    events\n    secret\n    active\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"input\": {\n    \"url\": \"https://your-app.com/webhooks/aegis\",\n    \"events\": [\"VULNERABILITY_DETECTED\", \"POAM_OVERDUE\"],\n    \"secret\": \"your-webhook-secret\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/webhooks/#webhook-events",
      "title": "Webhook Events",
      "text": ""
    },
    {
      "location": "api-reference/webhooks/#vulnerability_detected",
      "title": "VULNERABILITY_DETECTED",
      "text": "<p>Sent when a new vulnerability is discovered:</p> <pre><code>{\n  \"event\": \"VULNERABILITY_DETECTED\",\n  \"timestamp\": \"2025-12-16T15:30:00Z\",\n  \"data\": {\n    \"vulnerabilityId\": \"456e7890-e89b-12d3-a456-426614174003\",\n    \"cveId\": \"CVE-2024-47076\",\n    \"severity\": \"CRITICAL\",\n    \"cvssScore\": 9.8,\n    \"component\": {\n      \"name\": \"curl\",\n      \"version\": \"7.68.0\"\n    },\n    \"projectId\": \"123e4567-e89b-12d3-a456-426614174000\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/webhooks/#poam_overdue",
      "title": "POAM_OVERDUE",
      "text": "<p>Sent when a POA&amp;M passes its deadline:</p> <pre><code>{\n  \"event\": \"POAM_OVERDUE\",\n  \"timestamp\": \"2025-12-16T15:30:00Z\",\n  \"data\": {\n    \"poamId\": \"567e8901-e89b-12d3-a456-426614174004\",\n    \"vulnerabilityId\": \"456e7890-e89b-12d3-a456-426614174003\",\n    \"cveId\": \"CVE-2024-47076\",\n    \"scheduledCompletionDate\": \"2026-01-15\",\n    \"daysOverdue\": 5\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/webhooks/#evidence_completed",
      "title": "EVIDENCE_COMPLETED",
      "text": "<p>Sent when evidence processing finishes:</p> <pre><code>{\n  \"event\": \"EVIDENCE_COMPLETED\",\n  \"timestamp\": \"2025-12-16T15:30:00Z\",\n  \"data\": {\n    \"evidenceId\": \"345e6789-e89b-12d3-a456-426614174002\",\n    \"fileName\": \"sbom.spdx.json\",\n    \"vulnerabilitiesFound\": 27,\n    \"criticalCount\": 2,\n    \"highCount\": 5\n  }\n}\n</code></pre>"
    },
    {
      "location": "api-reference/webhooks/#webhook-security",
      "title": "Webhook Security",
      "text": ""
    },
    {
      "location": "api-reference/webhooks/#signature-verification",
      "title": "Signature Verification",
      "text": "<p>All webhook requests include an <code>X-Aegis-Signature</code> header:</p> <pre><code>X-Aegis-Signature: sha256=abc123...\n</code></pre> <p>Verify the signature:</p> <pre><code>import crypto from 'crypto';\n\nfunction verifyWebhookSignature(\n  payload: string,\n  signature: string,\n  secret: string\n): boolean {\n  const hmac = crypto.createHmac('sha256', secret);\n  const expectedSignature = 'sha256=' + hmac.update(payload).digest('hex');\n  return crypto.timingSafeEqual(\n    Buffer.from(signature),\n    Buffer.from(expectedSignature)\n  );\n}\n</code></pre>"
    },
    {
      "location": "api-reference/webhooks/#best-practices",
      "title": "Best Practices",
      "text": "<ol> <li>Verify signatures for all webhook requests</li> <li>Use HTTPS endpoints only</li> <li>Return 200 OK quickly to avoid retries</li> <li>Process asynchronously for long-running tasks</li> <li>Monitor failures and update webhook config if needed</li> </ol> <p>For API authentication, see the Authentication Guide.</p>"
    },
    {
      "location": "core-concepts/compliance/",
      "title": "Compliance Mapping",
      "text": "<p>Aegis automatically maps vulnerabilities and remediation activities to FedRAMP and NIST 800-53 Rev 5 compliance controls.</p>"
    },
    {
      "location": "core-concepts/compliance/#overview",
      "title": "Overview",
      "text": "<p>Compliance mapping ensures that all security activities are traceable to federal requirements:</p> <ul> <li>FedRAMP Moderate authorization requirements</li> <li>NIST 800-53 Rev 5 control implementation</li> <li>Continuous monitoring obligations</li> <li>Audit readiness for federal assessments</li> </ul>"
    },
    {
      "location": "core-concepts/compliance/#nist-800-53-rev-5-controls",
      "title": "NIST 800-53 Rev 5 Controls",
      "text": "<p>Aegis implements the following security controls:</p>"
    },
    {
      "location": "core-concepts/compliance/#ra-5-vulnerability-monitoring-and-scanning",
      "title": "RA-5: Vulnerability Monitoring and Scanning",
      "text": "<p>Requirement: Organizations must scan for vulnerabilities and update scanning tools and techniques.</p> <p>Aegis Implementation:</p> <ul> <li>Continuous SBOM scanning on every build</li> <li>Daily vulnerability database updates</li> <li>Real-time CVE monitoring</li> <li>Automated notifications for new vulnerabilities</li> </ul> <p>Evidence:</p> <pre><code>{\n  \"control\": \"RA-5\",\n  \"implementation\": {\n    \"scanFrequency\": \"On every build\",\n    \"databaseUpdates\": \"Daily\",\n    \"coverage\": \"100% of components\",\n    \"lastScan\": \"2025-12-16T15:30:00Z\"\n  },\n  \"artifacts\": [\n    \"SBOM files\",\n    \"Vulnerability scan reports\",\n    \"Audit logs\"\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#si-2-flaw-remediation",
      "title": "SI-2: Flaw Remediation",
      "text": "<p>Requirement: Organizations must identify, report, and correct information system flaws.</p> <p>Aegis Implementation:</p> <ul> <li>Automated POA&amp;M generation</li> <li>FedRAMP-compliant remediation timelines (30/90/180 days)</li> <li>Remediation tracking and reporting</li> <li>Completion verification</li> </ul> <p>Evidence:</p> <pre><code>{\n  \"control\": \"SI-2\",\n  \"implementation\": {\n    \"criticalDeadline\": \"30 days\",\n    \"highDeadline\": \"90 days\",\n    \"mediumDeadline\": \"180 days\",\n    \"trackingMechanism\": \"OSCAL POA&amp;Ms\",\n    \"verificationProcess\": \"Automated re-scanning\"\n  },\n  \"artifacts\": [\n    \"POA&amp;M documents\",\n    \"Remediation reports\",\n    \"Completion evidence\"\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#cm-8-system-component-inventory",
      "title": "CM-8: System Component Inventory",
      "text": "<p>Requirement: Organizations must develop and maintain an inventory of system components.</p> <p>Aegis Implementation:</p> <ul> <li>Comprehensive SBOM for all applications</li> <li>Automated component tracking</li> <li>Version and license documentation</li> <li>Dependency graph visualization</li> </ul> <p>Evidence:</p> <pre><code>{\n  \"control\": \"CM-8\",\n  \"implementation\": {\n    \"inventoryFormat\": \"SPDX 2.3 and CycloneDX 1.4\",\n    \"updateFrequency\": \"On every build\",\n    \"coverage\": \"All software components\",\n    \"accessibility\": \"API and dashboard\"\n  },\n  \"artifacts\": [\n    \"SBOM files\",\n    \"Component database\",\n    \"Dependency graphs\"\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#si-4-system-monitoring",
      "title": "SI-4: System Monitoring",
      "text": "<p>Requirement: Organizations must monitor the information system to detect attacks and indicators of potential attacks.</p> <p>Aegis Implementation:</p> <ul> <li>Real-time vulnerability monitoring</li> <li>Exploit detection and alerting</li> <li>Continuous CVE tracking</li> <li>Security event logging</li> </ul> <p>Evidence:</p> <pre><code>{\n  \"control\": \"SI-4\",\n  \"implementation\": {\n    \"monitoring\": \"Continuous\",\n    \"alerting\": \"Real-time for Critical/High\",\n    \"logging\": \"All security events\",\n    \"retention\": \"7 years\"\n  },\n  \"artifacts\": [\n    \"Monitoring logs\",\n    \"Alert history\",\n    \"Incident reports\"\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#cm-7-least-functionality",
      "title": "CM-7: Least Functionality",
      "text": "<p>Requirement: Organizations must configure systems to provide only essential capabilities.</p> <p>Aegis Implementation:</p> <ul> <li>Identification of vulnerable features</li> <li>Recommendations for disabling unused functionality</li> <li>Configuration guidance</li> <li>Compliance verification</li> </ul> <p>Evidence:</p> <pre><code>{\n  \"control\": \"CM-7\",\n  \"implementation\": {\n    \"process\": \"Identify and document vulnerable features\",\n    \"guidance\": \"Provide remediation recommendations\",\n    \"verification\": \"Configuration scanning\"\n  },\n  \"artifacts\": [\n    \"Vulnerability reports\",\n    \"Configuration recommendations\",\n    \"Verification scans\"\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#fedramp-requirements",
      "title": "FedRAMP Requirements",
      "text": ""
    },
    {
      "location": "core-concepts/compliance/#continuous-monitoring",
      "title": "Continuous Monitoring",
      "text": "<p>FedRAMP requires continuous monitoring of security controls:</p> <p>Monthly Reporting:</p> <ul> <li>Vulnerability scan results</li> <li>POA&amp;M status updates</li> <li>Incident reports</li> <li>Configuration changes</li> </ul> <p>Aegis Automation:</p> <pre><code>// Generate monthly compliance report\nasync function generateMonthlyReport(tenantId: string, month: Date) {\n  const report = {\n    reportingPeriod: month,\n    tenant: tenantId,\n    vulnerabilitySummary: {\n      newVulnerabilities: await getNewVulnerabilities(tenantId, month),\n      remediatedVulnerabilities: await getRemediatedVulnerabilities(tenantId, month),\n      openPOAMs: await getOpenPOAMs(tenantId),\n      overduePOAMs: await getOverduePOAMs(tenantId)\n    },\n    nist80053Controls: {\n      'RA-5': await getRA5Evidence(tenantId, month),\n      'SI-2': await getSI2Evidence(tenantId, month),\n      'CM-8': await getCM8Evidence(tenantId, month),\n      'SI-4': await getSI4Evidence(tenantId, month)\n    },\n    oscalDocuments: await generateOSCALReport(tenantId, month)\n  };\n\n  return report;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#poam-deadlines",
      "title": "POA&amp;M Deadlines",
      "text": "<p>FedRAMP specifies remediation timelines:</p> Severity Deadline Aegis Enforcement Critical 30 days Automated POA&amp;M with 30-day deadline High 90 days Automated POA&amp;M with 90-day deadline Medium 180 days Automated POA&amp;M with 180-day deadline Low No deadline Tracked but no mandatory deadline"
    },
    {
      "location": "core-concepts/compliance/#deviation-requests",
      "title": "Deviation Requests",
      "text": "<p>When deadlines cannot be met, submit deviation requests:</p> <pre><code>mutation RequestDeadlineExtension($poamId: ID!, $input: DeviationRequestInput!) {\n  requestDeadlineExtension(poamId: $poamId, input: $input) {\n    id\n    originalDeadline\n    requestedDeadline\n    justification\n    approvalStatus\n  }\n}\n</code></pre> <p>Input:</p> <pre><code>{\n  \"requestedDeadline\": \"2026-03-15\",\n  \"justification\": \"Extensive testing required due to critical system dependencies\",\n  \"mitigatingControls\": [\n    \"Network segmentation implemented\",\n    \"Enhanced monitoring in place\",\n    \"Access controls strengthened\"\n  ],\n  \"approverRequired\": \"CISO\"\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#compliance-dashboard",
      "title": "Compliance Dashboard",
      "text": "<p>The compliance dashboard provides real-time status:</p> <pre><code>Compliance Overview\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nNIST 800-53 Rev 5 Controls\n\u2705 RA-5: Vulnerability Monitoring       COMPLIANT\n\u2705 SI-2: Flaw Remediation               COMPLIANT\n\u2705 CM-8: Component Inventory            COMPLIANT\n\u26a0\ufe0f  SI-4: System Monitoring             PARTIAL\n\u2705 CM-7: Least Functionality            COMPLIANT\n\nFedRAMP POA&amp;M Status\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nTotal POA&amp;Ms: 27\nOpen: 15 (55.6%)\nIn Progress: 8 (29.6%)\nCompleted: 4 (14.8%)\nOverdue: 3 (11.1%)\n\nUpcoming Deadlines\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nNext 7 days: 3 POA&amp;Ms\nNext 30 days: 8 POA&amp;Ms\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#audit-trail",
      "title": "Audit Trail",
      "text": "<p>All compliance-related activities are logged:</p> <pre><code>@Entity()\nexport class AuditLog {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  tenantId: string;\n\n  @Column()\n  userId: string;\n\n  @Column()\n  action: string; // e.g., 'VULNERABILITY_DETECTED', 'POAM_CREATED', 'POAM_COMPLETED'\n\n  @Column({ type: 'jsonb' })\n  details: Record&lt;string, any&gt;;\n\n  @Column()\n  ipAddress: string;\n\n  @Column()\n  userAgent: string;\n\n  @CreateDateColumn()\n  timestamp: Date;\n}\n</code></pre> <p>Example audit log entries:</p> <pre><code>[\n  {\n    \"action\": \"VULNERABILITY_DETECTED\",\n    \"details\": {\n      \"cveId\": \"CVE-2024-47076\",\n      \"severity\": \"CRITICAL\",\n      \"component\": \"curl@7.68.0\"\n    },\n    \"timestamp\": \"2025-12-16T15:30:00Z\"\n  },\n  {\n    \"action\": \"POAM_CREATED\",\n    \"details\": {\n      \"poamId\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"vulnerabilityId\": \"234e5678-e89b-12d3-a456-426614174001\",\n      \"deadline\": \"2026-01-15\"\n    },\n    \"timestamp\": \"2025-12-16T15:31:00Z\"\n  },\n  {\n    \"action\": \"POAM_COMPLETED\",\n    \"details\": {\n      \"poamId\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"completionDate\": \"2026-01-10\",\n      \"verificationMethod\": \"Automated scan\"\n    },\n    \"timestamp\": \"2026-01-10T14:20:00Z\"\n  }\n]\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#compliance-reports",
      "title": "Compliance Reports",
      "text": "<p>Generate compliance reports for audits:</p>"
    },
    {
      "location": "core-concepts/compliance/#ssp-system-security-plan-package",
      "title": "SSP (System Security Plan) Package",
      "text": "<pre><code>mutation GenerateSSPPackage($projectId: ID!) {\n  generateSSPPackage(projectId: $projectId) {\n    url\n    expiresAt\n    contents {\n      systemSecurityPlan\n      poamDocuments\n      vulnerabilityReports\n      sbomInventory\n      auditLogs\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#sar-security-assessment-report",
      "title": "SAR (Security Assessment Report)",
      "text": "<pre><code>mutation GenerateSAR($projectId: ID!, $assessmentPeriod: DateRange!) {\n  generateSAR(projectId: $projectId, assessmentPeriod: $assessmentPeriod) {\n    url\n    expiresAt\n    summary {\n      controlsAssessed\n      controlsCompliant\n      findingsCount\n      openPOAMsCount\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#continuous-monitoring-report",
      "title": "Continuous Monitoring Report",
      "text": "<pre><code>mutation GenerateContinuousMonitoringReport($projectId: ID!, $month: Date!) {\n  generateContinuousMonitoringReport(projectId: $projectId, month: $month) {\n    url\n    expiresAt\n    metrics {\n      newVulnerabilities\n      remediatedVulnerabilities\n      openPOAMs\n      overduePOAMs\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#oscal-export",
      "title": "OSCAL Export",
      "text": "<p>Export compliance data in OSCAL format:</p> <pre><code>// Export all compliance data as OSCAL\nconst oscalPackage = {\n  systemSecurityPlan: oscalSSP,\n  securityAssessmentPlan: oscalSAP,\n  securityAssessmentResults: oscalSAR,\n  planOfActionAndMilestones: oscalPOAM\n};\n\n// Generate OSCAL JSON\nconst oscalJSON = JSON.stringify(oscalPackage, null, 2);\n\n// Generate OSCAL XML\nconst oscalXML = convertJSONToOSCALXML(oscalPackage);\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#best-practices",
      "title": "Best Practices",
      "text": ""
    },
    {
      "location": "core-concepts/compliance/#1-maintain-current-sboms",
      "title": "1. Maintain Current SBOMs",
      "text": "<p>Generate SBOMs on every build:</p> <pre><code>- name: Generate SBOM\n  run: syft . -o spdx-json &gt; sbom.spdx.json\n\n- name: Upload to Aegis\n  run: |\n    curl -X POST $AEGIS_API_URL/api/evidence \\\n      -F \"file=@sbom.spdx.json\"\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#2-monitor-poam-deadlines",
      "title": "2. Monitor POA&amp;M Deadlines",
      "text": "<p>Set up alerts for upcoming deadlines:</p> <pre><code>// Alert 7 days before deadline\nawait scheduleAlert({\n  type: 'DEADLINE_APPROACHING',\n  daysBeforeDeadline: 7,\n  recipients: ['security-team@example.com']\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#3-document-deviations",
      "title": "3. Document Deviations",
      "text": "<p>When accepting risk or extending deadlines, provide detailed justification:</p> <pre><code>await updatePOAM(poamId, {\n  status: 'RISK_ACCEPTED',\n  riskAcceptance: {\n    reason: 'Detailed technical justification',\n    mitigatingControls: ['Control 1', 'Control 2'],\n    approvedBy: 'CISO',\n    approvalDate: new Date()\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#4-regular-compliance-reviews",
      "title": "4. Regular Compliance Reviews",
      "text": "<p>Schedule monthly compliance reviews:</p> <pre><code>cron.schedule('0 0 1 * *', async () =&gt; {\n  const report = await generateMonthlyReport();\n\n  await sendNotification({\n    type: 'MONTHLY_COMPLIANCE_REPORT',\n    recipients: ['compliance-team@example.com'],\n    report\n  });\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/compliance/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Managing POA&amp;Ms Guide - Track remediation efforts</li> <li>Compliance Reports Guide - Generate audit reports</li> <li>Deployment Guide - Deploy to Azure Government Cloud</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/",
      "title": "Evidence Ingestion",
      "text": "<p>Evidence is the foundation of Aegis's compliance tracking. This page explains how evidence is collected, processed, and stored.</p>"
    },
    {
      "location": "core-concepts/evidence/#what-is-evidence",
      "title": "What is Evidence?",
      "text": "<p>In Aegis, evidence refers to any artifact that demonstrates security compliance:</p> <ul> <li>SBOMs (Software Bill of Materials)</li> <li>Vulnerability scan results</li> <li>Container image scan reports</li> <li>Code analysis reports</li> <li>Security test results</li> </ul> <p>Evidence provides the raw data that Aegis processes to generate vulnerability reports, POA&amp;Ms, and compliance dashboards.</p>"
    },
    {
      "location": "core-concepts/evidence/#evidence-lifecycle",
      "title": "Evidence Lifecycle",
      "text": "<pre><code>Upload \u2192 Store \u2192 Parse \u2192 Scan \u2192 Report\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#1-upload",
      "title": "1. Upload",
      "text": "<p>Evidence can be uploaded via:</p> <ul> <li>Web Interface: Drag-and-drop or file picker</li> <li>REST API: <code>POST /api/evidence</code></li> <li>GraphQL API: <code>createEvidence</code> mutation</li> <li>CI/CD Integration: Automated uploads from build pipelines</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#2-store",
      "title": "2. Store",
      "text": "<p>Upon upload, Aegis:</p> <ol> <li>Validates file format and size</li> <li>Generates unique evidence ID</li> <li>Stores file in Azure Blob Storage</li> <li>Creates metadata record in PostgreSQL</li> <li>Enqueues processing job</li> </ol> <p>Storage Structure:</p> <pre><code>azure-blob-storage/\n  \u2514\u2500\u2500 tenant-{uuid}/\n        \u2514\u2500\u2500 evidence/\n              \u2514\u2500\u2500 {evidence-id}/\n                    \u251c\u2500\u2500 original.json       # Original uploaded file\n                    \u251c\u2500\u2500 parsed.json         # Parsed SBOM data\n                    \u2514\u2500\u2500 scan-results.json   # Vulnerability scan output\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#3-parse",
      "title": "3. Parse",
      "text": "<p>The SBOM Parser Worker processes the evidence:</p> <ul> <li>Detects format (SPDX, CycloneDX, Syft, etc.)</li> <li>Extracts software components</li> <li>Normalizes package identifiers</li> <li>Resolves dependencies</li> <li>Stores components in database</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#4-scan",
      "title": "4. Scan",
      "text": "<p>The Vulnerability Indexer Worker scans components:</p> <ul> <li>Queries vulnerability databases (NVD, OSV, GitHub Advisory)</li> <li>Matches components to known CVEs</li> <li>Calculates CVSS scores</li> <li>Identifies exploitable vulnerabilities</li> <li>Flags Critical and High severity issues</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#5-report",
      "title": "5. Report",
      "text": "<p>Results are made available via:</p> <ul> <li>Dashboard: Real-time compliance metrics</li> <li>POA&amp;Ms: Automatically generated remediation plans</li> <li>API: Programmatic access to findings</li> <li>Exports: PDF and JSON compliance reports</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#evidence-types",
      "title": "Evidence Types",
      "text": ""
    },
    {
      "location": "core-concepts/evidence/#sbom-files",
      "title": "SBOM Files",
      "text": "<p>Aegis supports industry-standard SBOM formats:</p>"
    },
    {
      "location": "core-concepts/evidence/#spdx-recommended",
      "title": "SPDX (Recommended)",
      "text": "<pre><code>{\n  \"spdxVersion\": \"SPDX-2.3\",\n  \"dataLicense\": \"CC0-1.0\",\n  \"SPDXID\": \"SPDXRef-DOCUMENT\",\n  \"name\": \"aegis-api\",\n  \"packages\": [\n    {\n      \"SPDXID\": \"SPDXRef-Package-express\",\n      \"name\": \"express\",\n      \"versionInfo\": \"4.18.2\",\n      \"supplier\": \"Organization: OpenJS Foundation\",\n      \"downloadLocation\": \"https://registry.npmjs.org/express/-/express-4.18.2.tgz\"\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#cyclonedx",
      "title": "CycloneDX",
      "text": "<pre><code>{\n  \"bomFormat\": \"CycloneDX\",\n  \"specVersion\": \"1.4\",\n  \"components\": [\n    {\n      \"type\": \"library\",\n      \"name\": \"express\",\n      \"version\": \"4.18.2\",\n      \"purl\": \"pkg:npm/express@4.18.2\"\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#scan-results",
      "title": "Scan Results",
      "text": "<p>Aegis accepts scan results from:</p> <ul> <li>Grype: Container and filesystem vulnerability scanner</li> <li>Trivy: Comprehensive security scanner</li> <li>Snyk: Developer security platform</li> <li>Custom Scanners: JSON format following Aegis schema</li> </ul> <p>Example Grype output:</p> <pre><code>{\n  \"matches\": [\n    {\n      \"vulnerability\": {\n        \"id\": \"CVE-2024-47076\",\n        \"severity\": \"Critical\",\n        \"cvss\": [\n          {\n            \"version\": \"3.1\",\n            \"vector\": \"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\",\n            \"score\": 9.8\n          }\n        ]\n      },\n      \"artifact\": {\n        \"name\": \"curl\",\n        \"version\": \"7.68.0\"\n      }\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#evidence-entity",
      "title": "Evidence Entity",
      "text": "<p>The <code>Evidence</code> entity stores metadata about uploaded files:</p> <pre><code>@Entity()\nexport class Evidence {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  tenantId: string;\n\n  @Column()\n  projectId: string;\n\n  @Column()\n  buildId: string;\n\n  @Column()\n  fileName: string;\n\n  @Column()\n  fileSize: number;\n\n  @Column()\n  mimeType: string;\n\n  @Column()\n  blobUrl: string;\n\n  @Column({ type: 'enum', enum: EvidenceStatus })\n  status: EvidenceStatus; // UPLOADED, PARSING, PARSED, SCANNING, COMPLETED, FAILED\n\n  @Column({ type: 'jsonb', nullable: true })\n  metadata: Record&lt;string, any&gt;;\n\n  @CreateDateColumn()\n  uploadedAt: Date;\n\n  @OneToMany(() =&gt; Vulnerability, vuln =&gt; vuln.evidence)\n  vulnerabilities: Vulnerability[];\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#upload-evidence",
      "title": "Upload Evidence",
      "text": ""
    },
    {
      "location": "core-concepts/evidence/#via-web-interface",
      "title": "Via Web Interface",
      "text": "<ol> <li>Navigate to the Aegis dashboard</li> <li>Select your project</li> <li>Click \"Upload Evidence\"</li> <li>Select SBOM or scan result file</li> <li>Click \"Upload\"</li> </ol> <p>The interface shows real-time progress:</p> <ul> <li>\u2705 File uploaded</li> <li>\u2705 SBOM parsed (X components found)</li> <li>\u2705 Vulnerability scan complete (X vulnerabilities found)</li> <li>\u2705 POA&amp;Ms generated</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#via-rest-api",
      "title": "Via REST API",
      "text": "<pre><code>curl -X POST http://localhost:3001/api/evidence \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  -F \"file=@sbom.spdx.json\" \\\n  -F \"projectId=123e4567-e89b-12d3-a456-426614174000\" \\\n  -F \"buildId=123e4567-e89b-12d3-a456-426614174001\"\n</code></pre> <p>Response:</p> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174002\",\n  \"fileName\": \"sbom.spdx.json\",\n  \"fileSize\": 1024,\n  \"status\": \"UPLOADED\",\n  \"uploadedAt\": \"2025-12-16T15:30:00Z\"\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#via-graphql-api",
      "title": "Via GraphQL API",
      "text": "<pre><code>mutation UploadEvidence($input: EvidenceInput!) {\n  createEvidence(input: $input) {\n    id\n    fileName\n    status\n    uploadedAt\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"input\": {\n    \"projectId\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"buildId\": \"123e4567-e89b-12d3-a456-426614174001\",\n    \"file\": \"base64-encoded-file-content\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#via-cicd-pipeline",
      "title": "Via CI/CD Pipeline",
      "text": ""
    },
    {
      "location": "core-concepts/evidence/#github-actions",
      "title": "GitHub Actions",
      "text": "<pre><code>name: Upload SBOM to Aegis\n\non:\n  push:\n    branches: [main]\n\njobs:\n  upload-sbom:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Generate SBOM\n        run: |\n          syft . -o spdx-json &gt; sbom.spdx.json\n\n      - name: Upload to Aegis\n        env:\n          AEGIS_API_URL: ${{ secrets.AEGIS_API_URL }}\n          AEGIS_TOKEN: ${{ secrets.AEGIS_TOKEN }}\n          PROJECT_ID: ${{ secrets.AEGIS_PROJECT_ID }}\n        run: |\n          curl -X POST $AEGIS_API_URL/api/evidence \\\n            -H \"Authorization: Bearer $AEGIS_TOKEN\" \\\n            -F \"file=@sbom.spdx.json\" \\\n            -F \"projectId=$PROJECT_ID\"\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#evidence-processing",
      "title": "Evidence Processing",
      "text": ""
    },
    {
      "location": "core-concepts/evidence/#queue-jobs",
      "title": "Queue Jobs",
      "text": "<p>Evidence processing is handled by background workers:</p> <pre><code>// SBOM Parser Queue\nawait sbomParserQueue.add('parse-sbom', {\n  evidenceId: evidence.id,\n  blobUrl: evidence.blobUrl,\n  format: 'spdx-2.3'\n});\n\n// Vulnerability Indexer Queue\nawait vulnerabilityIndexerQueue.add('scan-components', {\n  evidenceId: evidence.id,\n  components: parsedComponents\n});\n\n// POA&amp;M Generator Queue\nawait poamGeneratorQueue.add('generate-poam', {\n  evidenceId: evidence.id,\n  vulnerabilities: criticalAndHighVulns\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#status-tracking",
      "title": "Status Tracking",
      "text": "<p>Monitor evidence processing status:</p> <pre><code>query GetEvidenceStatus($id: ID!) {\n  evidence(id: $id) {\n    id\n    status\n    fileName\n    uploadedAt\n    processingStartedAt\n    processingCompletedAt\n    vulnerabilities {\n      totalCount\n      criticalCount\n      highCount\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/evidence/#retention-policy",
      "title": "Retention Policy",
      "text": "<p>Evidence is retained according to FedRAMP requirements:</p> <ul> <li>Raw Evidence: 3 years minimum</li> <li>Parsed Data: 3 years minimum</li> <li>Audit Logs: 7 years (configurable)</li> </ul> <p>Retention is enforced via:</p> <ul> <li>Azure Blob Storage lifecycle management</li> <li>PostgreSQL archival policies</li> <li>Automated compliance reports</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#security-considerations",
      "title": "Security Considerations",
      "text": ""
    },
    {
      "location": "core-concepts/evidence/#access-control",
      "title": "Access Control",
      "text": "<ul> <li>Evidence is tenant-isolated</li> <li>Access controlled via JWT claims</li> <li>Row-Level Security enforces tenant boundaries</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#encryption",
      "title": "Encryption",
      "text": "<ul> <li>In Transit: TLS 1.2+ for uploads</li> <li>At Rest: Azure Storage Service Encryption</li> <li>Database: PostgreSQL SSL connections</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#validation",
      "title": "Validation",
      "text": "<ul> <li>File size limits (100MB default)</li> <li>MIME type validation</li> <li>Malware scanning (future)</li> <li>Schema validation for SBOMs</li> </ul>"
    },
    {
      "location": "core-concepts/evidence/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>SBOM Processing - Learn how SBOMs are parsed</li> <li>Vulnerability Scanning - Understand vulnerability detection</li> <li>Upload Evidence Guide - Detailed upload instructions</li> </ul>"
    },
    {
      "location": "core-concepts/multi-tenancy/",
      "title": "Multi-Tenancy",
      "text": "<p>Aegis provides enterprise-grade multi-tenant isolation using PostgreSQL Row-Level Security (RLS), ensuring complete data separation between organizations.</p>"
    },
    {
      "location": "core-concepts/multi-tenancy/#overview",
      "title": "Overview",
      "text": "<p>Multi-tenancy enables a single Aegis instance to serve multiple organizations securely:</p> <ul> <li>Complete data isolation between tenants</li> <li>Shared infrastructure for cost efficiency</li> <li>Independent configuration per tenant</li> <li>FedRAMP-compliant tenant separation</li> </ul>"
    },
    {
      "location": "core-concepts/multi-tenancy/#tenant-entity",
      "title": "Tenant Entity",
      "text": "<p>Each organization is represented as a tenant:</p> <pre><code>@Entity()\nexport class Tenant {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column({ unique: true })\n  slug: string; // e.g., \"acme-corp\"\n\n  @Column()\n  name: string; // e.g., \"Acme Corporation\"\n\n  @Column({ type: 'jsonb', nullable: true })\n  settings: {\n    fedrampLevel?: 'Low' | 'Moderate' | 'High';\n    retentionPolicy?: number; // days\n    notificationEmails?: string[];\n    customDomain?: string;\n  };\n\n  @Column({ default: true })\n  active: boolean;\n\n  @CreateDateColumn()\n  createdAt: Date;\n\n  @OneToMany(() =&gt; User, user =&gt; user.tenant)\n  users: User[];\n\n  @OneToMany(() =&gt; Project, project =&gt; project.tenant)\n  projects: Project[];\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#row-level-security-rls",
      "title": "Row-Level Security (RLS)",
      "text": "<p>PostgreSQL RLS enforces tenant isolation at the database level:</p>"
    },
    {
      "location": "core-concepts/multi-tenancy/#enable-rls",
      "title": "Enable RLS",
      "text": "<pre><code>-- Enable RLS on all tenant-scoped tables\nALTER TABLE evidence ENABLE ROW LEVEL SECURITY;\nALTER TABLE vulnerabilities ENABLE ROW LEVEL SECURITY;\nALTER TABLE poams ENABLE ROW LEVEL SECURITY;\nALTER TABLE components ENABLE ROW LEVEL SECURITY;\nALTER TABLE projects ENABLE ROW LEVEL SECURITY;\nALTER TABLE builds ENABLE ROW LEVEL SECURITY;\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#create-policies",
      "title": "Create Policies",
      "text": "<pre><code>-- Evidence table policy\nCREATE POLICY tenant_isolation_evidence ON evidence\n  USING (tenant_id = current_setting('app.tenant_id')::uuid);\n\n-- Vulnerabilities table policy\nCREATE POLICY tenant_isolation_vulnerabilities ON vulnerabilities\n  USING (tenant_id = current_setting('app.tenant_id')::uuid);\n\n-- POA&amp;Ms table policy\nCREATE POLICY tenant_isolation_poams ON poams\n  USING (tenant_id = current_setting('app.tenant_id')::uuid);\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#set-tenant-context",
      "title": "Set Tenant Context",
      "text": "<p>Before executing queries, set the tenant context:</p> <pre><code>// Middleware to set tenant context\nexport async function setTenantContext(req: Request, res: Response, next: NextFunction) {\n  const tenantId = req.user.tenantId; // From JWT token\n\n  // Set tenant ID in PostgreSQL session\n  await dataSource.query('SET app.tenant_id = $1', [tenantId]);\n\n  next();\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#authentication-authorization",
      "title": "Authentication &amp; Authorization",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#jwt-token-structure",
      "title": "JWT Token Structure",
      "text": "<p>JWT tokens include tenant information:</p> <pre><code>{\n  \"sub\": \"user-id\",\n  \"tenantId\": \"tenant-uuid\",\n  \"roles\": [\"user\", \"admin\"],\n  \"email\": \"user@example.com\",\n  \"iat\": 1702310000,\n  \"exp\": 1702396400\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#token-validation",
      "title": "Token Validation",
      "text": "<pre><code>export function validateToken(token: string): JWTPayload {\n  const payload = jwt.verify(token, process.env.JWT_SECRET);\n\n  // Ensure tenant ID is present\n  if (!payload.tenantId) {\n    throw new Error('Invalid token: missing tenant ID');\n  }\n\n  return payload;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#request-flow",
      "title": "Request Flow",
      "text": "<pre><code>1. Client sends request with JWT token\n   \u2502\n   \u25bc\n2. Middleware validates token and extracts tenantId\n   \u2502\n   \u25bc\n3. Set PostgreSQL session variable: app.tenant_id\n   \u2502\n   \u25bc\n4. Execute query (RLS automatically filters by tenant)\n   \u2502\n   \u25bc\n5. Return results (only tenant's data)\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#storage-isolation",
      "title": "Storage Isolation",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#azure-blob-storage",
      "title": "Azure Blob Storage",
      "text": "<p>Each tenant has a dedicated container:</p> <pre><code>azure-blob-storage/\n  \u251c\u2500\u2500 tenant-{uuid-1}/\n  \u2502     \u251c\u2500\u2500 evidence/\n  \u2502     \u251c\u2500\u2500 reports/\n  \u2502     \u2514\u2500\u2500 exports/\n  \u251c\u2500\u2500 tenant-{uuid-2}/\n  \u2502     \u251c\u2500\u2500 evidence/\n  \u2502     \u251c\u2500\u2500 reports/\n  \u2502     \u2514\u2500\u2500 exports/\n  \u2514\u2500\u2500 tenant-{uuid-3}/\n        \u251c\u2500\u2500 evidence/\n        \u251c\u2500\u2500 reports/\n        \u2514\u2500\u2500 exports/\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#sas-token-scoping",
      "title": "SAS Token Scoping",
      "text": "<p>Shared Access Signatures are scoped to tenant containers:</p> <pre><code>export async function generateSASToken(tenantId: string, blobPath: string): Promise&lt;string&gt; {\n  const containerName = `tenant-${tenantId}`;\n\n  const sasOptions: BlobSASSignatureValues = {\n    containerName,\n    blobName: blobPath,\n    permissions: BlobSASPermissions.parse('r'), // Read-only\n    expiresOn: new Date(Date.now() + 3600 * 1000) // 1 hour\n  };\n\n  const sasToken = generateBlobSASQueryParameters(sasOptions, credential).toString();\n\n  return `${blobServiceClient.url}/${containerName}/${blobPath}?${sasToken}`;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#tenant-configuration",
      "title": "Tenant Configuration",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#settings",
      "title": "Settings",
      "text": "<p>Tenants can configure:</p> <ul> <li>FedRAMP Level: Low, Moderate, High</li> <li>Retention Policy: Evidence retention duration</li> <li>Notifications: Email addresses for alerts</li> <li>Custom Domain: Branded tenant URLs</li> <li>SSO: SAML/OIDC integration</li> </ul> <p>Example:</p> <pre><code>await updateTenant(tenantId, {\n  settings: {\n    fedrampLevel: 'Moderate',\n    retentionPolicy: 1095, // 3 years\n    notificationEmails: [\n      'security@acme-corp.com',\n      'compliance@acme-corp.com'\n    ],\n    customDomain: 'aegis.acme-corp.com',\n    sso: {\n      enabled: true,\n      provider: 'SAML',\n      idpMetadataUrl: 'https://idp.acme-corp.com/metadata.xml'\n    }\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#custom-branding",
      "title": "Custom Branding",
      "text": "<p>Tenants can customize the UI:</p> <pre><code>{\n  branding: {\n    logo: 'https://cdn.acme-corp.com/logo.png',\n    primaryColor: '#1a73e8',\n    companyName: 'Acme Corporation',\n    supportEmail: 'support@acme-corp.com'\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#user-management",
      "title": "User Management",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#invite-users",
      "title": "Invite Users",
      "text": "<pre><code>mutation InviteUser($input: InviteUserInput!) {\n  inviteUser(input: $input) {\n    id\n    email\n    role\n    invitationSent\n  }\n}\n</code></pre> <p>Input:</p> <pre><code>{\n  \"email\": \"newuser@acme-corp.com\",\n  \"role\": \"USER\",\n  \"projects\": [\"project-id-1\", \"project-id-2\"]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#roles",
      "title": "Roles",
      "text": "<ul> <li>OWNER: Full access to tenant settings</li> <li>ADMIN: Manage projects, users, and evidence</li> <li>USER: View data and upload evidence</li> <li>VIEWER: Read-only access</li> </ul>"
    },
    {
      "location": "core-concepts/multi-tenancy/#tenant-quotas",
      "title": "Tenant Quotas",
      "text": "<p>Enforce usage limits per tenant:</p> <pre><code>@Entity()\nexport class TenantQuota {\n  @Column()\n  tenantId: string;\n\n  @Column({ default: 1000 })\n  maxProjects: number;\n\n  @Column({ default: 10000 })\n  maxEvidence: number;\n\n  @Column({ default: 100 * 1024 * 1024 * 1024 }) // 100 GB\n  storageLimit: number;\n\n  @Column({ default: 0 })\n  storageUsed: number;\n}\n</code></pre> <p>Check quota before upload:</p> <pre><code>export async function checkQuota(tenantId: string, fileSize: number): Promise&lt;boolean&gt; {\n  const quota = await getTenantQuota(tenantId);\n\n  if (quota.storageUsed + fileSize &gt; quota.storageLimit) {\n    throw new Error('Storage quota exceeded');\n  }\n\n  return true;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#tenant-metrics",
      "title": "Tenant Metrics",
      "text": "<p>Track usage per tenant:</p> <pre><code>query TenantMetrics($tenantId: ID!) {\n  tenant(id: $tenantId) {\n    metrics {\n      totalProjects\n      totalEvidence\n      totalVulnerabilities\n      storageUsed\n      activeUsers\n      lastActivityAt\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#cross-tenant-operations",
      "title": "Cross-Tenant Operations",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#admin-dashboard",
      "title": "Admin Dashboard",
      "text": "<p>Super-admin users can view all tenants:</p> <pre><code>query AllTenants {\n  tenants {\n    id\n    name\n    slug\n    active\n    metrics {\n      totalProjects\n      storageUsed\n      activeUsers\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#audit-logs",
      "title": "Audit Logs",
      "text": "<p>Cross-tenant audit logs for compliance:</p> <pre><code>SELECT\n  t.name AS tenant_name,\n  al.action,\n  al.timestamp,\n  u.email AS user_email\nFROM audit_logs al\nJOIN tenants t ON al.tenant_id = t.id\nJOIN users u ON al.user_id = u.id\nWHERE al.timestamp &gt;= NOW() - INTERVAL '7 days'\nORDER BY al.timestamp DESC;\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#security-considerations",
      "title": "Security Considerations",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#tenant-leakage-prevention",
      "title": "Tenant Leakage Prevention",
      "text": "<ul> <li>RLS Enforcement: PostgreSQL RLS cannot be bypassed</li> <li>Connection Pooling: Each query sets tenant context</li> <li>API Validation: Verify tenant ID in JWT matches requested resources</li> <li>Storage Isolation: Separate Azure containers per tenant</li> </ul>"
    },
    {
      "location": "core-concepts/multi-tenancy/#testing-isolation",
      "title": "Testing Isolation",
      "text": "<p>Unit tests verify tenant isolation:</p> <pre><code>describe('Tenant Isolation', () =&gt; {\n  it('should not return other tenant data', async () =&gt; {\n    // Create evidence for tenant A\n    const evidenceA = await createEvidence({\n      tenantId: 'tenant-a',\n      fileName: 'sbom-a.json'\n    });\n\n    // Query as tenant B\n    const query = dataSource\n      .getRepository(Evidence)\n      .createQueryBuilder('evidence')\n      .where('evidence.id = :id', { id: evidenceA.id });\n\n    // Set tenant B context\n    await dataSource.query('SET app.tenant_id = $1', ['tenant-b']);\n\n    // Should return no results\n    const result = await query.getOne();\n    expect(result).toBeNull();\n  });\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#best-practices",
      "title": "Best Practices",
      "text": ""
    },
    {
      "location": "core-concepts/multi-tenancy/#1-always-set-tenant-context",
      "title": "1. Always Set Tenant Context",
      "text": "<p>Never execute queries without setting tenant context:</p> <pre><code>// \u274c BAD - No tenant context\nconst evidence = await dataSource.getRepository(Evidence).find();\n\n// \u2705 GOOD - Set tenant context first\nawait dataSource.query('SET app.tenant_id = $1', [tenantId]);\nconst evidence = await dataSource.getRepository(Evidence).find();\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#2-validate-tenant-ownership",
      "title": "2. Validate Tenant Ownership",
      "text": "<p>Verify user belongs to tenant:</p> <pre><code>export function validateTenantAccess(user: User, tenantId: string) {\n  if (user.tenantId !== tenantId) {\n    throw new Error('Access denied: Invalid tenant');\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#3-use-tenant-specific-queues",
      "title": "3. Use Tenant-Specific Queues",
      "text": "<p>Separate queue processing per tenant:</p> <pre><code>// Create tenant-specific queue\nconst queueName = `sbom-parser-${tenantId}`;\nconst queue = new Queue(queueName, { connection: redisConnection });\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#4-monitor-cross-tenant-metrics",
      "title": "4. Monitor Cross-Tenant Metrics",
      "text": "<p>Track tenant activity for billing and capacity planning:</p> <pre><code>cron.schedule('0 0 * * *', async () =&gt; {\n  const tenants = await getAllTenants();\n\n  for (const tenant of tenants) {\n    const metrics = await calculateTenantMetrics(tenant.id);\n\n    await storeTenantMetrics(tenant.id, metrics);\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/multi-tenancy/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Deployment Guide - Deploy multi-tenant Aegis</li> <li>Configuration - Configure tenant settings</li> <li>API Reference - Learn about authentication</li> </ul>"
    },
    {
      "location": "core-concepts/poam/",
      "title": "POA&amp;M Generation",
      "text": "<p>Plans of Action &amp; Milestones (POA&amp;Ms) are automatically generated for all Critical and High severity vulnerabilities, ensuring FedRAMP compliance.</p>"
    },
    {
      "location": "core-concepts/poam/#what-is-a-poam",
      "title": "What is a POA&amp;M?",
      "text": "<p>A Plan of Action &amp; Milestones (POA&amp;M) is a formal document required by FedRAMP that:</p> <ul> <li>Identifies security weaknesses</li> <li>Documents remediation plans</li> <li>Sets deadlines for fixes</li> <li>Tracks progress toward resolution</li> </ul> <p>POA&amp;Ms are mandatory for:</p> <ul> <li>FedRAMP Authorization</li> <li>NIST 800-53 compliance</li> <li>Federal security audits</li> </ul>"
    },
    {
      "location": "core-concepts/poam/#oscal-format",
      "title": "OSCAL Format",
      "text": "<p>Aegis generates POA&amp;Ms in OSCAL (Open Security Controls Assessment Language), the NIST standard format:</p> <pre><code>{\n  \"plan-of-action-and-milestones\": {\n    \"uuid\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"metadata\": {\n      \"title\": \"POA&amp;M for CVE-2024-47076\",\n      \"last-modified\": \"2025-12-16T15:30:00Z\",\n      \"version\": \"1.0\",\n      \"oscal-version\": \"1.0.4\"\n    },\n    \"poam-items\": [\n      {\n        \"uuid\": \"234e5678-e89b-12d3-a456-426614174001\",\n        \"title\": \"curl CURLOPT_PROTOCOLS bypass vulnerability\",\n        \"description\": \"Critical vulnerability in curl library allowing protocol bypass via redirect\",\n        \"finding-uuid\": \"345e6789-e89b-12d3-a456-426614174002\",\n        \"risk-statement\": \"Attackers could exploit this vulnerability to bypass protocol restrictions and access unintended resources\",\n        \"risk-level\": \"CRITICAL\",\n        \"related-observations\": [\n          {\n            \"observation-uuid\": \"456e7890-e89b-12d3-a456-426614174003\",\n            \"description\": \"CVE-2024-47076 detected in curl@7.68.0\"\n          }\n        ],\n        \"mitigating-factor\": [\n          {\n            \"description\": \"Network isolation limits exposure\"\n          }\n        ],\n        \"remediation-plan\": [\n          {\n            \"uuid\": \"567e8901-e89b-12d3-a456-426614174004\",\n            \"description\": \"Update curl to version 7.88.0 or later\",\n            \"scheduled-completion-date\": \"2026-01-15\"\n          }\n        ]\n      }\n    ]\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#fedramp-timelines",
      "title": "FedRAMP Timelines",
      "text": "<p>POA&amp;Ms are assigned deadlines based on FedRAMP requirements:</p> Severity Deadline Days from Discovery CRITICAL 30 days 30 HIGH 90 days 90 MEDIUM 180 days 180 LOW No deadline N/A <p>Example:</p> <pre><code>CVE-2024-47076 (CRITICAL, CVSS 9.8)\nDiscovered: Dec 16, 2025\nDeadline: Jan 15, 2026 (30 days)\nStatus: OPEN\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#poam-entity",
      "title": "POA&amp;M Entity",
      "text": "<p>POA&amp;Ms are tracked in the database:</p> <pre><code>@Entity()\nexport class POAM {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  tenantId: string;\n\n  @Column()\n  vulnerabilityId: string;\n\n  @Column()\n  title: string;\n\n  @Column('text')\n  description: string;\n\n  @Column('text')\n  riskStatement: string;\n\n  @Column({ type: 'enum', enum: POAMStatus })\n  status: POAMStatus; // OPEN, IN_PROGRESS, COMPLETED, RISK_ACCEPTED, FALSE_POSITIVE\n\n  @Column({ type: 'date' })\n  discoveryDate: Date;\n\n  @Column({ type: 'date' })\n  scheduledCompletionDate: Date;\n\n  @Column({ type: 'date', nullable: true })\n  actualCompletionDate: Date;\n\n  @Column({ type: 'jsonb' })\n  remediationPlan: {\n    description: string;\n    steps: string[];\n    estimatedEffort: string;\n    assignedTo?: string;\n  };\n\n  @Column({ type: 'jsonb', nullable: true })\n  nistControls: string[]; // e.g., [\"RA-5\", \"SI-2\", \"CM-8\"]\n\n  @Column({ type: 'jsonb', nullable: true })\n  oscalDocument: Record&lt;string, any&gt;;\n\n  @OneToOne(() =&gt; Vulnerability, vuln =&gt; vuln.poam)\n  vulnerability: Vulnerability;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#poam-statuses",
      "title": "POA&amp;M Statuses",
      "text": ""
    },
    {
      "location": "core-concepts/poam/#open",
      "title": "OPEN",
      "text": "<p>Initial state when POA&amp;M is created:</p> <pre><code>{\n  status: 'OPEN',\n  discoveryDate: '2025-12-16',\n  scheduledCompletionDate: '2026-01-15',\n  actualCompletionDate: null\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#in_progress",
      "title": "IN_PROGRESS",
      "text": "<p>Remediation work has started:</p> <pre><code>{\n  status: 'IN_PROGRESS',\n  remediationPlan: {\n    assignedTo: 'security-team',\n    steps: [\n      'Review vulnerability details',\n      'Test updated version in staging',\n      'Deploy to production'\n    ],\n    currentStep: 2\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#completed",
      "title": "COMPLETED",
      "text": "<p>Vulnerability has been fixed:</p> <pre><code>{\n  status: 'COMPLETED',\n  actualCompletionDate: '2026-01-10',\n  completionEvidence: {\n    scanResult: 'No vulnerabilities found',\n    verifiedBy: 'security-team'\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#risk_accepted",
      "title": "RISK_ACCEPTED",
      "text": "<p>Risk has been accepted (requires approval):</p> <pre><code>{\n  status: 'RISK_ACCEPTED',\n  riskAcceptance: {\n    reason: 'Component not exposed to network',\n    approvedBy: 'CISO',\n    approvalDate: '2025-12-20',\n    expirationDate: '2026-06-20'\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#false_positive",
      "title": "FALSE_POSITIVE",
      "text": "<p>Vulnerability is not applicable:</p> <pre><code>{\n  status: 'FALSE_POSITIVE',\n  falsePositiveReason: 'Vulnerable feature not enabled',\n  verifiedBy: 'security-team'\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#poam-generator-worker",
      "title": "POA&amp;M Generator Worker",
      "text": "<p>Automatically generates POA&amp;Ms for Critical and High vulnerabilities:</p> <pre><code>export class POAMGeneratorWorker {\n  async process(job: Job&lt;POAMGenerateJob&gt;) {\n    const { evidenceId, vulnerabilities } = job.data;\n\n    const poams: POAM[] = [];\n\n    for (const vuln of vulnerabilities) {\n      // Skip if POA&amp;M already exists\n      if (await this.poamExists(vuln.id)) {\n        continue;\n      }\n\n      // Calculate deadline based on severity\n      const deadline = this.calculateDeadline(vuln.severity);\n\n      // Map to NIST controls\n      const nistControls = this.mapToNISTControls(vuln);\n\n      // Generate remediation plan\n      const remediationPlan = this.generateRemediationPlan(vuln);\n\n      // Create OSCAL document\n      const oscalDocument = this.generateOSCAL({\n        vulnerability: vuln,\n        deadline,\n        nistControls,\n        remediationPlan\n      });\n\n      // Create POA&amp;M\n      const poam = await this.createPOAM({\n        vulnerabilityId: vuln.id,\n        title: `Remediate ${vuln.cveId}`,\n        description: vuln.description,\n        riskStatement: this.generateRiskStatement(vuln),\n        status: 'OPEN',\n        discoveryDate: new Date(),\n        scheduledCompletionDate: deadline,\n        remediationPlan,\n        nistControls,\n        oscalDocument\n      });\n\n      poams.push(poam);\n    }\n\n    return { poamsGenerated: poams.length };\n  }\n\n  private calculateDeadline(severity: string): Date {\n    const now = new Date();\n    switch (severity) {\n      case 'CRITICAL':\n        return addDays(now, 30);\n      case 'HIGH':\n        return addDays(now, 90);\n      case 'MEDIUM':\n        return addDays(now, 180);\n      default:\n        return null;\n    }\n  }\n\n  private mapToNISTControls(vuln: Vulnerability): string[] {\n    // Map vulnerability type to NIST 800-53 Rev 5 controls\n    const controls = ['RA-5', 'SI-2']; // Always include these\n\n    if (vuln.exploitAvailable) {\n      controls.push('SI-4'); // System Monitoring\n    }\n\n    if (vuln.component.type === 'dependency') {\n      controls.push('CM-8'); // System Component Inventory\n    }\n\n    return controls;\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#nist-800-53-control-mapping",
      "title": "NIST 800-53 Control Mapping",
      "text": "<p>POA&amp;Ms are mapped to NIST 800-53 Rev 5 controls:</p> Control Name Description RA-5 Vulnerability Monitoring and Scanning Continuous vulnerability scanning SI-2 Flaw Remediation Timely patching of vulnerabilities CM-8 System Component Inventory SBOM maintenance SI-4 System Monitoring Detection of exploitation attempts CM-7 Least Functionality Disable vulnerable features <p>Example mapping:</p> <pre><code>{\n  cveId: 'CVE-2024-47076',\n  nistControls: ['RA-5', 'SI-2', 'CM-8'],\n  controlMappings: [\n    {\n      control: 'RA-5',\n      implementation: 'Automated SBOM scanning detected vulnerability',\n      status: 'COMPLIANT'\n    },\n    {\n      control: 'SI-2',\n      implementation: 'Remediation planned within 30-day deadline',\n      status: 'IN_PROGRESS'\n    },\n    {\n      control: 'CM-8',\n      implementation: 'Component inventory maintained in Aegis',\n      status: 'COMPLIANT'\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#query-poams",
      "title": "Query POA&amp;Ms",
      "text": ""
    },
    {
      "location": "core-concepts/poam/#get-all-poams",
      "title": "Get All POA&amp;Ms",
      "text": "<pre><code>query GetPOAMs($projectId: ID!, $status: POAMStatus) {\n  project(id: $projectId) {\n    poams(status: $status) {\n      id\n      title\n      status\n      discoveryDate\n      scheduledCompletionDate\n      actualCompletionDate\n      vulnerability {\n        cveId\n        severity\n        cvssScore\n      }\n      remediationPlan {\n        description\n        assignedTo\n      }\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#get-overdue-poams",
      "title": "Get Overdue POA&amp;Ms",
      "text": "<pre><code>query GetOverduePOAMs($projectId: ID!) {\n  project(id: $projectId) {\n    overduePOAMs {\n      id\n      title\n      scheduledCompletionDate\n      daysOverdue\n      vulnerability {\n        cveId\n        severity\n      }\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#update-poam-status",
      "title": "Update POA&amp;M Status",
      "text": "<pre><code>mutation UpdatePOAMStatus($id: ID!, $status: POAMStatus!, $notes: String) {\n  updatePOAM(id: $id, input: { status: $status, notes: $notes }) {\n    id\n    status\n    actualCompletionDate\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#poam-dashboard",
      "title": "POA&amp;M Dashboard",
      "text": "<p>The POA&amp;M dashboard displays:</p> <ul> <li>Open POA&amp;Ms: Count and list</li> <li>Overdue POA&amp;Ms: Highlighted in red</li> <li>Upcoming Deadlines: Next 7 days</li> <li>Completion Rate: Percentage of closed POA&amp;Ms</li> <li>Mean Time to Remediate: Average days from discovery to fix</li> </ul> <p>Example dashboard:</p> <pre><code>POA&amp;M Summary\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nTotal: 27         Overdue: 3\nOpen: 15          In Progress: 8\nCompleted: 4\n\nUpcoming Deadlines (Next 7 Days)\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nDec 18  CVE-2024-47076 (CRITICAL)\nDec 19  CVE-2024-45321 (CRITICAL)\nDec 22  CVE-2024-12345 (HIGH)\n\nOverdue POA&amp;Ms\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nCVE-2024-98765 (HIGH) - 5 days overdue\nCVE-2024-54321 (MEDIUM) - 12 days overdue\nCVE-2024-11111 (HIGH) - 23 days overdue\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#export-poams",
      "title": "Export POA&amp;Ms",
      "text": "<p>Generate compliance reports:</p> <pre><code>mutation ExportPOAMs($projectId: ID!, $format: ExportFormat!) {\n  exportPOAMs(projectId: $projectId, format: $format) {\n    url\n    expiresAt\n  }\n}\n</code></pre> <p>Supported formats:</p> <ul> <li>OSCAL JSON: NIST standard format</li> <li>OSCAL XML: Alternative NIST format</li> <li>PDF: Human-readable report</li> <li>CSV: Spreadsheet format for tracking</li> </ul>"
    },
    {
      "location": "core-concepts/poam/#best-practices",
      "title": "Best Practices",
      "text": ""
    },
    {
      "location": "core-concepts/poam/#1-assign-ownership",
      "title": "1. Assign Ownership",
      "text": "<p>Assign POA&amp;Ms to specific teams:</p> <pre><code>await updatePOAM(poamId, {\n  remediationPlan: {\n    assignedTo: 'platform-team',\n    estimatedEffort: 'MEDIUM'\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#2-track-progress",
      "title": "2. Track Progress",
      "text": "<p>Update status as work progresses:</p> <pre><code>// Start remediation\nawait updatePOAM(poamId, { status: 'IN_PROGRESS' });\n\n// Complete remediation\nawait updatePOAM(poamId, {\n  status: 'COMPLETED',\n  actualCompletionDate: new Date()\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#3-monitor-deadlines",
      "title": "3. Monitor Deadlines",
      "text": "<p>Set up alerts for upcoming deadlines:</p> <pre><code>// Alert 7 days before deadline\ncron.schedule('0 9 * * *', async () =&gt; {\n  const upcomingDeadlines = await getUpcomingDeadlines(7);\n\n  for (const poam of upcomingDeadlines) {\n    await sendNotification({\n      type: 'DEADLINE_APPROACHING',\n      poam,\n      daysRemaining: getDaysUntilDeadline(poam)\n    });\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#4-document-risk-acceptance",
      "title": "4. Document Risk Acceptance",
      "text": "<p>When accepting risk, provide detailed justification:</p> <pre><code>await updatePOAM(poamId, {\n  status: 'RISK_ACCEPTED',\n  riskAcceptance: {\n    reason: 'Component is internal-only and not exposed to internet',\n    mitigatingControls: [\n      'Network segmentation',\n      'Access control lists',\n      'Monitoring and alerting'\n    ],\n    approvedBy: 'CISO',\n    approvalDate: new Date(),\n    expirationDate: addMonths(new Date(), 6)\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/poam/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Compliance Mapping - Learn about NIST control mapping</li> <li>Managing POA&amp;Ms Guide - Detailed POA&amp;M management</li> <li>Compliance Reports Guide - Generate audit reports</li> </ul>"
    },
    {
      "location": "core-concepts/sbom/",
      "title": "SBOM Processing",
      "text": "<p>Software Bill of Materials (SBOM) processing is a core capability of Aegis, enabling comprehensive vulnerability tracking and compliance reporting.</p>"
    },
    {
      "location": "core-concepts/sbom/#what-is-an-sbom",
      "title": "What is an SBOM?",
      "text": "<p>A Software Bill of Materials (SBOM) is a comprehensive inventory of all software components, libraries, and dependencies in an application or container image.</p> <p>SBOMs provide:</p> <ul> <li>Transparency: Complete visibility into third-party code</li> <li>Security: Enables vulnerability tracking across dependencies</li> <li>Compliance: Required by Executive Order 14028 and FedRAMP</li> <li>License Management: Track open-source licenses</li> </ul>"
    },
    {
      "location": "core-concepts/sbom/#supported-formats",
      "title": "Supported Formats",
      "text": "<p>Aegis supports industry-standard SBOM formats:</p>"
    },
    {
      "location": "core-concepts/sbom/#spdx-23-recommended",
      "title": "SPDX 2.3 (Recommended)",
      "text": "<p>The Software Package Data Exchange (SPDX) format is an ISO/IEC standard:</p> <pre><code>{\n  \"spdxVersion\": \"SPDX-2.3\",\n  \"dataLicense\": \"CC0-1.0\",\n  \"SPDXID\": \"SPDXRef-DOCUMENT\",\n  \"name\": \"aegis-api\",\n  \"documentNamespace\": \"https://aegis.dev/sbom/aegis-api-v0.1.0\",\n  \"packages\": [\n    {\n      \"SPDXID\": \"SPDXRef-Package-express\",\n      \"name\": \"express\",\n      \"versionInfo\": \"4.18.2\",\n      \"supplier\": \"Organization: OpenJS Foundation\",\n      \"downloadLocation\": \"https://registry.npmjs.org/express/-/express-4.18.2.tgz\",\n      \"filesAnalyzed\": false,\n      \"licenseConcluded\": \"MIT\",\n      \"externalRefs\": [\n        {\n          \"referenceCategory\": \"PACKAGE-MANAGER\",\n          \"referenceType\": \"purl\",\n          \"referenceLocator\": \"pkg:npm/express@4.18.2\"\n        }\n      ]\n    }\n  ],\n  \"relationships\": [\n    {\n      \"spdxElementId\": \"SPDXRef-DOCUMENT\",\n      \"relationshipType\": \"DESCRIBES\",\n      \"relatedSpdxElement\": \"SPDXRef-Package-express\"\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#cyclonedx-14",
      "title": "CycloneDX 1.4",
      "text": "<p>The CycloneDX format is lightweight and purpose-built for security:</p> <pre><code>{\n  \"bomFormat\": \"CycloneDX\",\n  \"specVersion\": \"1.4\",\n  \"serialNumber\": \"urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79\",\n  \"version\": 1,\n  \"metadata\": {\n    \"timestamp\": \"2025-12-16T15:30:00Z\",\n    \"component\": {\n      \"type\": \"application\",\n      \"name\": \"aegis-api\",\n      \"version\": \"0.1.0\"\n    }\n  },\n  \"components\": [\n    {\n      \"type\": \"library\",\n      \"name\": \"express\",\n      \"version\": \"4.18.2\",\n      \"purl\": \"pkg:npm/express@4.18.2\",\n      \"licenses\": [{ \"license\": { \"id\": \"MIT\" } }]\n    }\n  ]\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#syft-json",
      "title": "Syft JSON",
      "text": "<p>Aegis also accepts Syft's native JSON format:</p> <pre><code>syft . -o json &gt; sbom.syft.json\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#sbom-parsing-workflow",
      "title": "SBOM Parsing Workflow",
      "text": "<pre><code>Upload SBOM\n     \u2502\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Detect Format    \u2502\n\u2502 - SPDX 2.3       \u2502\n\u2502 - CycloneDX 1.4  \u2502\n\u2502 - Syft JSON      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Extract          \u2502\n\u2502 Components       \u2502\n\u2502 - Name           \u2502\n\u2502 - Version        \u2502\n\u2502 - PURL           \u2502\n\u2502 - License        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Normalize        \u2502\n\u2502 - Resolve deps   \u2502\n\u2502 - Deduplicate    \u2502\n\u2502 - Generate IDs   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Store in DB      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Queue Vuln Scan  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#component-entity",
      "title": "Component Entity",
      "text": "<p>Extracted components are stored in the database:</p> <pre><code>@Entity()\nexport class Component {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  tenantId: string;\n\n  @Column()\n  evidenceId: string;\n\n  @Column()\n  name: string;\n\n  @Column()\n  version: string;\n\n  @Column({ nullable: true })\n  purl: string; // Package URL (e.g., pkg:npm/express@4.18.2)\n\n  @Column({ nullable: true })\n  license: string;\n\n  @Column({ nullable: true })\n  supplier: string;\n\n  @Column({ type: 'jsonb', nullable: true })\n  metadata: Record&lt;string, any&gt;;\n\n  @OneToMany(() =&gt; Vulnerability, vuln =&gt; vuln.component)\n  vulnerabilities: Vulnerability[];\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#package-url-purl",
      "title": "Package URL (PURL)",
      "text": "<p>Aegis uses Package URLs (PURLs) to uniquely identify components:</p> <pre><code>pkg:npm/express@4.18.2\npkg:pypi/django@4.2.7\npkg:maven/org.springframework/spring-core@6.1.0\npkg:docker/alpine@3.18\npkg:golang/github.com/gin-gonic/gin@v1.9.1\n</code></pre> <p>PURLs enable:</p> <ul> <li>Universal component identification</li> <li>Cross-ecosystem vulnerability matching</li> <li>Dependency graph construction</li> </ul>"
    },
    {
      "location": "core-concepts/sbom/#sbom-parser-worker",
      "title": "SBOM Parser Worker",
      "text": "<p>The SBOM Parser Worker processes uploaded files:</p> <pre><code>export class SBOMParserWorker {\n  async process(job: Job&lt;SBOMParseJob&gt;) {\n    const { evidenceId, blobUrl, format } = job.data;\n\n    // 1. Download SBOM from blob storage\n    const sbomContent = await this.downloadBlob(blobUrl);\n\n    // 2. Detect format if not specified\n    const detectedFormat = format || this.detectFormat(sbomContent);\n\n    // 3. Parse based on format\n    let components: Component[];\n    switch (detectedFormat) {\n      case 'spdx-2.3':\n        components = await this.parseSPDX(sbomContent);\n        break;\n      case 'cyclonedx-1.4':\n        components = await this.parseCycloneDX(sbomContent);\n        break;\n      case 'syft-json':\n        components = await this.parseSyft(sbomContent);\n        break;\n      default:\n        throw new Error(`Unsupported format: ${detectedFormat}`);\n    }\n\n    // 4. Normalize and deduplicate\n    const normalized = this.normalizeComponents(components);\n\n    // 5. Store in database\n    await this.storeComponents(evidenceId, normalized);\n\n    // 6. Queue vulnerability scanning\n    await this.queueVulnerabilityScan(evidenceId, normalized);\n\n    return { componentsProcessed: normalized.length };\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#generating-sboms",
      "title": "Generating SBOMs",
      "text": ""
    },
    {
      "location": "core-concepts/sbom/#using-syft",
      "title": "Using Syft",
      "text": "<p>Syft generates SBOMs for containers and filesystems:</p> <pre><code># Generate SPDX SBOM for container image\nsyft aegis-api:latest -o spdx-json &gt; sbom.spdx.json\n\n# Generate CycloneDX SBOM\nsyft aegis-api:latest -o cyclonedx-json &gt; sbom.cyclonedx.json\n\n# Scan local directory\nsyft dir:. -o spdx-json &gt; sbom.spdx.json\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#using-trivy",
      "title": "Using Trivy",
      "text": "<p>Trivy can also generate SBOMs:</p> <pre><code># Generate SPDX SBOM\ntrivy image --format spdx-json -o sbom.spdx.json aegis-api:latest\n\n# Generate CycloneDX SBOM\ntrivy image --format cyclonedx -o sbom.cyclonedx.json aegis-api:latest\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#using-npm",
      "title": "Using NPM",
      "text": "<p>For Node.js projects:</p> <pre><code># Install SBOM generator\nnpm install -g @cyclonedx/cyclonedx-npm\n\n# Generate CycloneDX SBOM\ncyclonedx-npm --output-file sbom.cyclonedx.json\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#using-maven",
      "title": "Using Maven",
      "text": "<p>For Java projects:</p> <pre><code>&lt;!-- Add to pom.xml --&gt;\n&lt;plugin&gt;\n  &lt;groupId&gt;org.cyclonedx&lt;/groupId&gt;\n  &lt;artifactId&gt;cyclonedx-maven-plugin&lt;/artifactId&gt;\n  &lt;version&gt;2.7.9&lt;/version&gt;\n  &lt;executions&gt;\n    &lt;execution&gt;\n      &lt;phase&gt;package&lt;/phase&gt;\n      &lt;goals&gt;\n        &lt;goal&gt;makeAggregateBom&lt;/goal&gt;\n      &lt;/goals&gt;\n    &lt;/execution&gt;\n  &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre> <pre><code>mvn package\n# SBOM generated at target/bom.json\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#sbom-quality",
      "title": "SBOM Quality",
      "text": "<p>Aegis evaluates SBOM quality based on:</p> <ul> <li>Completeness: All components documented</li> <li>Accuracy: Correct versions and licenses</li> <li>Depth: Transitive dependencies included</li> <li>Freshness: SBOM timestamp vs. build time</li> <li>Format Compliance: Valid SPDX/CycloneDX schema</li> </ul> <p>Quality score displayed in dashboard:</p> <pre><code>SBOM Quality: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591 80%\n\n\u2705 All components have versions\n\u2705 PURLs present for 95% of components\n\u26a0\ufe0f  Missing licenses for 5% of components\n\u2705 Transitive dependencies included\n\u2705 SBOM timestamp within 24 hours of build\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#sbom-comparison",
      "title": "SBOM Comparison",
      "text": "<p>Compare SBOMs across builds to track changes:</p> <pre><code>query CompareSBOMs($evidenceId1: ID!, $evidenceId2: ID!) {\n  compareSBOMs(evidenceId1: $evidenceId1, evidenceId2: $evidenceId2) {\n    added {\n      name\n      version\n    }\n    removed {\n      name\n      version\n    }\n    updated {\n      name\n      oldVersion\n      newVersion\n    }\n  }\n}\n</code></pre> <p>Example output:</p> <pre><code>Components Added (3):\n  + express@4.19.0\n  + @types/node@20.10.0\n  + zod@3.22.4\n\nComponents Removed (1):\n  - lodash@4.17.20\n\nComponents Updated (2):\n  ~ typescript: 5.2.2 \u2192 5.3.3\n  ~ react: 18.2.0 \u2192 18.3.1\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#best-practices",
      "title": "Best Practices",
      "text": ""
    },
    {
      "location": "core-concepts/sbom/#1-generate-sboms-automatically",
      "title": "1. Generate SBOMs Automatically",
      "text": "<p>Integrate SBOM generation into CI/CD:</p> <pre><code>- name: Generate SBOM\n  run: syft . -o spdx-json &gt; sbom.spdx.json\n\n- name: Upload to Aegis\n  run: |\n    curl -X POST $AEGIS_API_URL/api/evidence \\\n      -F \"file=@sbom.spdx.json\" \\\n      -F \"projectId=$PROJECT_ID\"\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#2-version-sboms-with-builds",
      "title": "2. Version SBOMs with Builds",
      "text": "<p>Tag SBOMs with build numbers:</p> <pre><code>{\n  \"name\": \"aegis-api-build-1234\",\n  \"metadata\": {\n    \"buildId\": \"1234\",\n    \"commit\": \"abc123\",\n    \"timestamp\": \"2025-12-16T15:30:00Z\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#3-include-transitive-dependencies",
      "title": "3. Include Transitive Dependencies",
      "text": "<p>Ensure all dependencies (direct and transitive) are captured:</p> <pre><code># Syft includes transitive deps by default\nsyft . -o spdx-json\n\n# NPM - include dev dependencies\nnpm ls --all --json &gt; deps.json\n</code></pre>"
    },
    {
      "location": "core-concepts/sbom/#4-update-sboms-regularly",
      "title": "4. Update SBOMs Regularly",
      "text": "<p>Regenerate SBOMs:</p> <ul> <li>On every production build</li> <li>After dependency updates</li> <li>Monthly for long-running services</li> </ul>"
    },
    {
      "location": "core-concepts/sbom/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Vulnerability Scanning - Learn how components are scanned</li> <li>Evidence Ingestion - Understand evidence upload</li> <li>Upload Evidence Guide - Step-by-step upload instructions</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/",
      "title": "Vulnerability Scanning",
      "text": "<p>Aegis automatically scans software components for known vulnerabilities, providing real-time security insights and compliance reporting.</p>"
    },
    {
      "location": "core-concepts/vulnerabilities/#overview",
      "title": "Overview",
      "text": "<p>The Vulnerability Indexer matches software components from SBOMs against vulnerability databases to identify security issues.</p> <pre><code>SBOM Components\n     \u2502\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Query CVE DBs    \u2502\n\u2502 - NVD            \u2502\n\u2502 - OSV            \u2502\n\u2502 - GitHub         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Match &amp; Score    \u2502\n\u2502 - CVE ID         \u2502\n\u2502 - CVSS Score     \u2502\n\u2502 - Severity       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Store Vulns      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Generate POA&amp;Ms  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#vulnerability-sources",
      "title": "Vulnerability Sources",
      "text": "<p>Aegis queries multiple authoritative vulnerability databases:</p>"
    },
    {
      "location": "core-concepts/vulnerabilities/#national-vulnerability-database-nvd",
      "title": "National Vulnerability Database (NVD)",
      "text": "<ul> <li>Maintainer: NIST</li> <li>Coverage: Cross-ecosystem (all languages/platforms)</li> <li>Update Frequency: Real-time</li> <li>CVSS Scoring: CVSS 2.0, 3.0, 3.1</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#open-source-vulnerabilities-osv",
      "title": "Open Source Vulnerabilities (OSV)",
      "text": "<ul> <li>Maintainer: Google</li> <li>Coverage: Open-source ecosystems</li> <li>Update Frequency: Real-time</li> <li>Format: Standardized JSON</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#github-advisory-database",
      "title": "GitHub Advisory Database",
      "text": "<ul> <li>Maintainer: GitHub</li> <li>Coverage: npm, PyPI, Maven, NuGet, RubyGems</li> <li>Update Frequency: Real-time</li> <li>Integration: Native GitHub Security Advisories</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#vulnerability-entity",
      "title": "Vulnerability Entity",
      "text": "<p>Vulnerabilities are stored with complete metadata:</p> <pre><code>@Entity()\nexport class Vulnerability {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n\n  @Column()\n  tenantId: string;\n\n  @Column()\n  evidenceId: string;\n\n  @Column()\n  componentId: string;\n\n  @Column()\n  cveId: string; // e.g., CVE-2024-47076\n\n  @Column()\n  severity: VulnerabilitySeverity; // CRITICAL, HIGH, MEDIUM, LOW, NONE\n\n  @Column({ type: 'decimal', precision: 3, scale: 1 })\n  cvssScore: number; // 0.0 - 10.0\n\n  @Column({ nullable: true })\n  cvssVector: string; // e.g., CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\n\n  @Column('text')\n  description: string;\n\n  @Column({ type: 'jsonb', nullable: true })\n  references: string[]; // URLs to advisories\n\n  @Column({ type: 'date', nullable: true })\n  publishedAt: Date;\n\n  @Column({ type: 'date', nullable: true })\n  modifiedAt: Date;\n\n  @Column({ default: false })\n  exploitAvailable: boolean;\n\n  @Column({ nullable: true })\n  fixedVersion: string; // Version that fixes the vulnerability\n\n  @ManyToOne(() =&gt; Component, component =&gt; component.vulnerabilities)\n  component: Component;\n\n  @OneToOne(() =&gt; POAM, poam =&gt; poam.vulnerability)\n  poam: POAM;\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#severity-levels",
      "title": "Severity Levels",
      "text": "<p>Aegis uses CVSS 3.1 scores to classify vulnerabilities:</p> Severity CVSS Score Color FedRAMP Deadline CRITICAL 9.0 - 10.0 \ud83d\udd34 Red 30 days HIGH 7.0 - 8.9 \ud83d\udfe0 Orange 90 days MEDIUM 4.0 - 6.9 \ud83d\udfe1 Yellow 180 days LOW 0.1 - 3.9 \u26aa Gray No deadline NONE 0.0 \u26aa Gray N/A"
    },
    {
      "location": "core-concepts/vulnerabilities/#cvss-scoring",
      "title": "CVSS Scoring",
      "text": "<p>The Common Vulnerability Scoring System (CVSS) provides a standardized vulnerability assessment:</p>"
    },
    {
      "location": "core-concepts/vulnerabilities/#cvss-vector-example",
      "title": "CVSS Vector Example",
      "text": "<pre><code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\n</code></pre> <p>Breakdown:</p> <ul> <li>AV:N - Attack Vector: Network</li> <li>AC:L - Attack Complexity: Low</li> <li>PR:N - Privileges Required: None</li> <li>UI:N - User Interaction: None</li> <li>S:U - Scope: Unchanged</li> <li>C:H - Confidentiality Impact: High</li> <li>I:H - Integrity Impact: High</li> <li>A:H - Availability Impact: High</li> </ul> <p>Score: 9.8 (Critical)</p>"
    },
    {
      "location": "core-concepts/vulnerabilities/#vulnerability-indexer-worker",
      "title": "Vulnerability Indexer Worker",
      "text": "<p>The worker scans components for vulnerabilities:</p> <pre><code>export class VulnerabilityIndexerWorker {\n  async process(job: Job&lt;VulnerabilityScanJob&gt;) {\n    const { evidenceId, components } = job.data;\n\n    const vulnerabilities: Vulnerability[] = [];\n\n    for (const component of components) {\n      // Query multiple databases\n      const nvdVulns = await this.queryNVD(component.purl);\n      const osvVulns = await this.queryOSV(component.purl);\n      const ghVulns = await this.queryGitHubAdvisory(component.purl);\n\n      // Merge and deduplicate\n      const allVulns = this.mergeVulnerabilities([\n        ...nvdVulns,\n        ...osvVulns,\n        ...ghVulns\n      ]);\n\n      // Filter to applicable versions\n      const applicableVulns = this.filterByVersion(\n        allVulns,\n        component.version\n      );\n\n      vulnerabilities.push(...applicableVulns);\n    }\n\n    // Store vulnerabilities\n    await this.storeVulnerabilities(evidenceId, vulnerabilities);\n\n    // Queue POA&amp;M generation for Critical and High\n    const criticalAndHigh = vulnerabilities.filter(\n      v =&gt; v.severity === 'CRITICAL' || v.severity === 'HIGH'\n    );\n\n    if (criticalAndHigh.length &gt; 0) {\n      await this.queuePOAMGeneration(evidenceId, criticalAndHigh);\n    }\n\n    return {\n      vulnerabilitiesFound: vulnerabilities.length,\n      critical: vulnerabilities.filter(v =&gt; v.severity === 'CRITICAL').length,\n      high: vulnerabilities.filter(v =&gt; v.severity === 'HIGH').length\n    };\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#vulnerability-matching",
      "title": "Vulnerability Matching",
      "text": "<p>Aegis uses multiple strategies to match components to vulnerabilities:</p>"
    },
    {
      "location": "core-concepts/vulnerabilities/#1-package-url-purl-matching",
      "title": "1. Package URL (PURL) Matching",
      "text": "<pre><code>// Match by PURL\nconst purl = 'pkg:npm/express@4.17.1';\nconst vulns = await db.query(\n  'SELECT * FROM vulnerabilities WHERE affected_packages @&gt; $1',\n  [purl]\n);\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#2-cpe-matching",
      "title": "2. CPE Matching",
      "text": "<p>For system packages:</p> <pre><code>// Match by CPE (Common Platform Enumeration)\nconst cpe = 'cpe:2.3:a:nodejs:node.js:18.12.0:*:*:*:*:*:*:*';\nconst vulns = await cveDatabase.findByCPE(cpe);\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#3-version-range-matching",
      "title": "3. Version Range Matching",
      "text": "<pre><code>// Check if component version falls within vulnerable range\nfunction isVulnerable(componentVersion: string, vulnRange: string): boolean {\n  // Example: vulnRange = \"&gt;=4.0.0, &lt;4.17.3\"\n  return semver.satisfies(componentVersion, vulnRange);\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#exploit-detection",
      "title": "Exploit Detection",
      "text": "<p>Aegis flags vulnerabilities with known exploits:</p> <pre><code>@Column({ default: false })\nexploitAvailable: boolean;\n\n@Column({ type: 'jsonb', nullable: true })\nexploitMetadata: {\n  exploitDB?: string;      // ExploitDB ID\n  metasploit?: string;     // Metasploit module\n  nuclei?: string;         // Nuclei template\n  references?: string[];   // PoC URLs\n};\n</code></pre> <p>Sources:</p> <ul> <li>ExploitDB: Public exploit database</li> <li>Metasploit: Penetration testing framework</li> <li>Nuclei Templates: Vulnerability scanning templates</li> <li>CISA KEV: Known Exploited Vulnerabilities catalog</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#false-positive-handling",
      "title": "False Positive Handling",
      "text": "<p>Mark vulnerabilities as false positives:</p> <pre><code>mutation MarkFalsePositive($id: ID!, $reason: String!) {\n  markVulnerabilityFalsePositive(id: $id, reason: $reason) {\n    id\n    falsePositive\n    falsePositiveReason\n    falsePositiveMarkedBy\n    falsePositiveMarkedAt\n  }\n}\n</code></pre> <p>False positive reasons:</p> <ul> <li>Not applicable: Component not actually used</li> <li>Mitigated: Compensating controls in place</li> <li>Configuration: Vulnerable feature disabled</li> <li>Environment: Not exposed in deployment environment</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#vulnerability-dashboard",
      "title": "Vulnerability Dashboard",
      "text": "<p>Query vulnerability metrics:</p> <pre><code>query VulnerabilityMetrics($projectId: ID!, $timeRange: TimeRange!) {\n  project(id: $projectId) {\n    vulnerabilityMetrics(timeRange: $timeRange) {\n      total\n      critical\n      high\n      medium\n      low\n      trend {\n        date\n        count\n      }\n      topVulnerabilities {\n        cveId\n        severity\n        cvssScore\n        affectedComponentsCount\n      }\n    }\n  }\n}\n</code></pre> <p>Dashboard displays:</p> <ul> <li>Severity Distribution: Pie chart of Critical/High/Medium/Low</li> <li>Trend Over Time: Line graph showing vulnerability count by date</li> <li>Top CVEs: Table of most prevalent vulnerabilities</li> <li>Remediation Status: Progress toward fixing issues</li> <li>POA&amp;M Deadlines: Upcoming FedRAMP compliance deadlines</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#remediation-guidance",
      "title": "Remediation Guidance",
      "text": "<p>Aegis provides remediation recommendations:</p> <pre><code>{\n  \"cveId\": \"CVE-2024-47076\",\n  \"component\": {\n    \"name\": \"express\",\n    \"currentVersion\": \"4.17.1\",\n    \"fixedVersion\": \"4.18.2\"\n  },\n  \"remediation\": {\n    \"action\": \"UPDATE\",\n    \"recommendation\": \"Update express to version 4.18.2 or later\",\n    \"commands\": [\n      \"npm install express@4.18.2\",\n      \"npm update express\"\n    ],\n    \"breakingChanges\": false,\n    \"estimatedEffort\": \"LOW\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#continuous-monitoring",
      "title": "Continuous Monitoring",
      "text": "<p>Aegis monitors for new vulnerabilities affecting existing components:</p> <pre><code>// Daily job to check for new CVEs\ncron.schedule('0 2 * * *', async () =&gt; {\n  const activeComponents = await getActiveComponents();\n\n  for (const component of activeComponents) {\n    const newVulns = await checkForNewVulnerabilities(component);\n\n    if (newVulns.length &gt; 0) {\n      await sendNotification({\n        type: 'NEW_VULNERABILITY',\n        component: component.name,\n        vulnerabilities: newVulns\n      });\n\n      await generatePOAMs(newVulns);\n    }\n  }\n});\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#notifications",
      "title": "Notifications",
      "text": "<p>Configure alerts for new vulnerabilities:</p> <ul> <li>Email: Send to security team</li> <li>Slack: Post to #security channel</li> <li>Webhook: HTTP POST to external system</li> <li>PagerDuty: Page on-call engineer (Critical only)</li> </ul>"
    },
    {
      "location": "core-concepts/vulnerabilities/#best-practices",
      "title": "Best Practices",
      "text": ""
    },
    {
      "location": "core-concepts/vulnerabilities/#1-scan-on-every-build",
      "title": "1. Scan on Every Build",
      "text": "<p>Integrate scanning into CI/CD:</p> <pre><code>- name: Generate SBOM\n  run: syft . -o spdx-json &gt; sbom.spdx.json\n\n- name: Upload to Aegis\n  run: |\n    curl -X POST $AEGIS_API_URL/api/evidence \\\n      -F \"file=@sbom.spdx.json\"\n\n- name: Check for Critical Vulnerabilities\n  run: |\n    CRITICAL_COUNT=$(curl -s $AEGIS_API_URL/api/evidence/$EVIDENCE_ID/vulnerabilities?severity=CRITICAL | jq '.count')\n    if [ $CRITICAL_COUNT -gt 0 ]; then\n      echo \"Critical vulnerabilities found. Failing build.\"\n      exit 1\n    fi\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#2-prioritize-by-exploitability",
      "title": "2. Prioritize by Exploitability",
      "text": "<p>Focus on vulnerabilities with known exploits:</p> <pre><code>SELECT * FROM vulnerabilities\nWHERE severity IN ('CRITICAL', 'HIGH')\n  AND exploit_available = true\nORDER BY cvss_score DESC;\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#3-track-remediation-progress",
      "title": "3. Track Remediation Progress",
      "text": "<p>Monitor fix rate:</p> <pre><code>query RemediationMetrics {\n  vulnerabilityMetrics {\n    total\n    fixed\n    inProgress\n    open\n    falsePositives\n    fixRate\n    meanTimeToRemediate\n  }\n}\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#4-automate-dependency-updates",
      "title": "4. Automate Dependency Updates",
      "text": "<p>Use tools like Dependabot or Renovate to automatically update dependencies:</p> <pre><code># .github/dependabot.yml\nversion: 2\nupdates:\n  - package-ecosystem: \"npm\"\n    directory: \"/\"\n    schedule:\n      interval: \"weekly\"\n    open-pull-requests-limit: 10\n</code></pre>"
    },
    {
      "location": "core-concepts/vulnerabilities/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>POA&amp;M Generation - Learn about automated remediation planning</li> <li>Compliance Mapping - Understand NIST control mapping</li> <li>Managing POA&amp;Ms Guide - Track remediation efforts</li> </ul>"
    },
    {
      "location": "deployment/azure/",
      "title": "Azure Deployment",
      "text": "<p>Deploy Aegis to Azure Government Cloud with FedRAMP Moderate authorization.</p>"
    },
    {
      "location": "deployment/azure/#architecture",
      "title": "Architecture",
      "text": "<pre><code>Azure Government Cloud\n\u2502\n\u251c\u2500\u2500 Azure App Service (Linux)\n\u2502   \u251c\u2500\u2500 API Container\n\u2502   \u251c\u2500\u2500 Web Container\n\u2502   \u2514\u2500\u2500 Worker Container\n\u2502\n\u251c\u2500\u2500 Azure Database for PostgreSQL (Flexible Server)\n\u2502\n\u251c\u2500\u2500 Azure Redis Cache\n\u2502\n\u251c\u2500\u2500 Azure Blob Storage\n\u2502\n\u251c\u2500\u2500 Azure Key Vault\n\u2502\n\u2514\u2500\u2500 Azure Application Insights\n</code></pre>"
    },
    {
      "location": "deployment/azure/#prerequisites",
      "title": "Prerequisites",
      "text": "<ul> <li>Azure Government Cloud subscription</li> <li>Azure CLI with Gov Cloud configuration</li> <li>Terraform 1.5+</li> <li>Docker</li> </ul>"
    },
    {
      "location": "deployment/azure/#infrastructure-setup",
      "title": "Infrastructure Setup",
      "text": ""
    },
    {
      "location": "deployment/azure/#1-configure-azure-cli",
      "title": "1. Configure Azure CLI",
      "text": "<pre><code># Login to Azure Government\naz cloud set --name AzureUSGovernment\naz login\n</code></pre>"
    },
    {
      "location": "deployment/azure/#2-deploy-infrastructure-with-terraform",
      "title": "2. Deploy Infrastructure with Terraform",
      "text": "<pre><code>cd infrastructure/terraform\n\n# Initialize Terraform\nterraform init\n\n# Review plan\nterraform plan \\\n  -var=\"environment=production\" \\\n  -var=\"location=usgovvirginia\" \\\n  -var=\"subscription_id=$AZURE_SUBSCRIPTION_ID\"\n\n# Apply infrastructure\nterraform apply\n</code></pre>"
    },
    {
      "location": "deployment/azure/#3-configure-environment-variables",
      "title": "3. Configure Environment Variables",
      "text": "<pre><code># Store secrets in Azure Key Vault\naz keyvault secret set \\\n  --vault-name aegis-vault-prod \\\n  --name DATABASE-URL \\\n  --value \"postgresql://...\"\n\naz keyvault secret set \\\n  --vault-name aegis-vault-prod \\\n  --name JWT-SECRET \\\n  --value \"...\"\n</code></pre>"
    },
    {
      "location": "deployment/azure/#4-deploy-containers",
      "title": "4. Deploy Containers",
      "text": "<pre><code># Build and push containers\naz acr build \\\n  --registry aegisacr \\\n  --image aegis-api:latest \\\n  --file packages/api/Dockerfile .\n\n# Deploy to App Service\naz webapp config container set \\\n  --name aegis-api-prod \\\n  --resource-group aegis-rg-prod \\\n  --docker-custom-image-name aegisacr.azurecr.io/aegis-api:latest\n</code></pre>"
    },
    {
      "location": "deployment/azure/#monitoring",
      "title": "Monitoring",
      "text": "<p>Configure Application Insights for monitoring:</p> <pre><code>az monitor app-insights component create \\\n  --app aegis-insights \\\n  --location usgovvirginia \\\n  --resource-group aegis-rg-prod\n</code></pre> <p>For complete deployment instructions, see the Environment Configuration Guide.</p>"
    },
    {
      "location": "deployment/configuration/",
      "title": "Configuration",
      "text": "<p>Configure Aegis for your environment.</p>"
    },
    {
      "location": "deployment/configuration/#environment-variables",
      "title": "Environment Variables",
      "text": ""
    },
    {
      "location": "deployment/configuration/#api-server",
      "title": "API Server",
      "text": "<pre><code># Server\nNODE_ENV=production\nPORT=3001\nLOG_LEVEL=info\n\n# Database\nDATABASE_URL=postgresql://user:pass@host:5432/aegis\nDATABASE_SSL=true\nDATABASE_POOL_SIZE=20\n\n# Redis\nREDIS_URL=redis://host:6379\nREDIS_TLS=true\n\n# Azure Storage\nAZURE_STORAGE_CONNECTION_STRING=...\nAZURE_STORAGE_CONTAINER=evidence\n\n# Authentication\nJWT_SECRET=your-secret-key\nJWT_EXPIRATION=24h\n\n# Queue\nQUEUE_CONCURRENCY=5\nQUEUE_RETRY_ATTEMPTS=3\n</code></pre>"
    },
    {
      "location": "deployment/configuration/#web-frontend",
      "title": "Web Frontend",
      "text": "<pre><code>VITE_API_URL=https://api.aegis.gov\nVITE_GRAPHQL_URL=https://api.aegis.gov/graphql\n</code></pre>"
    },
    {
      "location": "deployment/configuration/#configuration-files",
      "title": "Configuration Files",
      "text": "<p>See the Environment Variables Guide for detailed configuration options.</p>"
    },
    {
      "location": "deployment/environment/",
      "title": "Environment Variables",
      "text": "<p>Complete reference for all environment variables.</p>"
    },
    {
      "location": "deployment/environment/#api-server-variables",
      "title": "API Server Variables",
      "text": "Variable Required Default Description <code>NODE_ENV</code> Yes - Environment: <code>development</code>, <code>production</code> <code>PORT</code> No 3001 API server port <code>LOG_LEVEL</code> No info Logging level: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code> <code>DATABASE_URL</code> Yes - PostgreSQL connection string <code>DATABASE_SSL</code> No false Enable SSL for database connection <code>REDIS_URL</code> Yes - Redis connection string <code>AZURE_STORAGE_CONNECTION_STRING</code> Yes - Azure Blob Storage connection string <code>JWT_SECRET</code> Yes - Secret key for JWT signing <code>JWT_EXPIRATION</code> No 24h JWT token expiration time"
    },
    {
      "location": "deployment/environment/#web-frontend-variables",
      "title": "Web Frontend Variables",
      "text": "Variable Required Default Description <code>VITE_API_URL</code> Yes - API server URL <code>VITE_GRAPHQL_URL</code> Yes - GraphQL endpoint URL <p>For deployment-specific configuration, see the Configuration Guide.</p>"
    },
    {
      "location": "deployment/local/",
      "title": "Local Development",
      "text": "<p>Set up Aegis for local development in under 5 minutes.</p>"
    },
    {
      "location": "deployment/local/#prerequisites",
      "title": "Prerequisites",
      "text": "<ul> <li>Node.js 18.x or higher</li> <li>Docker and Docker Compose</li> <li>Git</li> <li>npm or pnpm</li> </ul>"
    },
    {
      "location": "deployment/local/#quick-start",
      "title": "Quick Start",
      "text": "<pre><code># Clone repository\ngit clone https://github.com/cloudcwfranck/aegis.git\ncd aegis\n\n# Install dependencies\nnpm install\n\n# Start infrastructure (PostgreSQL, Redis, Azurite)\ndocker-compose up -d\n\n# Run database migrations\nnpm run migrate\n\n# Start development servers\nnpm run dev\n</code></pre> <p>Access the application:</p> <ul> <li>Web UI: http://localhost:5173</li> <li>API: http://localhost:3001</li> <li>GraphQL Playground: http://localhost:3001/graphql</li> </ul> <p>For detailed setup instructions, see the Quickstart Guide.</p>"
    },
    {
      "location": "design/kms-design/",
      "title": "Key Management Service (KMS) Design",
      "text": "<p>Document Version: 1.0 Date: 2024-12-11 Status: Approved</p>"
    },
    {
      "location": "design/kms-design/#executive-summary",
      "title": "Executive Summary",
      "text": "<p>This document describes the cryptographic key management architecture for the Aegis DevSecOps Platform. The design supports multi-cloud government deployments (Azure Government, AWS GovCloud) with FIPS 140-2 validated encryption modules.</p> <p>Compliance Requirements:</p> <ul> <li>NIST 800-53 Rev 5: SC-12 (Cryptographic Key Establishment), SC-13 (Cryptographic Protection)</li> <li>FIPS 140-2 Level 2 (minimum for FedRAMP Moderate)</li> <li>FIPS 140-3 Level 3 (preferred for IL4/IL5)</li> <li>FedRAMP Rev 5 Cryptographic Module Requirements</li> </ul>"
    },
    {
      "location": "design/kms-design/#architecture-overview",
      "title": "Architecture Overview",
      "text": ""
    },
    {
      "location": "design/kms-design/#key-hierarchy",
      "title": "Key Hierarchy",
      "text": "<pre><code>Root Key (HSM-protected)\n    \u251c\u2500&gt; Database Encryption Key (DEK)\n    \u2502   \u2514\u2500&gt; PostgreSQL Transparent Data Encryption (TDE)\n    \u2502\n    \u251c\u2500&gt; Blob Storage Encryption Key (BEK)\n    \u2502   \u2514\u2500&gt; S3/Azure Blob Server-Side Encryption\n    \u2502\n    \u251c\u2500&gt; Application Secrets Key (ASK)\n    \u2502   \u251c\u2500&gt; JWT Signing Key\n    \u2502   \u251c\u2500&gt; API Tokens\n    \u2502   \u2514\u2500&gt; Service Account Credentials\n    \u2502\n    \u251c\u2500&gt; Evidence Signing Key (ESK)\n    \u2502   \u2514\u2500&gt; SBOM/POA&amp;M Document Signatures\n    \u2502\n    \u2514\u2500&gt; Backup Encryption Key (BEK)\n        \u2514\u2500&gt; Database Backup Encryption\n</code></pre>"
    },
    {
      "location": "design/kms-design/#encryption-standards",
      "title": "Encryption Standards",
      "text": "Data Type Algorithm Key Size Mode Purpose Data at rest AES-256 256-bit GCM Database, S3 objects Data in transit TLS 1.3 256-bit ECDHE HTTPS, PostgreSQL connections JWT tokens RS256 2048-bit RSA - User authentication Document signing ECDSA P-256 - SBOM/POA&amp;M integrity Password hashing Argon2id - - User passwords (if local auth)"
    },
    {
      "location": "design/kms-design/#cloud-specific-implementations",
      "title": "Cloud-Specific Implementations",
      "text": ""
    },
    {
      "location": "design/kms-design/#azure-government-azure-key-vault",
      "title": "Azure Government (Azure Key Vault)",
      "text": "<p>Architecture:</p> <pre><code>Azure Key Vault (usgovvirginia)\n    \u251c\u2500&gt; Managed HSM (FIPS 140-3 Level 3)\n    \u251c\u2500&gt; Keys\n    \u2502   \u251c\u2500&gt; aegis-prod-dek (Database Encryption Key)\n    \u2502   \u251c\u2500&gt; aegis-prod-bek (Blob Storage Encryption Key)\n    \u2502   \u2514\u2500&gt; aegis-prod-ask (Application Secrets Key)\n    \u2502\n    \u251c\u2500&gt; Secrets\n    \u2502   \u251c\u2500&gt; jwt-signing-key\n    \u2502   \u251c\u2500&gt; postgres-password\n    \u2502   \u2514\u2500&gt; redis-password\n    \u2502\n    \u2514\u2500&gt; Certificates\n        \u2514\u2500&gt; aegis-tls-cert (IL4+ DoD PKI)\n</code></pre> <p>Terraform Configuration:</p> <pre><code># Azure Key Vault (Government Cloud)\nresource \"azurerm_key_vault\" \"aegis\" {\n  name                = \"aegis-kv-prod-usgovva\"\n  location            = \"usgovvirginia\"\n  resource_group_name = azurerm_resource_group.aegis.name\n  tenant_id           = data.azurerm_client_config.current.tenant_id\n  sku_name            = \"premium\" # Required for HSM-backed keys\n\n  # NIST 800-53 AC-3: RBAC for key access\n  enable_rbac_authorization = true\n\n  # NIST 800-53 AU-2: Enable logging\n  enabled_for_deployment          = false\n  enabled_for_disk_encryption     = true\n  enabled_for_template_deployment = false\n\n  # FIPS 140-2 requirement\n  purge_protection_enabled   = true\n  soft_delete_retention_days = 90\n\n  network_acls {\n    bypass         = \"AzureServices\"\n    default_action = \"Deny\"\n\n    # Only allow access from AKS nodes\n    ip_rules = var.aks_node_public_ips\n\n    # VNet integration\n    virtual_network_subnet_ids = [\n      azurerm_subnet.aks.id\n    ]\n  }\n\n  tags = {\n    Compliance = \"NIST-800-53\"\n    FIPS       = \"140-2\"\n    Environment = \"prod-gov\"\n  }\n}\n\n# Managed HSM (FIPS 140-3 Level 3)\nresource \"azurerm_key_vault_managed_hardware_security_module\" \"aegis\" {\n  name                = \"aegis-hsm-prod\"\n  resource_group_name = azurerm_resource_group.aegis.name\n  location            = \"usgovvirginia\"\n  tenant_id           = data.azurerm_client_config.current.tenant_id\n  sku_name            = \"Standard_B1\"\n\n  admin_object_ids = var.hsm_admin_object_ids\n\n  purge_protection_enabled   = true\n  soft_delete_retention_days = 90\n\n  tags = {\n    Compliance = \"FIPS-140-3-Level-3\"\n    Purpose    = \"Aegis-Root-Keys\"\n  }\n}\n\n# Database Encryption Key (DEK)\nresource \"azurerm_key_vault_key\" \"database_encryption\" {\n  name         = \"aegis-prod-dek\"\n  key_vault_id = azurerm_key_vault.aegis.id\n  key_type     = \"RSA-HSM\" # HSM-backed\n  key_size     = 2048\n\n  key_opts = [\n    \"encrypt\",\n    \"decrypt\",\n  ]\n\n  rotation_policy {\n    automatic {\n      time_before_expiry = \"P30D\"\n    }\n\n    expire_after         = \"P90D\"\n    notify_before_expiry = \"P29D\"\n  }\n}\n\n# Blob Storage Encryption Key (BEK)\nresource \"azurerm_key_vault_key\" \"blob_encryption\" {\n  name         = \"aegis-prod-bek\"\n  key_vault_id = azurerm_key_vault.aegis.id\n  key_type     = \"RSA-HSM\"\n  key_size     = 2048\n\n  key_opts = [\n    \"encrypt\",\n    \"decrypt\",\n    \"wrapKey\",\n    \"unwrapKey\",\n  ]\n\n  rotation_policy {\n    automatic {\n      time_before_expiry = \"P30D\"\n    }\n\n    expire_after         = \"P90D\"\n    notify_before_expiry = \"P29D\"\n  }\n}\n\n# Application Secrets Key (ASK)\nresource \"azurerm_key_vault_secret\" \"jwt_signing_key\" {\n  name         = \"jwt-signing-key\"\n  value        = random_password.jwt_key.result\n  key_vault_id = azurerm_key_vault.aegis.id\n\n  expiration_date = timeadd(timestamp(), \"2160h\") # 90 days\n\n  tags = {\n    Purpose = \"JWT-Token-Signing\"\n  }\n}\n\n# PostgreSQL Password\nresource \"azurerm_key_vault_secret\" \"postgres_password\" {\n  name         = \"postgres-password\"\n  value        = random_password.postgres.result\n  key_vault_id = azurerm_key_vault.aegis.id\n\n  tags = {\n    Purpose = \"PostgreSQL-Admin-Password\"\n  }\n}\n</code></pre> <p>AKS Integration (CSI Driver):</p> <pre><code>apiVersion: v1\nkind: SecretProviderClass\nmetadata:\n  name: aegis-secrets\n  namespace: aegis-system\nspec:\n  provider: azure\n  secretObjects:\n    - secretName: aegis-app-secrets\n      type: Opaque\n      data:\n        - objectName: jwt-signing-key\n          key: JWT_SECRET\n        - objectName: postgres-password\n          key: DB_PASSWORD\n  parameters:\n    usePodIdentity: 'false'\n    useVMManagedIdentity: 'true'\n    userAssignedIdentityID: '550e8400-e29b-41d4-a716-446655440000'\n    keyvaultName: 'aegis-kv-prod-usgovva'\n    tenantId: '12345678-1234-1234-1234-123456789012'\n    objects: |\n      array:\n        - |\n          objectName: jwt-signing-key\n          objectType: secret\n        - |\n          objectName: postgres-password\n          objectType: secret\n</code></pre>"
    },
    {
      "location": "design/kms-design/#aws-govcloud-aws-kms",
      "title": "AWS GovCloud (AWS KMS)",
      "text": "<p>Architecture:</p> <pre><code>AWS KMS (us-gov-west-1)\n    \u251c\u2500&gt; Customer Managed Keys (CMKs)\n    \u2502   \u251c\u2500&gt; alias/aegis-prod-dek (Database Encryption)\n    \u2502   \u251c\u2500&gt; alias/aegis-prod-bek (S3 Encryption)\n    \u2502   \u2514\u2500&gt; alias/aegis-prod-ask (Secrets Manager)\n    \u2502\n    \u2514\u2500&gt; AWS Secrets Manager\n        \u251c\u2500&gt; aegis/prod/jwt-signing-key\n        \u251c\u2500&gt; aegis/prod/postgres-password\n        \u2514\u2500&gt; aegis/prod/redis-password\n</code></pre> <p>Terraform Configuration:</p> <pre><code># AWS KMS Key (GovCloud)\nresource \"aws_kms_key\" \"aegis_dek\" {\n  description             = \"Aegis Database Encryption Key\"\n  deletion_window_in_days = 30\n  enable_key_rotation     = true\n\n  # FIPS 140-2 validated CloudHSM\n  custom_key_store_id = aws_cloudhsm_v2_cluster.aegis.cluster_id\n\n  tags = {\n    Name        = \"aegis-prod-dek\"\n    Compliance  = \"NIST-800-53\"\n    FIPS        = \"140-2\"\n    Environment = \"prod-gov\"\n  }\n}\n\nresource \"aws_kms_alias\" \"aegis_dek\" {\n  name          = \"alias/aegis-prod-dek\"\n  target_key_id = aws_kms_key.aegis_dek.key_id\n}\n\n# S3 Encryption Key\nresource \"aws_kms_key\" \"aegis_bek\" {\n  description             = \"Aegis S3 Blob Encryption Key\"\n  deletion_window_in_days = 30\n  enable_key_rotation     = true\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Sid    = \"Enable IAM User Permissions\"\n        Effect = \"Allow\"\n        Principal = {\n          AWS = \"arn:aws-us-gov:iam::${data.aws_caller_identity.current.account_id}:root\"\n        }\n        Action   = \"kms:*\"\n        Resource = \"*\"\n      },\n      {\n        Sid    = \"Allow S3 to use the key\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"s3.amazonaws.com\"\n        }\n        Action = [\n          \"kms:Decrypt\",\n          \"kms:GenerateDataKey\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n\n  tags = {\n    Name       = \"aegis-prod-bek\"\n    Compliance = \"NIST-800-53\"\n  }\n}\n\n# CloudHSM Cluster (FIPS 140-2 Level 3)\nresource \"aws_cloudhsm_v2_cluster\" \"aegis\" {\n  hsm_type   = \"hsm1.medium\"\n  subnet_ids = aws_subnet.private[*].id\n\n  tags = {\n    Name       = \"aegis-hsm-cluster\"\n    Compliance = \"FIPS-140-2-Level-3\"\n  }\n}\n\nresource \"aws_cloudhsm_v2_hsm\" \"aegis\" {\n  count       = 2 # High availability\n  subnet_id   = aws_subnet.private[count.index].id\n  cluster_id  = aws_cloudhsm_v2_cluster.aegis.cluster_id\n  availability_zone = data.aws_availability_zones.available.names[count.index]\n}\n\n# Secrets Manager\nresource \"aws_secretsmanager_secret\" \"jwt_key\" {\n  name                    = \"aegis/prod/jwt-signing-key\"\n  kms_key_id              = aws_kms_key.aegis_dek.arn\n  recovery_window_in_days = 30\n\n  rotation_rules {\n    automatically_after_days = 90\n  }\n\n  tags = {\n    Purpose = \"JWT-Token-Signing\"\n  }\n}\n\nresource \"aws_secretsmanager_secret_version\" \"jwt_key\" {\n  secret_id     = aws_secretsmanager_secret.jwt_key.id\n  secret_string = jsonencode({\n    key = random_password.jwt_key.result\n  })\n}\n\nresource \"aws_secretsmanager_secret\" \"postgres_password\" {\n  name                    = \"aegis/prod/postgres-password\"\n  kms_key_id              = aws_kms_key.aegis_dek.arn\n  recovery_window_in_days = 30\n\n  tags = {\n    Purpose = \"PostgreSQL-Admin-Password\"\n  }\n}\n\nresource \"aws_secretsmanager_secret_version\" \"postgres_password\" {\n  secret_id     = aws_secretsmanager_secret.postgres_password.id\n  secret_string = jsonencode({\n    password = random_password.postgres.result\n  })\n}\n</code></pre> <p>EKS Integration (Secrets Store CSI Driver):</p> <pre><code>apiVersion: secrets-store.csi.x-k8s.io/v1\nkind: SecretProviderClass\nmetadata:\n  name: aegis-secrets-aws\n  namespace: aegis-system\nspec:\n  provider: aws\n  secretObjects:\n    - secretName: aegis-app-secrets\n      type: Opaque\n      data:\n        - objectName: jwt-signing-key\n          key: JWT_SECRET\n        - objectName: postgres-password\n          key: DB_PASSWORD\n  parameters:\n    objects: |\n      - objectName: \"aegis/prod/jwt-signing-key\"\n        objectType: \"secretsmanager\"\n        jmesPath:\n          - path: key\n            objectAlias: jwt-signing-key\n      - objectName: \"aegis/prod/postgres-password\"\n        objectType: \"secretsmanager\"\n        jmesPath:\n          - path: password\n            objectAlias: postgres-password\n</code></pre>"
    },
    {
      "location": "design/kms-design/#key-rotation-strategy",
      "title": "Key Rotation Strategy",
      "text": ""
    },
    {
      "location": "design/kms-design/#automatic-rotation",
      "title": "Automatic Rotation",
      "text": "Key Type Rotation Frequency Method Downtime Database Encryption Key 90 days Azure KV / AWS KMS auto-rotation Zero (transparent) Blob Storage Key 90 days Azure KV / AWS KMS auto-rotation Zero JWT Signing Key 90 days Manual rotation with grace period Zero (dual-key period) TLS Certificates 365 days cert-manager automation Zero (rolling update) Application Secrets On-demand Manual via Terraform Requires restart"
    },
    {
      "location": "design/kms-design/#jwt-key-rotation-process",
      "title": "JWT Key Rotation Process",
      "text": "<pre><code>// Dual-key JWT verification during rotation\nexport async function verifyJWT(token: string): Promise&lt;JWTPayload&gt; {\n  const currentKey = await getSecretFromKMS('jwt-signing-key');\n  const previousKey = await getSecretFromKMS('jwt-signing-key-previous');\n\n  try {\n    // Try current key first\n    return jwt.verify(token, currentKey);\n  } catch (error) {\n    // Fallback to previous key (grace period)\n    try {\n      return jwt.verify(token, previousKey);\n    } catch (fallbackError) {\n      throw new UnauthorizedException('Invalid token');\n    }\n  }\n}\n\n// Rotation procedure (manual trigger)\nexport async function rotateJWTKey(): Promise&lt;void&gt; {\n  const currentKey = await getSecretFromKMS('jwt-signing-key');\n\n  // 1. Save current key as previous\n  await setSecretInKMS('jwt-signing-key-previous', currentKey);\n\n  // 2. Generate new key\n  const newKey = crypto.randomBytes(64).toString('hex');\n\n  // 3. Update current key\n  await setSecretInKMS('jwt-signing-key', newKey);\n\n  // 4. Notify all API instances to reload (via Redis pub/sub)\n  await redis.publish('aegis:key-rotation', { key: 'jwt-signing-key' });\n\n  // 5. Grace period: 24 hours\n  // 6. After 24 hours, delete previous key\n}\n</code></pre>"
    },
    {
      "location": "design/kms-design/#encryption-at-rest",
      "title": "Encryption at Rest",
      "text": ""
    },
    {
      "location": "design/kms-design/#postgresql-transparent-data-encryption-tde",
      "title": "PostgreSQL Transparent Data Encryption (TDE)",
      "text": "<p>Azure PostgreSQL:</p> <pre><code>resource \"azurerm_postgresql_flexible_server\" \"aegis\" {\n  name                = \"aegis-postgres-prod\"\n  location            = \"usgovvirginia\"\n  resource_group_name = azurerm_resource_group.aegis.name\n\n  sku_name   = \"GP_Standard_D4s_v3\"\n  version    = \"15\"\n  storage_mb = 65536\n\n  # Customer-managed key encryption\n  customer_managed_key {\n    key_vault_key_id                  = azurerm_key_vault_key.database_encryption.id\n    primary_user_assigned_identity_id = azurerm_user_assigned_identity.aegis.id\n  }\n\n  # FIPS 140-2 SSL enforcement\n  ssl_enforcement_enabled          = true\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n\n  backup_retention_days        = 35\n  geo_redundant_backup_enabled = true\n\n  tags = {\n    Encryption = \"Customer-Managed-Key\"\n    FIPS       = \"140-2\"\n  }\n}\n</code></pre> <p>AWS RDS PostgreSQL:</p> <pre><code>resource \"aws_db_instance\" \"aegis\" {\n  identifier     = \"aegis-postgres-prod\"\n  engine         = \"postgres\"\n  engine_version = \"15.3\"\n  instance_class = \"db.r6g.xlarge\"\n\n  allocated_storage     = 100\n  max_allocated_storage = 1000\n  storage_type          = \"gp3\"\n\n  # KMS encryption\n  storage_encrypted = true\n  kms_key_id        = aws_kms_key.aegis_dek.arn\n\n  # SSL/TLS enforcement\n  ca_cert_identifier = \"rds-ca-rsa2048-g1\"\n\n  # Backups\n  backup_retention_period = 35\n  backup_window           = \"03:00-04:00\"\n\n  # Multi-AZ for HA\n  multi_az = true\n\n  tags = {\n    Encryption = \"AWS-KMS\"\n    FIPS       = \"140-2\"\n  }\n}\n</code></pre>"
    },
    {
      "location": "design/kms-design/#access-control-audit",
      "title": "Access Control &amp; Audit",
      "text": ""
    },
    {
      "location": "design/kms-design/#rbac-for-key-access",
      "title": "RBAC for Key Access",
      "text": "<p>Azure RBAC Roles:</p> <pre><code># Grant AKS cluster access to Key Vault\nresource \"azurerm_role_assignment\" \"aks_kv_secrets_user\" {\n  scope                = azurerm_key_vault.aegis.id\n  role_definition_name = \"Key Vault Secrets User\"\n  principal_id         = azurerm_kubernetes_cluster.aegis.kubelet_identity[0].object_id\n}\n\nresource \"azurerm_role_assignment\" \"aks_kv_crypto_user\" {\n  scope                = azurerm_key_vault.aegis.id\n  role_definition_name = \"Key Vault Crypto User\"\n  principal_id         = azurerm_kubernetes_cluster.aegis.kubelet_identity[0].object_id\n}\n</code></pre> <p>AWS IAM Policy:</p> <pre><code>resource \"aws_iam_policy\" \"eks_kms_policy\" {\n  name = \"aegis-eks-kms-policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"kms:Decrypt\",\n          \"kms:DescribeKey\"\n        ]\n        Resource = [\n          aws_kms_key.aegis_dek.arn,\n          aws_kms_key.aegis_bek.arn\n        ]\n      },\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"secretsmanager:GetSecretValue\",\n          \"secretsmanager:DescribeSecret\"\n        ]\n        Resource = [\n          aws_secretsmanager_secret.jwt_key.arn,\n          aws_secretsmanager_secret.postgres_password.arn\n        ]\n      }\n    ]\n  })\n}\n</code></pre>"
    },
    {
      "location": "design/kms-design/#audit-logging-nist-800-53-au-2",
      "title": "Audit Logging (NIST 800-53 AU-2)",
      "text": "<p>Azure Monitor:</p> <ul> <li>All Key Vault access logged to Log Analytics</li> <li>Alerts on key access from unknown IPs</li> <li>90-day retention minimum (365 days for prod)</li> </ul> <p>AWS CloudTrail:</p> <ul> <li>All KMS API calls logged to CloudWatch</li> <li>Alerts on key deletion attempts</li> <li>90-day retention in S3-Gov</li> </ul>"
    },
    {
      "location": "design/kms-design/#disaster-recovery",
      "title": "Disaster Recovery",
      "text": ""
    },
    {
      "location": "design/kms-design/#key-backup-strategy",
      "title": "Key Backup Strategy",
      "text": "<ol> <li>Azure Key Vault: Geo-redundant by default (usgovvirginia \u2192 usgovtexas)</li> <li>AWS KMS: Multi-region key replication (us-gov-west-1 \u2192 us-gov-east-1)</li> <li>Manual backup: Export wrapped keys to S3-Gov (encrypted with separate key)</li> </ol>"
    },
    {
      "location": "design/kms-design/#recovery-time-objective-rto",
      "title": "Recovery Time Objective (RTO)",
      "text": "<ul> <li>Key Vault outage: RTO &lt; 1 hour (automatic failover to secondary region)</li> <li>KMS outage: RTO &lt; 30 minutes (AWS multi-region keys)</li> <li>Total platform failure: RTO &lt; 4 hours (restore from encrypted backups)</li> </ul>"
    },
    {
      "location": "design/kms-design/#compliance-validation",
      "title": "Compliance Validation",
      "text": ""
    },
    {
      "location": "design/kms-design/#fips-140-2-verification",
      "title": "FIPS 140-2 Verification",
      "text": "<pre><code># Azure Key Vault HSM validation\naz keyvault key show \\\n  --vault-name aegis-kv-prod-usgovva \\\n  --name aegis-prod-dek \\\n  --query \"key.kty\"\n# Output: \"RSA-HSM\"\n\n# AWS KMS FIPS validation\naws kms describe-key \\\n  --key-id alias/aegis-prod-dek \\\n  --region us-gov-west-1 \\\n  --query \"KeyMetadata.CustomKeyStoreId\"\n# Output: CloudHSM cluster ID (FIPS 140-2 Level 3)\n</code></pre>"
    },
    {
      "location": "design/kms-design/#annual-key-audit",
      "title": "Annual Key Audit",
      "text": "<ol> <li>Review key access logs (who accessed keys, when, from where)</li> <li>Verify key rotation compliance (all keys rotated within 90 days)</li> <li>Test key recovery procedure (simulate disaster)</li> <li>Update key inventory spreadsheet (FedRAMP requirement)</li> </ol>"
    },
    {
      "location": "design/kms-design/#references",
      "title": "References",
      "text": "<ul> <li>NIST 800-53 Rev 5: SC-12 (Cryptographic Key Establishment)</li> <li>NIST 800-57: Recommendation for Key Management</li> <li>FIPS 140-2 Standard</li> <li>Azure Key Vault FIPS 140-2 Compliance</li> <li>AWS KMS FIPS 140-2 Compliance</li> </ul>"
    },
    {
      "location": "guides/compliance-reports/",
      "title": "Compliance Reports",
      "text": "<p>Generate FedRAMP and NIST compliance reports for audits.</p>"
    },
    {
      "location": "guides/compliance-reports/#report-types",
      "title": "Report Types",
      "text": ""
    },
    {
      "location": "guides/compliance-reports/#ssp-package-system-security-plan",
      "title": "SSP Package (System Security Plan)",
      "text": "<p>Complete security package including:</p> <ul> <li>System Security Plan</li> <li>POA&amp;M documents</li> <li>Vulnerability reports</li> <li>SBOM inventory</li> <li>Audit logs</li> </ul> <pre><code>mutation GenerateSSPPackage($projectId: ID!) {\n  generateSSPPackage(projectId: $projectId) {\n    url\n    expiresAt\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/compliance-reports/#sar-security-assessment-report",
      "title": "SAR (Security Assessment Report)",
      "text": "<p>Assessment of security controls:</p> <pre><code>mutation GenerateSAR($projectId: ID!, $assessmentPeriod: DateRange!) {\n  generateSAR(projectId: $projectId, assessmentPeriod: $assessmentPeriod) {\n    url\n    expiresAt\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/compliance-reports/#continuous-monitoring-report",
      "title": "Continuous Monitoring Report",
      "text": "<p>Monthly compliance report for FedRAMP:</p> <pre><code>mutation GenerateMonthlyReport($projectId: ID!, $month: Date!) {\n  generateContinuousMonitoringReport(projectId: $projectId, month: $month) {\n    url\n    expiresAt\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/compliance-reports/#oscal-format",
      "title": "OSCAL Format",
      "text": "<p>All reports are available in OSCAL (Open Security Controls Assessment Language):</p> <ul> <li>OSCAL JSON</li> <li>OSCAL XML</li> </ul>"
    },
    {
      "location": "guides/compliance-reports/#report-contents",
      "title": "Report Contents",
      "text": ""
    },
    {
      "location": "guides/compliance-reports/#vulnerability-summary",
      "title": "Vulnerability Summary",
      "text": "<ul> <li>Total vulnerabilities by severity</li> <li>New vulnerabilities this period</li> <li>Remediated vulnerabilities</li> <li>Open POA&amp;Ms</li> </ul>"
    },
    {
      "location": "guides/compliance-reports/#control-assessment",
      "title": "Control Assessment",
      "text": "<ul> <li>NIST 800-53 Rev 5 controls</li> <li>Implementation status</li> <li>Evidence artifacts</li> </ul>"
    },
    {
      "location": "guides/compliance-reports/#compliance-status",
      "title": "Compliance Status",
      "text": "<ul> <li>FedRAMP authorization status</li> <li>Continuous monitoring compliance</li> <li>Outstanding issues</li> </ul> <p>For more details, see the Compliance Mapping guide.</p>"
    },
    {
      "location": "guides/integrations/",
      "title": "Integrations",
      "text": "<p>Integrate Aegis with your existing DevOps tools and workflows.</p>"
    },
    {
      "location": "guides/integrations/#cicd-platforms",
      "title": "CI/CD Platforms",
      "text": ""
    },
    {
      "location": "guides/integrations/#github-actions",
      "title": "GitHub Actions",
      "text": "<pre><code>name: Aegis Security Scan\n\non:\n  push:\n    branches: [main]\n  pull_request:\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Generate SBOM\n        run: syft . -o spdx-json &gt; sbom.spdx.json\n\n      - name: Upload to Aegis\n        run: |\n          curl -X POST ${{ secrets.AEGIS_API_URL }}/api/evidence \\\n            -H \"Authorization: Bearer ${{ secrets.AEGIS_TOKEN }}\" \\\n            -F \"file=@sbom.spdx.json\" \\\n            -F \"projectId=${{ secrets.AEGIS_PROJECT_ID }}\"\n\n      - name: Check for Critical Vulnerabilities\n        run: |\n          CRITICAL_COUNT=$(curl -s ${{ secrets.AEGIS_API_URL }}/api/evidence/$EVIDENCE_ID/vulnerabilities?severity=CRITICAL | jq '.count')\n          if [ $CRITICAL_COUNT -gt 0 ]; then\n            echo \"::error::Critical vulnerabilities found\"\n            exit 1\n          fi\n</code></pre>"
    },
    {
      "location": "guides/integrations/#gitlab-ci",
      "title": "GitLab CI",
      "text": "<pre><code>security_scan:\n  stage: security\n  script:\n    - syft . -o spdx-json &gt; sbom.spdx.json\n    - |\n      curl -X POST $AEGIS_API_URL/api/evidence \\\n        -H \"Authorization: Bearer $AEGIS_TOKEN\" \\\n        -F \"file=@sbom.spdx.json\" \\\n        -F \"projectId=$PROJECT_ID\"\n  only:\n    - main\n</code></pre>"
    },
    {
      "location": "guides/integrations/#azure-pipelines",
      "title": "Azure Pipelines",
      "text": "<pre><code>- task: Bash@3\n  displayName: 'Generate SBOM'\n  inputs:\n    targetType: 'inline'\n    script: 'syft . -o spdx-json &gt; sbom.spdx.json'\n\n- task: Bash@3\n  displayName: 'Upload to Aegis'\n  inputs:\n    targetType: 'inline'\n    script: |\n      curl -X POST $(AEGIS_API_URL)/api/evidence \\\n        -H \"Authorization: Bearer $(AEGIS_TOKEN)\" \\\n        -F \"file=@sbom.spdx.json\" \\\n        -F \"projectId=$(PROJECT_ID)\"\n</code></pre>"
    },
    {
      "location": "guides/integrations/#container-registries",
      "title": "Container Registries",
      "text": ""
    },
    {
      "location": "guides/integrations/#azure-container-registry",
      "title": "Azure Container Registry",
      "text": "<p>Scan images on push:</p> <pre><code># Build and push image\naz acr build --registry myregistry --image myapp:latest .\n\n# Generate SBOM\nsyft myregistry.azurecr.io/myapp:latest -o spdx-json &gt; sbom.spdx.json\n\n# Upload to Aegis\ncurl -X POST $AEGIS_API_URL/api/evidence \\\n  -F \"file=@sbom.spdx.json\"\n</code></pre>"
    },
    {
      "location": "guides/integrations/#notification-integrations",
      "title": "Notification Integrations",
      "text": ""
    },
    {
      "location": "guides/integrations/#slack",
      "title": "Slack",
      "text": "<p>Configure Slack webhook for notifications:</p> <pre><code>mutation CreateSlackWebhook {\n  createWebhook(input: {\n    url: \"https://hooks.slack.com/services/YOUR/WEBHOOK/URL\"\n    events: [\"VULNERABILITY_DETECTED\", \"POAM_OVERDUE\"]\n  }) {\n    id\n    active\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/integrations/#pagerduty",
      "title": "PagerDuty",
      "text": "<p>Alert on-call for Critical vulnerabilities:</p> <pre><code>mutation CreatePagerDutyWebhook {\n  createWebhook(input: {\n    url: \"https://events.pagerduty.com/v2/enqueue\"\n    events: [\"VULNERABILITY_DETECTED\"]\n    filters: {\n      severities: [\"CRITICAL\"]\n    }\n  }) {\n    id\n    active\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/integrations/#vulnerability-scanners",
      "title": "Vulnerability Scanners",
      "text": ""
    },
    {
      "location": "guides/integrations/#grype",
      "title": "Grype",
      "text": "<pre><code>grype myapp:latest -o json | \\\n  curl -X POST $AEGIS_API_URL/api/evidence \\\n    -F \"file=@-\" \\\n    -F \"projectId=$PROJECT_ID\"\n</code></pre>"
    },
    {
      "location": "guides/integrations/#trivy",
      "title": "Trivy",
      "text": "<pre><code>trivy image --format json myapp:latest | \\\n  curl -X POST $AEGIS_API_URL/api/evidence \\\n    -F \"file=@-\" \\\n    -F \"projectId=$PROJECT_ID\"\n</code></pre> <p>For webhook configuration, see the Webhooks API.</p>"
    },
    {
      "location": "guides/managing-poams/",
      "title": "Managing POA&amp;Ms",
      "text": "<p>Track and manage Plans of Action &amp; Milestones for vulnerability remediation.</p>"
    },
    {
      "location": "guides/managing-poams/#overview",
      "title": "Overview",
      "text": "<p>POA&amp;Ms are automatically generated for Critical and High severity vulnerabilities with FedRAMP-compliant deadlines:</p> <ul> <li>Critical: 30 days</li> <li>High: 90 days</li> <li>Medium: 180 days</li> </ul>"
    },
    {
      "location": "guides/managing-poams/#view-poams",
      "title": "View POA&amp;Ms",
      "text": ""
    },
    {
      "location": "guides/managing-poams/#dashboard-view",
      "title": "Dashboard View",
      "text": "<p>Navigate to your project dashboard to see:</p> <ul> <li>Total POA&amp;Ms</li> <li>Open POA&amp;Ms</li> <li>Overdue POA&amp;Ms</li> <li>Upcoming deadlines</li> </ul>"
    },
    {
      "location": "guides/managing-poams/#list-all-poams",
      "title": "List All POA&amp;Ms",
      "text": "<pre><code>query GetPOAMs($projectId: ID!) {\n  project(id: $projectId) {\n    poams {\n      id\n      title\n      status\n      scheduledCompletionDate\n      vulnerability {\n        cveId\n        severity\n      }\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/managing-poams/#update-poam-status",
      "title": "Update POA&amp;M Status",
      "text": ""
    },
    {
      "location": "guides/managing-poams/#mark-in-progress",
      "title": "Mark In Progress",
      "text": "<pre><code>mutation UpdatePOAM($id: ID!) {\n  updatePOAM(id: $id, input: { status: IN_PROGRESS }) {\n    id\n    status\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/managing-poams/#mark-completed",
      "title": "Mark Completed",
      "text": "<pre><code>mutation CompletePOAM($id: ID!) {\n  updatePOAM(id: $id, input: {\n    status: COMPLETED\n    actualCompletionDate: \"2026-01-10\"\n  }) {\n    id\n    status\n    actualCompletionDate\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/managing-poams/#accept-risk",
      "title": "Accept Risk",
      "text": "<pre><code>mutation AcceptRisk($id: ID!, $reason: String!) {\n  updatePOAM(id: $id, input: {\n    status: RISK_ACCEPTED\n    riskAcceptance: {\n      reason: $reason\n      approvedBy: \"CISO\"\n    }\n  }) {\n    id\n    status\n  }\n}\n</code></pre>"
    },
    {
      "location": "guides/managing-poams/#export-poams",
      "title": "Export POA&amp;Ms",
      "text": "<p>Generate compliance reports:</p> <pre><code>mutation ExportPOAMs($projectId: ID!) {\n  exportPOAMs(projectId: $projectId, format: OSCAL_JSON) {\n    url\n    expiresAt\n  }\n}\n</code></pre> <p>Formats:</p> <ul> <li><code>OSCAL_JSON</code> - NIST standard format</li> <li><code>OSCAL_XML</code> - Alternative NIST format</li> <li><code>PDF</code> - Human-readable report</li> <li><code>CSV</code> - Spreadsheet format</li> </ul> <p>For more details, see the POA&amp;M Generation guide.</p>"
    },
    {
      "location": "guides/upload-evidence/",
      "title": "Upload Evidence",
      "text": "<p>Step-by-step guide to uploading evidence to Aegis.</p>"
    },
    {
      "location": "guides/upload-evidence/#overview",
      "title": "Overview",
      "text": "<p>Evidence can be uploaded through:</p> <ul> <li>Web interface</li> <li>REST API</li> <li>GraphQL API</li> <li>CI/CD pipeline integration</li> </ul>"
    },
    {
      "location": "guides/upload-evidence/#via-web-interface",
      "title": "Via Web Interface",
      "text": ""
    },
    {
      "location": "guides/upload-evidence/#1-navigate-to-dashboard",
      "title": "1. Navigate to Dashboard",
      "text": "<p>Go to http://localhost:5173 (development) or your Aegis instance URL.</p>"
    },
    {
      "location": "guides/upload-evidence/#2-select-project",
      "title": "2. Select Project",
      "text": "<p>Click on the project where you want to upload evidence.</p>"
    },
    {
      "location": "guides/upload-evidence/#3-click-upload-evidence",
      "title": "3. Click \"Upload Evidence\"",
      "text": "<p>Click the \"Upload Evidence\" button in the top right corner.</p>"
    },
    {
      "location": "guides/upload-evidence/#4-select-file",
      "title": "4. Select File",
      "text": "<p>Choose your SBOM or scan result file:</p> <ul> <li>SPDX 2.3 JSON (<code>.spdx.json</code>)</li> <li>CycloneDX 1.4 JSON (<code>.cyclonedx.json</code>)</li> <li>Grype JSON output</li> <li>Trivy JSON output</li> </ul>"
    },
    {
      "location": "guides/upload-evidence/#5-review-and-upload",
      "title": "5. Review and Upload",
      "text": "<p>Review the file details and click \"Upload\".</p>"
    },
    {
      "location": "guides/upload-evidence/#6-monitor-processing",
      "title": "6. Monitor Processing",
      "text": "<p>Watch real-time progress:</p> <ul> <li>\u2705 File uploaded</li> <li>\u2705 SBOM parsed (X components found)</li> <li>\u2705 Vulnerability scan complete</li> <li>\u2705 POA&amp;Ms generated</li> </ul>"
    },
    {
      "location": "guides/upload-evidence/#via-rest-api",
      "title": "Via REST API",
      "text": "<pre><code>curl -X POST https://api.aegis.gov/api/evidence \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  -F \"file=@sbom.spdx.json\" \\\n  -F \"projectId=123e4567-e89b-12d3-a456-426614174000\" \\\n  -F \"buildId=234e5678-e89b-12d3-a456-426614174001\"\n</code></pre>"
    },
    {
      "location": "guides/upload-evidence/#via-cicd",
      "title": "Via CI/CD",
      "text": ""
    },
    {
      "location": "guides/upload-evidence/#github-actions",
      "title": "GitHub Actions",
      "text": "<pre><code>name: Upload SBOM to Aegis\n\non:\n  push:\n    branches: [main]\n\njobs:\n  upload-sbom:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Generate SBOM\n        run: |\n          syft . -o spdx-json &gt; sbom.spdx.json\n\n      - name: Upload to Aegis\n        env:\n          AEGIS_API_URL: ${{ secrets.AEGIS_API_URL }}\n          AEGIS_TOKEN: ${{ secrets.AEGIS_TOKEN }}\n          PROJECT_ID: ${{ secrets.AEGIS_PROJECT_ID }}\n        run: |\n          curl -X POST $AEGIS_API_URL/api/evidence \\\n            -H \"Authorization: Bearer $AEGIS_TOKEN\" \\\n            -F \"file=@sbom.spdx.json\" \\\n            -F \"projectId=$PROJECT_ID\"\n</code></pre> <p>For more details, see the Evidence Ingestion guide.</p>"
    },
    {
      "location": "introduction/architecture/",
      "title": "Architecture Overview",
      "text": "<p>Aegis is built on a modern, cloud-native architecture designed for security, scalability, and compliance.</p>"
    },
    {
      "location": "introduction/architecture/#high-level-architecture",
      "title": "High-Level Architecture",
      "text": "<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Web Frontend  \u2502 (React + TypeScript)\n\u2502   Port: 5173    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502 HTTP/GraphQL\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   API Server    \u2502 (Express + GraphQL)\n\u2502   Port: 3001    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u25bc         \u25bc          \u25bc          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 PostgreSQL\u2502 \u2502 Redis\u2502 \u2502 Azure   \u2502 \u2502 Queue    \u2502\n\u2502 Database  \u2502 \u2502 Cache\u2502 \u2502 Blob    \u2502 \u2502 Workers  \u2502\n\u2502           \u2502 \u2502      \u2502 \u2502 Storage \u2502 \u2502          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#core-components",
      "title": "Core Components",
      "text": ""
    },
    {
      "location": "introduction/architecture/#1-web-frontend",
      "title": "1. Web Frontend",
      "text": "<p>Technology: React, TypeScript, Vite</p> <p>The web frontend provides:</p> <ul> <li>Landing page showcasing platform capabilities</li> <li>Evidence upload interface</li> <li>Compliance dashboard with real-time metrics</li> <li>POA&amp;M management interface</li> <li>Vulnerability drill-down views</li> </ul> <p>Key Features:</p> <ul> <li>Material-inspired UI design</li> <li>Type-safe API client</li> <li>Responsive layout for desktop and mobile</li> <li>Real-time updates via GraphQL subscriptions</li> </ul>"
    },
    {
      "location": "introduction/architecture/#2-api-server",
      "title": "2. API Server",
      "text": "<p>Technology: Node.js, Express, GraphQL, TypeORM</p> <p>The API server is the core of Aegis, handling:</p> <ul> <li>Evidence Ingestion: Receives SBOMs and scan results</li> <li>Authentication: JWT-based authentication with multi-tenant support</li> <li>GraphQL API: Flexible query interface for frontend</li> <li>REST API: Traditional REST endpoints for integrations</li> <li>Job Scheduling: Enqueues background processing tasks</li> </ul> <p>Endpoints:</p> <ul> <li><code>POST /api/evidence</code> - Upload evidence files</li> <li><code>GET /api/projects</code> - List projects</li> <li><code>POST /graphql</code> - GraphQL API</li> <li><code>GET /health</code> - Health check endpoint</li> </ul>"
    },
    {
      "location": "introduction/architecture/#3-database-postgresql",
      "title": "3. Database (PostgreSQL)",
      "text": "<p>Version: PostgreSQL 15+</p> <p>Aegis uses PostgreSQL for:</p> <ul> <li>Evidence metadata storage</li> <li>Vulnerability records</li> <li>POA&amp;M tracking</li> <li>User and tenant data</li> <li>Audit logs</li> </ul> <p>Key Features:</p> <ul> <li>Row-Level Security (RLS): Multi-tenant data isolation</li> <li>Indexes: Optimized queries for CVE lookups and vulnerability searches</li> <li>Foreign Keys: Referential integrity across entities</li> <li>Migrations: TypeORM migrations for schema versioning</li> </ul> <p>Entity Relationships:</p> <pre><code>Tenant\n  \u251c\u2500\u2500 Project\n  \u2502     \u251c\u2500\u2500 Build\n  \u2502     \u2502     \u251c\u2500\u2500 Evidence\n  \u2502     \u2502     \u2502     \u251c\u2500\u2500 Vulnerability\n  \u2502     \u2502     \u2502     \u2502     \u2514\u2500\u2500 POA&amp;M\n  \u2502     \u2502     \u2502     \u2514\u2500\u2500 Component (from SBOM)\n  \u2502     \u2502     \u2514\u2500\u2500 ScanResult\n  \u2502     \u2514\u2500\u2500 Policy\n  \u2514\u2500\u2500 User\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#4-queue-system-bullmq-redis",
      "title": "4. Queue System (BullMQ + Redis)",
      "text": "<p>Technology: BullMQ, Redis</p> <p>The queue system handles asynchronous processing:</p> <ul> <li>SBOM Parser Queue: Parses SPDX and CycloneDX files</li> <li>Vulnerability Indexer Queue: Scans components for vulnerabilities</li> <li>POA&amp;M Generator Queue: Creates OSCAL POA&amp;Ms with FedRAMP timelines</li> </ul> <p>Queue Flow:</p> <pre><code>Upload Evidence\n     \u2502\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SBOM Parser    \u2502 \u2192 Extract components\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Vuln Indexer     \u2502 \u2192 Scan for CVEs\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502\n        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 POA&amp;M Generator  \u2502 \u2192 Create POA&amp;Ms\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#5-azure-blob-storage",
      "title": "5. Azure Blob Storage",
      "text": "<p>Technology: Azure Blob Storage</p> <p>Stores:</p> <ul> <li>Original SBOM files</li> <li>Scan result artifacts</li> <li>Generated compliance reports</li> <li>Evidence attachments</li> </ul> <p>Security:</p> <ul> <li>Encryption at rest (Azure Storage Service Encryption)</li> <li>Encryption in transit (TLS 1.2+)</li> <li>Shared Access Signatures (SAS) for time-limited access</li> <li>Tenant-isolated containers</li> </ul>"
    },
    {
      "location": "introduction/architecture/#6-queue-workers",
      "title": "6. Queue Workers",
      "text": "<p>Technology: Node.js, BullMQ</p> <p>Background workers process queued jobs:</p> <p>SBOM Parser Worker:</p> <ul> <li>Parses SPDX 2.3 and CycloneDX formats</li> <li>Extracts package components</li> <li>Normalizes package identifiers</li> <li>Stores components in database</li> </ul> <p>Vulnerability Indexer Worker:</p> <ul> <li>Queries vulnerability databases (NVD, OSV, GitHub Advisory)</li> <li>Matches components to known CVEs</li> <li>Calculates CVSS scores</li> <li>Flags Critical and High severity issues</li> </ul> <p>POA&amp;M Generator Worker:</p> <ul> <li>Creates OSCAL POA&amp;M documents</li> <li>Applies FedRAMP deadlines (30 days Critical, 90 days High)</li> <li>Maps to NIST 800-53 Rev 5 controls</li> <li>Generates compliance reports</li> </ul>"
    },
    {
      "location": "introduction/architecture/#data-flow",
      "title": "Data Flow",
      "text": ""
    },
    {
      "location": "introduction/architecture/#evidence-upload-flow",
      "title": "Evidence Upload Flow",
      "text": "<pre><code>1. User uploads SBOM file via Web UI\n   \u2502\n   \u25bc\n2. API receives file, stores in Azure Blob Storage\n   \u2502\n   \u25bc\n3. API creates Evidence record in PostgreSQL\n   \u2502\n   \u25bc\n4. API enqueues SBOM parsing job\n   \u2502\n   \u25bc\n5. SBOM Parser Worker processes file\n   \u2502\n   \u251c\u2500\u2192 Extracts components\n   \u251c\u2500\u2192 Stores in database\n   \u2514\u2500\u2192 Enqueues vulnerability scanning\n       \u2502\n       \u25bc\n6. Vulnerability Indexer Worker scans components\n   \u2502\n   \u251c\u2500\u2192 Queries CVE databases\n   \u251c\u2500\u2192 Stores vulnerability records\n   \u2514\u2500\u2192 Enqueues POA&amp;M generation\n       \u2502\n       \u25bc\n7. POA&amp;M Generator Worker creates POA&amp;Ms\n   \u2502\n   \u251c\u2500\u2192 Generates OSCAL documents\n   \u251c\u2500\u2192 Applies FedRAMP timelines\n   \u2514\u2500\u2192 Updates compliance dashboard\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#multi-tenant-isolation",
      "title": "Multi-Tenant Isolation",
      "text": "<p>Aegis enforces strict tenant isolation at multiple layers:</p> <p>Database Layer:</p> <pre><code>-- Row-Level Security policy\nCREATE POLICY tenant_isolation ON evidence\n  USING (tenant_id = current_setting('app.tenant_id')::uuid);\n</code></pre> <p>API Layer:</p> <ul> <li>JWT tokens include <code>tenantId</code> claim</li> <li>Middleware validates tenant access</li> <li>All queries filtered by tenant</li> </ul> <p>Storage Layer:</p> <ul> <li>Separate blob containers per tenant</li> <li>SAS tokens scoped to tenant containers</li> <li>No cross-tenant file access</li> </ul>"
    },
    {
      "location": "introduction/architecture/#security-architecture",
      "title": "Security Architecture",
      "text": ""
    },
    {
      "location": "introduction/architecture/#authentication-flow",
      "title": "Authentication Flow",
      "text": "<pre><code>1. User logs in with credentials\n   \u2502\n   \u25bc\n2. API validates against Keycloak (future) or local auth\n   \u2502\n   \u25bc\n3. API generates JWT token with claims:\n   - userId\n   - tenantId\n   - roles\n   \u2502\n   \u25bc\n4. Client includes token in Authorization header\n   \u2502\n   \u25bc\n5. API middleware validates token and sets context\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#encryption",
      "title": "Encryption",
      "text": "<ul> <li>Data in Transit: TLS 1.2+ for all API communications</li> <li>Data at Rest: Azure Storage Service Encryption (SSE)</li> <li>Database: PostgreSQL SSL connections</li> <li>Secrets: Azure Key Vault (production) or environment variables (dev)</li> </ul>"
    },
    {
      "location": "introduction/architecture/#audit-logging",
      "title": "Audit Logging",
      "text": "<p>All security-relevant events are logged:</p> <ul> <li>Evidence uploads</li> <li>Vulnerability discoveries</li> <li>POA&amp;M creations</li> <li>User authentication</li> <li>Policy changes</li> </ul>"
    },
    {
      "location": "introduction/architecture/#deployment-architecture",
      "title": "Deployment Architecture",
      "text": ""
    },
    {
      "location": "introduction/architecture/#development",
      "title": "Development",
      "text": "<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502        Developer Workstation         \u2502\n\u2502                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502 Docker   \u2502  \u2502 Local Services  \u2502  \u2502\n\u2502  \u2502 Compose  \u2502  \u2502 - PostgreSQL    \u2502  \u2502\n\u2502  \u2502          \u2502  \u2502 - Redis         \u2502  \u2502\n\u2502  \u2502          \u2502  \u2502 - Azurite       \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 npm run dev                     \u2502 \u2502\n\u2502  \u2502 - API (Port 3001)               \u2502 \u2502\n\u2502  \u2502 - Web (Port 5173)               \u2502 \u2502\n\u2502  \u2502 - Workers                       \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#production-azure-government-cloud",
      "title": "Production (Azure Government Cloud)",
      "text": "<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         Azure Government Cloud              \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502   Azure App Service                    \u2502 \u2502\n\u2502  \u2502   \u251c\u2500\u2500 API Container                    \u2502 \u2502\n\u2502  \u2502   \u251c\u2500\u2500 Web Container                    \u2502 \u2502\n\u2502  \u2502   \u2514\u2500\u2500 Worker Container                 \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Azure Database  \u2502  \u2502 Azure Redis      \u2502 \u2502\n\u2502  \u2502 for PostgreSQL  \u2502  \u2502 Cache            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Azure Blob      \u2502  \u2502 Azure Key Vault  \u2502 \u2502\n\u2502  \u2502 Storage         \u2502  \u2502                  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502\n\u2502  \u2502 Azure Application Insights              \u2502\u2502\n\u2502  \u2502 (Monitoring &amp; Logging)                  \u2502\u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"
    },
    {
      "location": "introduction/architecture/#scalability",
      "title": "Scalability",
      "text": ""
    },
    {
      "location": "introduction/architecture/#horizontal-scaling",
      "title": "Horizontal Scaling",
      "text": "<ul> <li>API Server: Multiple instances behind Azure Load Balancer</li> <li>Queue Workers: Scale worker count based on queue depth</li> <li>Web Frontend: Served via Azure CDN</li> </ul>"
    },
    {
      "location": "introduction/architecture/#performance-optimizations",
      "title": "Performance Optimizations",
      "text": "<ul> <li>Database Connection Pooling: TypeORM connection pool (max 20 connections)</li> <li>Redis Caching: Cache frequent queries (CVE lookups, project lists)</li> <li>Blob Storage CDN: Serve static assets via Azure CDN</li> <li>GraphQL DataLoader: Batch and cache database queries</li> </ul>"
    },
    {
      "location": "introduction/architecture/#monitoring-observability",
      "title": "Monitoring &amp; Observability",
      "text": "<ul> <li>Application Insights: APM, distributed tracing</li> <li>Log Analytics: Centralized logging</li> <li>Metrics: Custom metrics for queue depth, processing time, error rates</li> <li>Alerts: Automated alerts for failures, high latency, queue backlogs</li> </ul>"
    },
    {
      "location": "introduction/architecture/#next-steps",
      "title": "Next Steps",
      "text": "<ul> <li>Evidence Ingestion - Learn how evidence is processed</li> <li>SBOM Processing - Understand SBOM parsing</li> <li>Deployment Guide - Deploy to Azure Government Cloud</li> </ul>"
    },
    {
      "location": "introduction/quickstart/",
      "title": "Quickstart",
      "text": "<p>Get Aegis running locally in under 5 minutes.</p>"
    },
    {
      "location": "introduction/quickstart/#prerequisites",
      "title": "Prerequisites",
      "text": "<p>Before you begin, ensure you have the following installed:</p> <ul> <li>Node.js 18.x or higher</li> <li>Docker and Docker Compose</li> <li>Git</li> <li>npm or pnpm</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#installation",
      "title": "Installation",
      "text": ""
    },
    {
      "location": "introduction/quickstart/#1-clone-the-repository",
      "title": "1. Clone the Repository",
      "text": "<pre><code>git clone https://github.com/cloudcwfranck/aegis.git\ncd aegis\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#2-install-dependencies",
      "title": "2. Install Dependencies",
      "text": "<pre><code>npm install\n</code></pre> <p>This will install all dependencies for the monorepo, including:</p> <ul> <li>API server</li> <li>Web frontend</li> <li>Database migrations</li> <li>Queue workers</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#3-set-up-environment-variables",
      "title": "3. Set Up Environment Variables",
      "text": "<p>Create environment files for each package:</p> <pre><code># API environment\ncat &gt; packages/api/.env &lt;&lt; EOF\nNODE_ENV=development\nPORT=3001\nDATABASE_URL=postgresql://aegis:aegis@localhost:5432/aegis\nREDIS_URL=redis://localhost:6379\nAZURE_STORAGE_CONNECTION_STRING=UseDevelopmentStorage=true\nJWT_SECRET=your-secret-key-change-in-production\nEOF\n\n# Web environment\ncat &gt; packages/web/.env &lt;&lt; EOF\nVITE_API_URL=http://localhost:3001\nVITE_GRAPHQL_URL=http://localhost:3001/graphql\nEOF\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#4-start-infrastructure-services",
      "title": "4. Start Infrastructure Services",
      "text": "<p>Use Docker Compose to start PostgreSQL, Redis, and Azurite (Azure Storage emulator):</p> <pre><code>docker-compose up -d\n</code></pre> <p>This starts:</p> <ul> <li>PostgreSQL on port 5432</li> <li>Redis on port 6379</li> <li>Azurite on ports 10000-10002</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#5-run-database-migrations",
      "title": "5. Run Database Migrations",
      "text": "<pre><code>npm run migrate\n</code></pre> <p>This creates all required tables and sets up Row-Level Security policies.</p>"
    },
    {
      "location": "introduction/quickstart/#6-start-the-development-servers",
      "title": "6. Start the Development Servers",
      "text": "<pre><code># Start all services (API, Web, Workers)\nnpm run dev\n</code></pre> <p>Or start services individually:</p> <pre><code># API server only\nnpm run dev --workspace=@aegis/api\n\n# Web frontend only\nnpm run dev --workspace=@aegis/web\n\n# Queue workers only\nnpm run dev --workspace=@aegis/workers\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#verify-installation",
      "title": "Verify Installation",
      "text": "<p>Once all services are running, you should see:</p> <ul> <li>Web UI: http://localhost:5173</li> <li>API Server: http://localhost:3001</li> <li>GraphQL Playground: http://localhost:3001/graphql</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#upload-your-first-evidence",
      "title": "Upload Your First Evidence",
      "text": ""
    },
    {
      "location": "introduction/quickstart/#using-the-web-interface",
      "title": "Using the Web Interface",
      "text": "<ol> <li>Navigate to http://localhost:5173</li> <li>Click \"Upload Evidence\"</li> <li>Select an SBOM file (SPDX or CycloneDX format)</li> <li>Click \"Upload\"</li> </ol> <p>The platform will:</p> <ul> <li>Parse the SBOM</li> <li>Index all components</li> <li>Scan for vulnerabilities</li> <li>Generate POA&amp;Ms for Critical and High findings</li> <li>Display results on the dashboard</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#using-the-api",
      "title": "Using the API",
      "text": "<pre><code>curl -X POST http://localhost:3001/api/evidence \\\n  -F \"file=@sbom.spdx.json\" \\\n  -F \"projectId=1\" \\\n  -F \"buildId=1\" \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\"\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#using-graphql",
      "title": "Using GraphQL",
      "text": "<pre><code>mutation UploadEvidence($input: EvidenceInput!) {\n  createEvidence(input: $input) {\n    id\n    fileName\n    status\n    vulnerabilities {\n      id\n      cveId\n      severity\n      cvssScore\n    }\n  }\n}\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#next-steps",
      "title": "Next Steps",
      "text": "<p>Now that you have Aegis running:</p> <ul> <li>Architecture Overview - Understand how Aegis works</li> <li>Core Concepts - Learn about evidence, SBOMs, and vulnerabilities</li> <li>Deployment Guide - Deploy to Azure Government Cloud</li> <li>API Reference - Explore the GraphQL and REST APIs</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#troubleshooting",
      "title": "Troubleshooting",
      "text": ""
    },
    {
      "location": "introduction/quickstart/#database-connection-errors",
      "title": "Database Connection Errors",
      "text": "<p>Ensure PostgreSQL is running:</p> <pre><code>docker-compose ps\n</code></pre> <p>If PostgreSQL is not running:</p> <pre><code>docker-compose up -d postgres\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#migration-errors",
      "title": "Migration Errors",
      "text": "<p>Reset the database:</p> <pre><code>docker-compose down -v\ndocker-compose up -d\nnpm run migrate\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#port-conflicts",
      "title": "Port Conflicts",
      "text": "<p>If ports 3001, 5173, 5432, or 6379 are in use, modify the <code>docker-compose.yml</code> and <code>.env</code> files to use different ports.</p>"
    },
    {
      "location": "introduction/quickstart/#development-tips",
      "title": "Development Tips",
      "text": ""
    },
    {
      "location": "introduction/quickstart/#hot-reload",
      "title": "Hot Reload",
      "text": "<p>All services support hot reload during development:</p> <ul> <li>API: Changes to <code>packages/api/src/**</code> trigger restart</li> <li>Web: Changes to <code>packages/web/src/**</code> trigger HMR (Hot Module Replacement)</li> <li>Database: Use <code>npm run migrate</code> after schema changes</li> </ul>"
    },
    {
      "location": "introduction/quickstart/#database-inspection",
      "title": "Database Inspection",
      "text": "<p>Connect to PostgreSQL:</p> <pre><code>docker exec -it aegis-postgres psql -U aegis -d aegis\n</code></pre> <p>View tables:</p> <pre><code>\\dt\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#queue-monitoring",
      "title": "Queue Monitoring",
      "text": "<p>View Redis queue status:</p> <pre><code>docker exec -it aegis-redis redis-cli\nKEYS bull:*\n</code></pre>"
    },
    {
      "location": "introduction/quickstart/#logs",
      "title": "Logs",
      "text": "<p>View service logs:</p> <pre><code># All services\ndocker-compose logs -f\n\n# API only\ndocker-compose logs -f api\n\n# PostgreSQL only\ndocker-compose logs -f postgres\n</code></pre>"
    },
    {
      "location": "introduction/welcome/",
      "title": "Welcome to Aegis DevSecOps Platform",
      "text": "<p>Build production-ready, FedRAMP-compliant DevSecOps pipelines with automated vulnerability management and compliance reporting.</p>"
    },
    {
      "location": "introduction/welcome/#what-is-aegis",
      "title": "What is Aegis?",
      "text": "<p>Aegis is an enterprise-grade DevSecOps platform designed specifically for organizations requiring FedRAMP compliance. Built on modern cloud-native technologies, Aegis automates the collection, analysis, and reporting of security vulnerabilities while maintaining strict compliance with NIST 800-53 Rev 5 controls.</p> <p>Aegis goes beyond simple vulnerability scanning by providing a comprehensive approach to security compliance, with automated POA&amp;M generation, real-time compliance dashboards, and multi-tenant isolation that ensures enterprise-grade security and stability.</p> <p>The platform provides the flexibility and performance needed for scalable government cloud deployments, supporting Azure Government Cloud with complete FedRAMP Moderate authorization.</p>"
    },
    {
      "location": "introduction/welcome/#why-aegis",
      "title": "Why Aegis?",
      "text": ""
    },
    {
      "location": "introduction/welcome/#built-for-compliance-first",
      "title": "Built for Compliance First",
      "text": "<p>Unlike general-purpose DevOps tools, Aegis is designed from the ground up for federal compliance requirements:</p> <ul> <li>FedRAMP Moderate Authorization - Production-ready for government workloads</li> <li>NIST 800-53 Rev 5 Controls - Automated mapping to RA-5, SI-2, CM-8, and more</li> <li>Automated POA&amp;M Generation - 30-day deadlines for Critical, 90-day for High vulnerabilities</li> <li>Audit Trail - Complete evidence retention and compliance reporting</li> </ul>"
    },
    {
      "location": "introduction/welcome/#production-grade-architecture",
      "title": "Production-Grade Architecture",
      "text": "<ul> <li>Multi-tenant Isolation - Secure separation using PostgreSQL Row-Level Security</li> <li>Azure Government Cloud - Deployed on FedRAMP-authorized infrastructure</li> <li>Scalable Queue Processing - BullMQ-powered asynchronous job processing</li> <li>Secure Storage - Azure Blob Storage with encryption at rest and in transit</li> </ul>"
    },
    {
      "location": "introduction/welcome/#developer-friendly",
      "title": "Developer-Friendly",
      "text": "<ul> <li>GraphQL &amp; REST APIs - Modern API-first architecture</li> <li>TypeScript - End-to-end type safety across the platform</li> <li>Container-Native - Docker-based deployments with Chainguard hardened images</li> <li>Monorepo Structure - Streamlined development with Turborepo</li> </ul>"
    },
    {
      "location": "introduction/welcome/#key-features",
      "title": "Key Features",
      "text": "Feature Description SBOM Processing Automated Software Bill of Materials parsing supporting SPDX 2.3 and CycloneDX formats Vulnerability Scanning Integration with Grype, Trivy, and other industry-standard scanners POA&amp;M Automation Generate OSCAL-compliant Plans of Action &amp; Milestones with FedRAMP timelines Compliance Dashboard Real-time visibility into security posture and remediation status Evidence Storage Tamper-proof evidence collection with Azure Blob Storage Multi-tenant Enterprise-ready tenant isolation with PostgreSQL RLS"
    },
    {
      "location": "introduction/welcome/#technology-stack",
      "title": "Technology Stack",
      "text": "<p>Aegis is built on proven, enterprise-grade technologies:</p> <ul> <li>Backend: Node.js, TypeScript, Express, GraphQL</li> <li>Database: PostgreSQL with Row-Level Security</li> <li>Queue: BullMQ with Redis</li> <li>Storage: Azure Blob Storage</li> <li>Frontend: React, TypeScript, Vite</li> <li>Infrastructure: Azure Government Cloud, Terraform</li> <li>Containers: Chainguard hardened images</li> </ul>"
    },
    {
      "location": "introduction/welcome/#getting-started",
      "title": "Getting Started",
      "text": "<p>Ready to get started? Check out our Quickstart Guide to set up Aegis in minutes.</p> <p>For a comprehensive understanding of the platform architecture, see Architecture Overview.</p>"
    },
    {
      "location": "introduction/welcome/#open-source",
      "title": "Open Source",
      "text": "<p>Aegis is open source and available on GitHub under open governance, ensuring transparency, community-driven development, and enterprise-grade stability.</p>"
    },
    {
      "location": "introduction/welcome/#support",
      "title": "Support",
      "text": "<ul> <li>Documentation: You're reading it!</li> <li>GitHub Issues: Report bugs or request features</li> <li>GitHub Discussions: Ask questions and share ideas</li> </ul>"
    }
  ]
}
